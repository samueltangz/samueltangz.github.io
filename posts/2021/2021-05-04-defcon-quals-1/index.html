<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>DEF CON CTF Quals 2021: Day 1 :: Mystify</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="I played DEF CON CTF Quals once again with @Shellphish and we ended up at the 10th place. This blog post describes what actually was going on from my side. If you are looking for an informative blog post, this is not a good-read for you. There would be a little useful information, since I am just hanging around most of the time. I will even shamelessly copy some memes online to make the blog post looked rich in content." />
<meta name="keywords" content="ctf" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://mystiz.hk/posts/2021/2021-05-04-defcon-quals-1/" />




<link rel="stylesheet" href="https://mystiz.hk/assets/style.css">

  <link rel="stylesheet" href="https://mystiz.hk/assets/mystiz.css">






<link rel="apple-touch-icon" href="https://mystiz.hk/img/apple-touch-icon-192x192.png">

  <link rel="shortcut icon" href="https://mystiz.hk/img/favicon/mystiz.png">





<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://mystiz.hk/" />


  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="mystiz613" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="DEF CON CTF Quals 2021: Day 1">
<meta property="og:description" content="I played DEF CON CTF Quals once again with @Shellphish and we ended up at the 10th place. This blog post describes what actually was going on from my side. If you are looking for an informative blog post, this is not a good-read for you. There would be a little useful information, since I am just hanging around most of the time. I will even shamelessly copy some memes online to make the blog post looked rich in content.

After all, I am only able to solve nooombers (on day 1), qoo-or-ooo and back-to-qoo (on day 2). What happened on day 2 from my point of view is considerably more interesting." />
<meta property="og:url" content="https://mystiz.hk/posts/2021/2021-05-04-defcon-quals-1/" />
<meta property="og:site_name" content="Mystify" />

  <meta property="og:image" content="https://mystiz.hk/">

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2021-05-04 01:13:00 &#43;0800 &#43;0800" />












  <script data-ad-client="ca-pub-3220069814773012" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


</head>
<body class="mystiz">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Mystify
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about-me">About Me</a></li>
        
      
        
          <li><a href="/blogroll">Blogroll</a></li>
        
      
      
        <ul class="menu__sub-inner">
          <li class="menu__sub-inner-more-trigger">Show more ▾</li>

          <ul class="menu__sub-inner-more hidden">
            
              
                <li><a href="/crypto-in-ctf">Crypto in CTF</a></li>
              
            
          </ul>
        </ul>
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about-me">About Me</a></li>
      
    
      
        <li><a href="/blogroll">Blogroll</a></li>
      
    
      
        <li><a href="/crypto-in-ctf">Crypto in CTF</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="https://mystiz.hk/posts/2021/2021-05-04-defcon-quals-1/">DEF CON CTF Quals 2021: Day 1</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2021-05-04 
      </span>
    
    
    <span class="post-author">:: Mystiz</span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="https://mystiz.hk/tags/ctf/">ctf</a>&nbsp;
    
    #<a href="https://mystiz.hk/tags/defcon/">defcon</a>&nbsp;
    
  </span>
  

  

  

  <div class="post-content js-toc-content"><div>
        <p>I played DEF CON CTF Quals once again with <a href="https://twitter.com/Shellphish" target="_blank" rel="nofollow">@Shellphish</a> and we ended up at the 10th place. This blog post describes what actually was going on from my side. If you are looking for an informative blog post, this is not a good-read for you. There would be a little useful information, since I am just hanging around most of the time. I will even shamelessly copy some memes online to make the blog post looked rich in content.</p>

<p>After all, I am only able to solve <em>nooombers</em> (on day 1), <em>qoo-or-ooo</em> and <em>back-to-qoo</em> (on day 2). What happened on day 2 from my point of view is considerably more interesting.</p>

<h2 id="challenge-nooombers">Challenge: nooombers<a href="#challenge-nooombers" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>

<blockquote>
<p><em><strong>nooombers</strong> (44 solves, 127 points)</em></p>

<p>I really do not understand what this is about, but my cousin told me that once he managed to got a flag out of this. I was able to copy from my cousin's shell parts of his interactions with the server. You can find them in interaction1.txt and interaction2.txt. Unfortunately, they are incomplete.</p>

<p><code>nooombers.challenges.ooo 8765</code></p>

<p>Files: <a href="https://scoreboard2021.oooverflow.io/challenge_files/dc7308186e1ed06bb875d3c5ffb966acdcfd9c7433a6c67f821ce5af1ae43048/interaction1.txt">interaction1.txt</a>, <a href="https://scoreboard2021.oooverflow.io/challenge_files/dc7308186e1ed06bb875d3c5ffb966acdcfd9c7433a6c67f821ce5af1ae43048/interaction2.txt">interaction2.txt</a></p>
</blockquote>

<div class="alert info">
  Solved with <em>Paul</em>, <em>Subwire</em> and more.
</div>


<h3 id="part-i-understanding-the-challenge">Part I: Understanding the challenge<a href="#part-i-understanding-the-challenge" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>

<p style="text-align: center; padding: 12px;">⏲️ ⏲️ <em>Day 1, 10:45 (165 minutes in)</em> ⏲️ ⏲️</p>

<p>It is good to be greeted in the morning with a crypto challenge. I am pretty excited to see a crypto challenge in a pwn-intensive CTF. Let's see what is it about. I bet it is attributed to <em>fish</em> since I am seeing a bunch of 魚's (i.e., the Chinese word of fish).</p>

<p style="text-align: center; padding: 12px;">⏲️ ⏲️ <em>Day 1, 11:08 (188 minutes in)</em> ⏲️ ⏲️</p>

<p>After a while, I learned how to interact with the server. In <code>interaction1.txt</code>, there are multiple copies of the below string:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">髛髛髛   # Title, maybe?
鬆      # Operation 0
魢      # Operation 1
魀      # Operation 2
鯞      # Operation 3
鮂      # Operation 4
魻      # Operation 5
鬼      # Operation 6
鮳      # Operation 7
鯑      # Operation 8
鮽      # Operation 9
魵      # Operation 10
髛      # Send me something!</code></pre></div>
<p>They are actually the menu. On top of that, they have defined 11 operations, namely <code>鬆</code>, <code>魢</code>, ... up to <code>魵</code>. Furthermore, <code>髛</code> is somewhere asking for inputs. At this moment, the only operation I knew it <code>魵</code>, which is an exit. Also, worth noting that the character set changes on each <code>nc</code> connection.</p>

<p>We are then able to send one of the above operations. For instance, <code>鬆</code>. It then return a line of gibberish:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">鬆 鱷鳘鰬鰛鳘鰑鳌鲯鳗鲳...鱈鲒鲲鱱鳣鰂鳇鲫鳃鳾</code></pre></div>
<p>One thing I suspected is the long strings are actually used repeatedly. Therefore, I tried to translate <code>interaction1.txt</code> into something that is slightly more readable. Each <code>OP_*</code> is a single character representing an operation, and <code>RET_*_*</code> is a 144-character string represents the return values of the operations.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Welcome to nooombers! Press enter to start...

MENU
INPUT OP_0
OP_0 RET_0_1

MENU
INPUT OP_1
INPUT RET_0_1
OP_1 RET_0_1 RET_1_1 RET_1_2

MENU
INPUT OP_3
INPUT RET_0_1
INPUT RET_1_2
OP_3 RET_0_1 RET_1_2 RET_1_1 RET_3_1

MENU
INPUT OP_2
INPUT RET_0_1
OP_2 RET_0_1 RET_1_1 RET_2_1

MENU
INPUT OP_4
INPUT RET_0_1
INPUT RET_2_1
OP_4 RET_0_1 RET_2_1 RET_1_1 RET_4_1

MENU
INPUT OP_3
INPUT RET_3_1
INPUT RET_4_1
OP_3 RET_3_1 RET_4_1 RET_1_1 RET_4_1

MENU
INPUT OP_3
INPUT RET_4_1
INPUT RET_4_1
OP_3 RET_4_1 RET_4_1 RET_1_1 RET_3_2

MENU
INPUT OP_3
INPUT RET_3_2
INPUT RET_4_1
OP_3 RET_3_2 RET_4_1 RET_1_1 RET_3_3

MENU
INPUT OP_3
INPUT RET_3_3
INPUT RET_4_1
OP_3 RET_3_3 RET_4_1 RET_1_1 RET_3_4

MENU
INPUT OP_3
INPUT RET_3_4
INPUT RET_4_1
OP_3 RET_3_4 RET_4_1 RET_1_1 RET_3_5

MENU
INPUT OP_3
INPUT RET_3_5
INPUT RET_4_1
OP_3 RET_3_5 RET_4_1 RET_1_1 RET_3_6

MENU
INPUT OP_3
INPUT RET_3_6
INPUT RET_4_1
OP_3 RET_3_6 RET_4_1 RET_1_1 RET_3_7

MENU
INPUT OP_3
INPUT RET_3_7
INPUT RET_4_1
OP_3 RET_3_7 RET_4_1 RET_1_1 RET_3_8

MENU
INPUT OP_3
INPUT RET_3_8
INPUT RET_4_1
OP_3 RET_3_8 RET_4_1 RET_1_1 RET_3_9
Too much! Disabling one option...

MENU (OP_9 REMOVED)
INPUT OP_4
INPUT RET_3_2
INPUT RET_3_3
OP_4 RET_3_2 RET_3_3 RET_1_1 RET_3_6

MENU (OP_9 REMOVED)
INPUT OP_6
INPUT RET_3_3
INPUT RET_3_2</code></pre></div>
<p>I have also translated <code>interaction2.txt</code> and knew that <code>OP_9</code> is the operation that win us the flag. That said, if we are too annoying (i.e., sending too much queries), we're not able to get flag anymore.</p>

<h3 id="part-ii-a-wild-but-legit-guess">Part II: A wild but legit guess<a href="#part-ii-a-wild-but-legit-guess" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>

<p style="text-align: center; padding: 12px;">⏲️ ⏲️ <em>Day 1, 11:51 (231 minutes in)</em> ⏲️ ⏲️</p>

<p>While I am looking at the translated <code>interaction1.txt</code>, a strange idea popped up to my mind. Would the below operation represent $2\times3 = 6$? We can observe, from below, that <code>OP_4(RET_3_2, RET_3_3) = (RET_1_1, RET_3_6)</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">MENU (OP_9 REMOVED)
INPUT OP_4
INPUT RET_3_2
INPUT RET_3_3
OP_4 RET_3_2 RET_3_3 RET_1_1 RET_3_6</code></pre></div>
<p>Hence, we assume that <code>OP_4</code> is the multiplication operation. Also, <code>RET_3_2 = 2</code>, <code>RET_3_3 = 3</code>, <code>RET_3_6 = 6</code>. Base on the assumption, I don't think we are ambitious to assume that <code>RET_3_k = k</code> for all $k &gt; 1$, <code>RET_3_1 = 0</code> and <code>RET_4_1 = 1</code>. Last but not least, <code>OP_3</code> is the addition operation.</p>

<h3 id="part-iii-recovering-the-functions">Part III: Recovering the functions<a href="#part-iii-recovering-the-functions" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>

<p style="text-align: center; padding: 12px;">⏲️ ⏲️ <em>Day 1, 12:37 (277 minutes in)</em> ⏲️ ⏲️</p>

<p>I experimented for a while and I was pretty convinced that my guess is correct. It was pretty unbelieveable that I am able to guess well.</p>

<p>Let's translate <code>interaction1.txt</code> mathematically and fill in what we knew. Since <code>RET_1_1</code> is returned in every call (except the first), I am going to skip it. I am using $x_{i, j}$ as a replacement for <code>RET_i_j</code>:</p>

<ul>
<li>$\text{OP}_0() = x_{0, 1}$</li>
<li>$\text{OP}_1(x_{0, 1}) = x_{1, 2}$</li>
<li>$x_{0, 1} + x_{1, 2} = x_{3, 1}$</li>
<li>$\text{OP}_2(x_{0, 1}) = x_{2, 1}$</li>
<li>$x_{0, 1} \times x_{2, 1} = 1$</li>
<li>$x_{3, 1} + 1 = 1$</li>
<li>$1 + 1 = 2$</li>
<li>$2 + 1 = 3$</li>
<li>$3 + 1 = 4$</li>
<li>$4 + 1 = 5$</li>
<li>$5 + 1 = 6$</li>
<li>$6 + 1 = 7$</li>
<li>$7 + 1 = 8$</li>
<li>$8 + 1 = 9$</li>
<li>$2 \times 3 = 6$</li>
</ul>

<p>From above, it is evident that $x_{3, 1} = 0$ and $x_{2, 1} = {x_{0, 1}}^{-1}$. Hence $x_{1, 2} = -x_{0, 1}$. We are able to further derive that $\text{OP}_1$ and $\text{OP}_2$ is an inverse operator for addition and multiplication, respectively (i.e., $\text{OP}_1(x) = -x$ and $\text{OP}_2(x) = x^{-1}$). With more tests (for example, knowing that $x_{1, 1} \times x_{1, 1} = x_{1, 1} + x_{1, 1} = 0$), it is verified that those operations are using $x_{1, 1}$ is the modulo. Let's summarize what we have in the below table:</p>

<table>
<thead>
<tr>
<th>Operation</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>$\text{OP}_0()$</td>
<td>return a random number... maybe</td>
</tr>

<tr>
<td>$\text{OP}_1(x)$</td>
<td>return $-x\ \text{mod}\ q$</td>
</tr>

<tr>
<td>$\text{OP}_2(x)$</td>
<td>return $x^{-1}\ \text{mod}\ q$</td>
</tr>

<tr>
<td>$\text{OP}_3(x, y)$</td>
<td>return $x + y\ \text{mod}\ q$</td>
</tr>

<tr>
<td>$\text{OP}_4(x, y)$</td>
<td>return $xy\ \text{mod}\ q$</td>
</tr>
</tbody>
</table>

<p style="text-align: center; padding: 12px;">⏲️ ⏲️ <em>Day 1, 13:30 (330 minutes in)</em> ⏲️ ⏲️</p>

<p>We have further guessed (and experimented) that $\text{OP}_5$ is another multiplication and $\text{OP}_6$ is exponentation. At first, I didn't know why are there two multiplications, it took me some time that they are operated on a different modulus (denote it as $p$).</p>

<p style="text-align: center; padding: 12px;">⏲️ ⏲️ <em>Day 1, 13:33 (333 minutes in)</em> ⏲️ ⏲️</p>

<p><em>Me: What is the deal for operation 7? There are so much asterisks... Let's skip it.</em></p>

<p style="text-align: center; padding: 12px;">⏲️ ⏲️ <em>Day 1, 14:03 (363 minutes in)</em> ⏲️ ⏲️</p>

<p>Instead of a simple mathematical operation, $\text{OP}_8$ takes three parameters and runs several arithmetic operations, and eventually return one value. Let's translate a sample response of the function call...</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">MENU
INPUT OP_8
INPUT X1 
INPUT X2
INPUT X3
MODINV X3 Q Y1
MUL X1 Y1 Q Y2
MUL X2 Y1 Q Y3
POW R1 Y2 P Y4
POW R2 Y3 P Y5
MUL Y4 Y5 P Y6
OP_0 Y7
NEG Y7 Q Y8
ADD Y6 Y7 Q Y9
ADD Y9 Y8 Q Y10
OP_8 X1 X2 X3 Y10</code></pre></div>
<p>Let's express $y_{10}$ (the output) in terms of $x_1, x_2, x_3$ (the inputs) mathematically.</p>

<p><span  class="math">\[\begin{aligned}
y_{10} &= (y_9 + y_8)\ \text{mod}\ q \\
&= [(y_6 + y_7) + (-y_7)]\ \text{mod}\ q \\
&= y_6\ \text{mod}\ q \\
&= (y_4y_5\ \text{mod}\ p)\ \text{mod}\ q \\
&= ({r_1}^{y_2} {r_2}^{y_3}\ \text{mod}\ p)\ \text{mod}\ q \\
&= ({r_1}^{x_1 y_1\ \text{mod}\ q} {r_2}^{x_2 y_1\ \text{mod}\ q}\ \text{mod}\ p)\ \text{mod}\ q \\
&= ({r_1}^{x_1/x_3\ \text{mod}\ q} {r_2}^{x_2/x_3\ \text{mod}\ q}\ \text{mod}\ p)\ \text{mod}\ q \\
\end{aligned}\]</span></p>

<p>Here they have introduced two more unknowns $r_1$ and $r_2$ those are kept unchanged in the same connection.</p>

<div class="alert warning">
  <strong>What is that?</strong> During the contest, I feel like this is implementing something but I could not recall. After the contest, I was by <em>N00bcak</em> and <em>rbtree</em> that was actually the data signature algorithm (DSA). Turns out operation 8 is a function verifying if your signature $(x_2, x_3)$ is correct, given the digest $x_1$. Hereby $r_1$ and $r_2$ corresponds to the generator and public key, respectively.
</div>


<h3 id="part-iv-identifing-the-objective-and-getting-through">Part IV: Identifing the objective and getting through<a href="#part-iv-identifing-the-objective-and-getting-through" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>

<p style="text-align: center; padding: 12px;">⏲️ ⏲️ <em>Day 1, 14:36 (396 minutes in)</em> ⏲️ ⏲️</p>

<p>Operation 9 is literally the most important function that we gotta look into. Since we knew most of the operations, it is pretty easy to understand what it does. Well, it is just $\text{OP}_9(x_2, x_3) = \text{OP}_8(r_0, x_2, x_3)$ for some fixed $r_0$. Now let's bring in our translated <code>interaction2.txt</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">MENU
INPUT OP_9
INPUT X2
INPUT X3
MODINV X3 Q Y1
MUL R0 Y1 Q Y2
MUL X2 Y1 Q Y3
POW R1 Y2 P Y4
POW R2 Y3 P Y5
MUL Y4 Y5 P Y6
OP_0 Y7
NEG Y7 Q Y8
ADD Y6 Y7 Q Y9
ADD Y9 Y8 Q X2
OP_9 R0 X2 X3 X2
Correct signature! This is the flag:
...</code></pre></div>
<p>Since the output for $\text{OP}_9$ is $x_2$, I assumed that our objective is to find $x_2, x_3$ such that</p>

<p><span  class="math">\[({r_1}^{r_0/x_3\ \text{mod}\ q}{r_2}^{x_2/x_3\ \text{mod}\ q}\ \text{mod}\ p)\ \text{mod}\ q = x_2.\]</span></p>

<p style="text-align: center; padding: 12px;">⏲️ ⏲️ <em>Day 1, 15:08 (428 minutes in)</em> ⏲️ ⏲️</p>

<p>I was expecting that everything would be simpler if I can make</p>

<p><span  class="math">\[x_2 = {r_1}^{r_0/x_3} = {r_2}^{x_2/x_3} = 1.\]</span></p>

<p><strong>It did happen.</strong> I was randomly messing around with the operations and found that they have mistakenly defined <code>MODINV(0) = 0</code>. That said, I can set $x_2 = 1$ and $x_3 = 0$...</p>

<p style="text-align: center; padding: 12px;">⏲️ ⏲️ <em>Day 1, 15:10 (430 minutes in)</em> ⏲️ ⏲️</p>

<p>The flag pops right away: <code>OOO{D0Y0uUnd3rstandWh4tANumberIs?}</code>! Not so crypto, eh?</p>

<div class="alert danger">
  <strong>Slack alert!</strong> I am definitely being slack since there are no more crypto challenges in the rest of the day. 95% of the content onwards is pointless.
</div>


<h3 id="part-v-postmortem">Part V: Postmortem<a href="#part-v-postmortem" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>

<p>The crypto involved in this challenge is digital signature algorithm (DSA). I went through some discussions after the contest, and turns out operation 7 is the signing process for DSA, for a given digest. I think the intentional solution would be the poor random number it generates with $\text{OP}_0$ that is used in signing.</p>

<h2 id="challenge-exploitfordummies">Challenge: exploit-for-dummies<a href="#challenge-exploitfordummies" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>

<p style="text-align: center; padding: 12px;">⏲️ ⏲️ <em>Day 1, 15:33 (453 minutes in)</em> ⏲️ ⏲️</p>

<p>Since I have nothing to do, I hopped into the challenge and tried to find the answers for the unsolved trivia questions. Seeing no crypto, I decided to have a break.</p>

<h2 id="side-story-inspecting-the-challenge-api">Side story: Inspecting the <code>/challenge</code> API<a href="#side-story-inspecting-the-challenge-api" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>

<p style="text-align: center; padding: 12px;">⏲️ ⏲️ <em>Day 1, 16:06 (486 minutes in)</em> ⏲️ ⏲️</p>

<p>I took some time integrating <em>ctfbot</em> to ping teammates when there is a challenge update. While I was inspecting the <code>/challenge</code> API, I saw something fishy...</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{<span style="color:#f92672">&#34;message&#34;</span>: { <span style="color:#960050;background-color:#1e0010">/*</span> <span style="color:#960050;background-color:#1e0010">omitted...</span> <span style="color:#960050;background-color:#1e0010">*/</span> <span style="color:#f92672">&#34;unopened_by_category&#34;</span>: {<span style="color:#f92672">&#34;haiku&#34;</span>: <span style="color:#ae81ff">9</span>}}}</code></pre></div>
<p>Wait, does it mean that there are only nine challenges yet-to-be released?</p>

<h2 id="challenge-mooosl">Challenge: mooosl<a href="#challenge-mooosl" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>

<p style="text-align: center; padding: 12px;">⏲️ ⏲️ <em>Day 1, 19:51 (711 minutes in)</em> ⏲️ ⏲️</p>

<blockquote>
<p><em>kylebot — Today 19:51</em><br>
This is a hash collision+musl libc<br>
The bug is that the next pointer is not cleared after delete<br>
What we can do is: find a pair of different keys hashed into a same bucket, one of them of length 1</p>

<p><em>Samuel — Today 19:52</em><br>
hash collision! need help?</p>

<p><em>kylebot — Today 19:52</em><br>
And then bruteforce the byte by querying it<br>
I'm not on a computer rn<br>
But yes. We need many collisions</p>
</blockquote>

<p>Shortly after, <em>Robin</em> send me the code for the hash.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">__int64</span> <span style="color:#66d9ef">__fastcall</span> <span style="color:#a6e22e">sub_13DB</span>(<span style="color:#66d9ef">__int64</span> a1, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int64</span> a2)
{
  <span style="color:#66d9ef">int</span> i; <span style="color:#75715e">// [rsp+14h] [rbp-Ch]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v4; <span style="color:#75715e">// [rsp+18h] [rbp-8h]
</span><span style="color:#75715e"></span>
  v4 <span style="color:#f92672">=</span> <span style="color:#ae81ff">2021LL</span>;
  <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; a2 <span style="color:#f92672">&gt;</span> i; <span style="color:#f92672">++</span>i )
    v4 <span style="color:#f92672">=</span> <span style="color:#ae81ff">322401073</span> <span style="color:#f92672">*</span> v4 <span style="color:#f92672">+</span> <span style="color:#f92672">*</span>(i <span style="color:#f92672">+</span> a1);
  <span style="color:#66d9ef">return</span> v4;
}</code></pre></div>
<p>Wow, it is pretty easy! This would be a little practice on lattices, right?</p>

<blockquote>
<p><em>kylebot — Today 19:54</em><br>
@Samuel also<br>
Mod 0x1000</p>
</blockquote>

<p>Bummer, it is a different story under modulo 0x1000. Everyone can find collisions easily...</p>

<p style="text-align: center; padding: 12px;">⏲️ ⏲️ <em>Day 1, 21:00 (780 minutes in)</em> ⏲️ ⏲️</p>

<p>I finished the collider that finds collision in $\mathcal{O}(1)$. It finds infinitely many preimages those have the same digest. Well, I don't even know what is it used.</p>

<h2 id="challenge-rick">Challenge: rick<a href="#challenge-rick" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>

<p style="text-align: center; padding: 12px;">⏲️ ⏲️ <em>Day 1, 21:02 (782 minutes in)</em> ⏲️ ⏲️</p>

<p>I was once baited by crypto-related terms. This time it is <em>rick</em>.</p>

<blockquote>
<p><em>Paul — Today 21:02</em><br>
if you could undo the encryption though, that'd be super helpful</p>

<p><em>R3x — Today 21:03</em><br>
isn't the encryption just xoring with letters RICK?</p>
</blockquote>

<p>Ooof. This challenge actually looked fun but I did not investigate any further. I have strong teammates, after all.</p>

<h2 id="side-story-creating-a-crypto-challenge">Side story: Creating a crypto challenge<a href="#side-story-creating-a-crypto-challenge" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>

<div class="alert warning">
  <strong>Good that you read up to here.</strong> Maybe you will be slightly benefited for the next CTF I help organizing!
</div>


<p>I was inspired by <em>nooombers</em> to create a CTF challenge. Of course, I am not going to mention what is it. I am still unable to write an exploit after until now...</p>

<h2 id="end-of-day-1">End of day 1<a href="#end-of-day-1" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>

<p>The organizers decided to release two more challenges near the end of the day (under GMT+8). Well, both of them are categorized as <em>reverse-pwn</em>. I rather go to bed...</p>

<blockquote>
<p><em>Samuel — Today 23:52</em><br>
darn you ooo<br>
wake me up when there is a crypto</p>

<p><em>GH0S1 — Today 23:52</em><br>
@Samuel cryptocurrency?</p>

<p><em>GH0S7_1N_7H3_F1NG3RS — Today 23:53</em><br>
@Samuel this is cryptocurrency</p>
</blockquote>

<p>Never mind, good night. Wait, no, it actually matters - <em>crypto is not cryptocurrency but cryptography</em>.</p>

      </div></div>

  
  
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        <span class="button previous">
            <a href="https://mystiz.hk/posts/2021/2021-05-06-defcon-quals-2/">
                <span class="button__icon">←</span>
                <span class="button__text">DEF CON CTF Quals 2021: Day 2</span>
            </a>
        </span>
        
        
        <span class="button next">
            <a href="https://mystiz.hk/posts/2021/2021-04-19-plaidctf-leaky-block-cipher/">
                <span class="button__text">PlaidCTF 2021: Leaky Block Cipher</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  

</div>


<aside class="toc-container">
  <a href="#" style="text-decoration: none; font-weight: 700;">
    DEF CON CTF Quals 2021: Day 1
  </a>
  <div class="js-toc"></div>
</aside>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.12.0/tocbot.min.css" integrity="sha512-SFw7k74K3983tyOlJIHa8atr9Ppef3Kix5cmifwzU7ZdtU2E0FRuOVRtd3ENpMJ8sNCie5hlb/0j23efcdQJXA==" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.12.0/tocbot.min.js" integrity="sha512-oD3xGN8YTxenx6tdS4D/RKqO4OtORBQtAb2/FseM17GGMIi6jMwKUBc8duX4A5RwMOGGXoFBZrsqbOk8GpXFgQ==" crossorigin="anonymous"></script>

<script type="text/javascript">
  tocbot.init({
      headingSelector: 'h1, h2, h3, h4',
      orderedList: false,
      headingLabelCallback: s => s.substr(0, s.length-2),
      collapseDepth: 2
  });
</script>



  </div>
  <aside class="ads">
    
  
  <ins class="adsbygoogle"
    style="display:block"
    data-ad-client="ca-pub-3220069814773012"
    data-ad-slot="6927401005"
    data-ad-format="auto"
    data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>


  </aside>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2022 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="https://mystiz.hk/assets/main.js"></script>
<script src="https://mystiz.hk/assets/prism.js"></script>






<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
  integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"
  integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"
  integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
  onload="renderMathInElement(document.body, { delimiters: [{ left: '$$', right: '$$', display: true }, { left: '\\[', right: '\\]', display: true }, { left: '$', right: '$', display: false }, { left: '\\(', right: '\\)', display: false }], trust: true })"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/viz.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/full.render.js"></script>
<script>
var viz = new Viz();

document.querySelectorAll("[class=graphviz]").forEach(node => {
  const escape = function (s) {
    const t = s.replace(/&amp;/g, '&')
    return t.replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&#34;/g, '"')
  }
  viz.renderSVGElement(escape(node.innerText), {
    engine: 'dot'
  }).then(function (element) {
    node.parentNode.appendChild(element)
    node.style.display = 'none'
  })
})
</script>
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script>
mermaid.initialize({
    startOnLoad: true,
    htmlLabels: true,
    securityLevel: "loose",
    theme: 'base',
    themeVariables: {
        background: '#22222c',
        primaryColor: '#33333c',
        primaryTextColor: '#ffe4e1',
    }
});
</script>

  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-180181192-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-180181192-1');
</script>



  
</div>

</body>
</html>

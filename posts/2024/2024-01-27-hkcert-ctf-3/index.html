<!DOCTYPE html>
<html lang="en-us" dir="ltr" data-bs-theme="dark">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>HKCERT CTF 2023 Postmortem (III): The Remaining Challenges | Mystify</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&family=Libre+Baskerville:ital,wght@0,400..700;1,400..700&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.8/css/bootstrap.min.css"
  integrity="sha512-2bBQCjcnw658Lho4nlXJcc6WkV/UxpE/sAokbXPxQNGqmNdQrWqtw26Ns9kFF/yG792pKR1Sx8/Y1Lf1XN4GKA==" crossorigin="anonymous"
  referrerpolicy="no-referrer" />
<link rel="stylesheet" href="/css/main.min.27b43d01a5c4432e35e87df4c1026d71d0e56b69b492a4e65a5564c213f27fa9.css" integrity="sha256-J7Q9AaXEQy416H30wQJtcdDla2m0kqTmWlVkwhPyf6k=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/prism.min.ebb6c0bd3fe6ed4e16ec09f3b52903ee18ddfb21e33b6882030d951a91b213e4.css" integrity="sha256-67bAvT/m7U4W7AnztSkD7hjd&#43;yHjO2iCAw2VGpGyE&#43;Q=" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.8/js/bootstrap.min.js"
  integrity="sha512-nKXmKvJyiGQy343jatQlzDprflyB5c+tKCzGP3Uq67v+lmzfnZUi/ZT+fc6ITZfSC5HhaBKUIvr/nTLCV+7F+Q==" crossorigin="anonymous"
  referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous"
  referrerpolicy="no-referrer"></script>
        <script src="/js/main.f2979a93a325fecf9605263bd141398a311c8e23388ed7dcff74f92f7e632866.js" integrity="sha256-8peak6Ml/s&#43;WBSY70UE5ijEcjiM4jtfc/3T5L35jKGY=" crossorigin="anonymous"></script>
        <script src="/js/prism.0ecb34b0181efd0f9aa6d1a8fc2e4814ffbdd9acc78d93d02a94e01f64f87f35.js" integrity="sha256-Dss0sBge/Q&#43;aptGo/C5IFP&#43;92azHjZPQKpTgH2T4fzU=" crossorigin="anonymous"></script>



</head>
<body class="overflow-y-scroll">
  <nav class="navbar navbar-expand-lg sticky-top bg-body-tertiary">
  <div class="container">
    <a class="navbar-brand" href="/">Mystify</a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
      <div class="navbar-nav">
        
        
          <a class="nav-link " href="/about-me/">
            About Me 
          </a>
        
          <a class="nav-link " href="/blogroll/">
            Blogroll 
          </a>
        
          <a class="nav-link " href="/crypto-in-ctf/">
            Crypto in CTF 
          </a>
        
      </div>
    </div>
  </div>
</nav>

  <main>
    <div class="container mt-3">
      
  <div class="row justify-content-center">
    <div class="col-8">
      <h1 class="post-title">HKCERT CTF 2023 Postmortem (III): The Remaining Challenges</h1>

      
      <div class="text-muted pb-4">
        
          
          
          <time datetime="2024-01-27T05:30:02&#43;08:00">2024-01-27</time>
        
        
        <span class="px-1">::</span>
        
        
          <span class="badge rounded-pill bg-secondary">
            <a href="https://mystiz.hk/tags/ctf/" class="text-muted text-decoration-none">#ctf</a>
          </span>
        
          <span class="badge rounded-pill bg-secondary">
            <a href="https://mystiz.hk/tags/hkcert-ctf/" class="text-muted text-decoration-none">#hkcert-ctf</a>
          </span>
        
          <span class="badge rounded-pill bg-secondary">
            <a href="https://mystiz.hk/tags/challenge-writing/" class="text-muted text-decoration-none">#challenge-writing</a>
          </span>
        
          <span class="badge rounded-pill bg-secondary">
            <a href="https://mystiz.hk/tags/reverse/" class="text-muted text-decoration-none">#reverse</a>
          </span>
        
          <span class="badge rounded-pill bg-secondary">
            <a href="https://mystiz.hk/tags/pwn/" class="text-muted text-decoration-none">#pwn</a>
          </span>
        
          <span class="badge rounded-pill bg-secondary">
            <a href="https://mystiz.hk/tags/misc/" class="text-muted text-decoration-none">#misc</a>
          </span>
        
      </div>
      

      <div class="post-content js-toc-content"><div>
          <p>We will finally cover the non-crypto challenges that I wrote for HKCERT CTF 2023. This includes one misc (Hackforces), two pwn (ISA Jump Scare &amp; ISA Jogger) and two reverse (The Flag Game &amp; Loot and Scoot) challenges.</p>
<h2 id="hackforces">Hackforces<a href="#hackforces" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h3 id="challenge-summary">Challenge Summary<a href="#challenge-summary" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<blockquote>
<p>Do you know <a href="http://codeforces.com/"
   
   target="_blank" rel="noopener noreferrer" >Codeforces</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg>? Well, what you need is to find a corner case to make the given submission <em>not</em> work.</p>
<p>http://HOST:PORT/</p>
<p>Attachments: <a href="https://github.com/blackb6a/hkcert-ctf-2023-challenges/releases/download/v1.0.0/hackforces_c9b284d8311d29dad10b20493e56ff9e.zip"
   
   target="_blank" rel="noopener noreferrer" >hackforces.zip</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></p>
</blockquote>
<p>We are given an introductory competitive programming problem (equivalent to <a href="https://leetcode.com/problems/unique-paths-ii/"
   
   target="_blank" rel="noopener noreferrer" >Unique Paths II in LeetCode</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg>) with its solution implemented in C.</p>
<pre tabindex="0"><code class="language-c=" data-lang="c=">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#define N 102
#define MOD 1000000007

int main () {
    int m, n;
    char a[N][N];
    int dp[N][N];

    memset(dp, 0, sizeof dp);

    scanf(&#34;%d %d\n&#34;, &amp;m, &amp;n);
    for (int i = 0; i &lt; m; i++) {
        scanf(&#34;%s&#34;, a[i]);
    }

    int non_zero_count = 0;

    dp[0][0] = a[0][0] != &#39;x&#39; ? 1 : 0;
    for (int i = 0; i &lt; m; i++) {
        for (int j = 0; j &lt; n; j++) {
            if (a[i][j] == &#39;x&#39;) continue;
            if (i &gt; 0) dp[i][j] = (dp[i][j] + dp[i-1][j]) % MOD;
            if (j &gt; 0) dp[i][j] = (dp[i][j] + dp[i][j-1]) % MOD;
            if (dp[i][j]) non_zero_count += 1;
        }
    }

    printf(&#34;%d\n&#34;, non_zero_count);
    for (int i = 0; i &lt; m; i++)
        for (int j = 0; j &lt; n; j++)
            if (dp[i][j] &gt; 0)
                printf(&#34;%d %d %d\n&#34;, i, j, dp[i][j]);
}
</code></pre><p>There is a platform for us to upload test cases, and the goal is to find an valid test case to the given program that generates a different verdict than &quot;ACCEPTED&quot;.</p>
<h3 id="solution">Solution<a href="#solution" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<h4 id="where-is-the-bug">Where is the bug?<a href="#where-is-the-bug" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p>Note that we will be required to print all the number of paths to each <em>reachable</em> chamber. In the program, it is checked at line 33 and it is assumed that the chamber at $(i, j)$ is reachable if <code>dp[i][j] &gt; 0</code>.</p>
<p>Notably, <code>dp[i][j]</code> is the number of possible paths reaching $(i, j)$ modulo $10^9 + 7$. If the number of paths reaching $(i, j)$ is a multiple of $10^9 + 7$, <code>dp[i][j]</code> would be zero and it will be considered unreachable by the program.</p>
<p>Now we want to find a configuration such that there are $(10^9+7)k$ possible paths to a chamber. For simplicity, we will find a configuration such that there are $10^9 + 7$ paths to the bottom-right chamber.</p>
<h4 id="constructing-numbers">Constructing numbers<a href="#constructing-numbers" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p>If there are $n+1$ rows and $m+1$ columns that fill with all dots, then there are $\text{C}^{n+m}_{m}$ paths from the top left to the bottom right. However, it is impossible to find small $n$ and $m$ such that $\text{C}^{n+m}_m$ is a multiple of $10^9 + 7$. Therefore we must find ways to &quot;combine&quot; the numbers.</p>
<p>Suppose that we have two grids that there are $a$ and $b$ paths from the top left to the bottom right. There will be $a + b$ and $a \cdot b$ ways to traverse from the top left to the bottom right, respectively.</p>


<figure>
  <img src="/images/2024-01-27-hkcert-ctf/hackforces-operations.png" title="">
  
</figure>

<p>In our case, we will be using only the additive property. We will use the greedy algorithm to find a sum of $\text{C}^n_k$s such that they sum to $10^9 + 7$. One of the config I found is $\text{C}^{97}_6 + \text{C}^{69}_5 + \text{C}^{39}_5 + \text{C}^{44}_3 + \text{C}^{16}_2 + \text{C}^5_1$. Thus the sizes of the rectangle grids are $92 \times 7$, $65 \times 6$, $35 \times 6$, $42 \times 4$, $15 \times 3$ and $5 \times 2$.</p>
<p>We can build a test case from the above information and submit to the platform, and retrieve the flag: <code>hkcert23{h4v1n9_k_m0d_p_3qu4ls_zer0_d0e5n7_m34n_k_i5_23r0}</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">34 94
</span></span><span class="line"><span class="cl">..............................................................................................
</span></span><span class="line"><span class="cl">.x............................................................................................
</span></span><span class="line"><span class="cl">.x............................................................................................
</span></span><span class="line"><span class="cl">.x............................................................................................
</span></span><span class="line"><span class="cl">.x............................................................................................
</span></span><span class="line"><span class="cl">.x............................................................................................
</span></span><span class="line"><span class="cl">.x............................................................................................
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.
</span></span><span class="line"><span class="cl">..............................................................................................
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxx.................................................................
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxx.................................................................
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxx.................................................................
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxx.................................................................
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxx.................................................................
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.
</span></span><span class="line"><span class="cl">..............................................................................................
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx...................................
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx...................................
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx...................................
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx...................................
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx...................................
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.
</span></span><span class="line"><span class="cl">..............................................................................................
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx..........................................
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx..........................................
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx..........................................
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.
</span></span><span class="line"><span class="cl">..............................................................................................
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx...............
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx...............
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.
</span></span><span class="line"><span class="cl">..............................................................................................
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.....
</span></span><span class="line"><span class="cl">.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.
</span></span></code></pre></div><h2 id="isa-jump-scare">ISA Jump Scare<a href="#isa-jump-scare" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h3 id="challenge-summary-1">Challenge Summary<a href="#challenge-summary-1" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<blockquote>
<p>Can you jump <code>flag.txt</code>, jump the content and jump them to me?</p>
<p>Web: <a href="http://bauhinia-isa-hwuj66.hkcert23.pwnable.hk:28900/?id=5"
   
   target="_blank" rel="noopener noreferrer" >http://bauhinia-isa-hwuj66.hkcert23.pwnable.hk:28900/?id=5</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></p>
<p>What is ISA: <a href="https://hackmd.io/@blackb6a/bauhinia-isa"
   
   target="_blank" rel="noopener noreferrer" >https://hackmd.io/@blackb6a/bauhinia-isa</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></p>
<p><strong>Note:</strong> There is a guide for this challenge <a href="https://hackmd.io/@blackb6a/hkcert-ctf-2023-i-en-a58d115f39feab46"
   
   target="_blank" rel="noopener noreferrer" >here</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg>.</p>
<p><strong>Note:</strong> You can find the flag at the file <code>flag.txt</code></p>
<p>Attachments: <a href="https://github.com/blackb6a/hkcert-ctf-2023-challenges/releases/download/v1.0.0/isa-jump-scare_9e0b5de4f92acff7b1af96d59cb3503f.zip"
   
   target="_blank" rel="noopener noreferrer" >isa-jump-scare.zip</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></p>
</blockquote>
<p>In this challenge, we are asked to write a commentless program to read <code>flag.txt</code>. However, there is a catch: There is a checker that validates whether each line of the input program starts with a <code>JMP</code>.</p>
<h3 id="solution-1">Solution<a href="#solution-1" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Let's first have a look at the below ISA code:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">0x400000: JMP 0x40000d; JMP 0x400000
</span></span><span class="line"><span class="cl">          â¬†ï¸
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0x40001b: NOP
</span></span></code></pre></div><p>The program control (<code>PC</code>) would be <code>0x400000</code> (beginning of the code) when we run the program. In this case, the instruction to be executed would be <code>JMP 0x40000d</code>.</p>
<p>Although <code>0x40000d</code> is <em>not</em> a address of the beginning of an instruction, similar to a large number of <a href="https://devblogs.microsoft.com/oldnewthing/20220111-00/?p=106144"
   
   target="_blank" rel="noopener noreferrer" >interpreters available in real life</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg>, the interpreter simply parses the instruction starting from <code>PC</code>. In this case, <code>0x40000d</code> points at the beginning of the <code>JMP 0x400000</code> (which is intended to be a comment). The interpreter thinks that this would be the next instruction and decided to run <code>JMP 0x400000</code> afterwards.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">0x400000: JMP 0x40000d; JMP 0x400000
</span></span><span class="line"><span class="cl">                        â¬†ï¸
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0x40001b: NOP
</span></span></code></pre></div><p>In this case, we can actually &quot;write&quot; two instructions in one line, and the comment is could be executed during runtime.</p>
<p>We will want to execute some other commands than <code>JMP</code> in the challenge. How do we achieve that? We can leverage the <code>JMP</code> instruction and jump to the address you want, even in the middle of an instruction.</p>
<p>Alas, the checker does not allow us to write comments. Fortunately the interpreter does not check whether the instructions are valid <em>at the beginning</em>. It would be fine as long as we are <em>not</em> running invalid instructions. This would be handy in our case.</p>
<p>To execute an arbitrary instruction, say <code>[INSTRUCTION]</code>, we can break down into two separate instructions which both of them start with <code>JMP</code>:</p>
<pre tabindex="0"><code class="language-x86asm" data-lang="x86asm">JMP +4
JMP [INSTRUCTION]
</code></pre><p>When the program control points to the beginning of the first instruction, it will jump four bytes ahead and point to <code>[INSTRUCTION]</code>. With this idea, we can write a program to read the flag: <code>hkcert23{jump_1n70_m1dd13_0f_1n57ruc710n_1s_r34l1y_fun}</code>.</p>
<pre tabindex="0"><code class="language-x86asm" data-lang="x86asm">JMP +4
JMP PUSH 0x7478742e
JMP +4
JMP PUSH 0x67616c66
JMP +4
JMP MOV R8, 3
JMP +4
JMP MOV R1, SP
JMP +4
JMP MOV R2, 0x410000
JMP +4
JMP MOV R3, 100
JMP +4
JMP SYSCALL
JMP +4
JMP MOV R8, 1
JMP +4
JMP MOV R1, 0x410000
JMP +4
JMP MOV R2, 100
JMP +4
JMP SYSCALL
JMP +4
JMP MOV R8, 2
JMP +4
JMP MOV R1, 0
JMP +4
JMP SYSCALL
</code></pre><h2 id="isa-jogger">ISA Jogger<a href="#isa-jogger" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h3 id="challenge-summary-2">Challenge Summary<a href="#challenge-summary-2" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<blockquote>
<p>I heard that <code>MOV</code> is Turing complete. Convince me by reading <code>flag.txt</code>!</p>
<p>Web: <a href="http://bauhinia-isa-hwuj66.hkcert23.pwnable.hk:28900/?id=6"
   
   target="_blank" rel="noopener noreferrer" >http://bauhinia-isa-hwuj66.hkcert23.pwnable.hk:28900/?id=6</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></p>
<p>What is ISA: <a href="https://hackmd.io/@blackb6a/bauhinia-isa"
   
   target="_blank" rel="noopener noreferrer" >https://hackmd.io/@blackb6a/bauhinia-isa</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></p>
<p><strong>Note:</strong> You can find the flag at the file <code>flag.txt</code></p>
<p>Attachments: <a href="https://github.com/blackb6a/hkcert-ctf-2023-challenges/releases/download/v1.0.0/isa-jogger_2f0b6c22aa5f1f87770f205016f44a1a.zip"
   
   target="_blank" rel="noopener noreferrer" >isa-jogger.zip</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></p>
</blockquote>
<p>This challenge is similar to <a href="#isa-jump-scare"
   
   >ISA Jump Scare</a>. Except that we are allowed to use only the <code>MOV</code> instruction instead of the <code>JMP</code> instruction.</p>
<h3 id="solution-2">Solution<a href="#solution-2" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>This time we are able to use only the <a href="https://hackmd.io/@blackb6a/bauhinia-isa#MOV-Move"
   
   target="_blank" rel="noopener noreferrer" ><code>MOV</code></a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg> instruction. We are able to write to arbitrary memory segments, including the code segment. We can write a self-modifying code to evade the checker at the beginning. If there is a <code>PUSH</code> instruction after the check, it is still fine.</p>
<p>The instruction <code>MOV [R8+0x400123], 0x54534554</code> sets <code>TEST</code> to the address <code>0x400123</code> if <code>R8</code> is zero. With the idea, we can modify the end of the program to read the flag: <code>hkcert23{m0v_1s_7ur1n9_c0mp1373_4nd_y0u_ju5t_v3r1fi3d_th4t_f0r_m3}</code>.</p>
<pre tabindex="0"><code class="language-x86asm" data-lang="x86asm">MOV [R8+0x4004e3], 0x48535550
MOV [R8+0x4004e7], 0x37783020
MOV [R8+0x4004eb], 0x37383734
MOV [R8+0x4004ef], 0xa653234
MOV [R8+0x4004f3], 0x48535550
MOV [R8+0x4004f7], 0x36783020
MOV [R8+0x4004fb], 0x36313637
MOV [R8+0x4004ff], 0xa363663
MOV [R8+0x400503], 0x20564f4d
MOV [R8+0x400507], 0x202c3852
MOV [R8+0x40050b], 0x4f4d0a33
MOV [R8+0x40050f], 0x31522056
MOV [R8+0x400513], 0x5053202c
MOV [R8+0x400517], 0x564f4d0a
MOV [R8+0x40051b], 0x2c325220
MOV [R8+0x40051f], 0x34783020
MOV [R8+0x400523], 0x30303031
MOV [R8+0x400527], 0x4f4d0a30
MOV [R8+0x40052b], 0x33522056
MOV [R8+0x40052f], 0x3031202c
MOV [R8+0x400533], 0x59530a30
MOV [R8+0x400537], 0x4c414353
MOV [R8+0x40053b], 0x4d0a0a4c
MOV [R8+0x40053f], 0x5220564f
MOV [R8+0x400543], 0x31202c38
MOV [R8+0x400547], 0x564f4d0a
MOV [R8+0x40054b], 0x2c315220
MOV [R8+0x40054f], 0x34783020
MOV [R8+0x400553], 0x30303031
MOV [R8+0x400557], 0x4f4d0a30
MOV [R8+0x40055b], 0x32522056
MOV [R8+0x40055f], 0x3939202c
MOV [R8+0x400563], 0x5359530a
MOV [R8+0x400567], 0x4c4c4143
MOV [R8+0x40056b], 0x4f4d0a0a
MOV [R8+0x40056f], 0x38522056
MOV [R8+0x400573], 0xa32202c
MOV [R8+0x400577], 0x20564f4d
MOV [R8+0x40057b], 0x202c3152
MOV [R8+0x40057f], 0x59530a30
MOV [R8+0x400583], 0x4c414353
MOV [R8+0x400587], 0x4c
</code></pre><h2 id="the-flag-game">The Flag Game<a href="#the-flag-game" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h3 id="challenge-summary-3">Challenge Summary<a href="#challenge-summary-3" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<blockquote>
<p>Did you beat The Password Game? Let's beat The Flag Game this time!</p>
<p>http://HOST:PORT/ (Docker environment available <a href="https://github.com/blackb6a/hkcert-ctf-2023-challenges/tree/master/01-the-flag-game/env"
   
   target="_blank" rel="noopener noreferrer" >here</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg>)</p>
</blockquote>


<figure>
  <img src="/images/2024-01-27-hkcert-ctf/the-flag-game-demo.png" title="">
  
</figure>

<p>We are shown a game similar to <a href="https://neal.fun/password-game/"
   
   target="_blank" rel="noopener noreferrer" >the password game</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg>, and no source code is given and we need to find a flag that satisfies all the rules.</p>
<h3 id="solution-3">Solution<a href="#solution-3" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<h4 id="maybe-we-can-do-that-manually">Maybe we can do that manually?<a href="#maybe-we-can-do-that-manually" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p>There are the first 25 rules:</p>
<ol>
<li>Your flag must be at least 6 characters.</li>
<li>Your flag must start with <code>hkcert23</code>.</li>
<li>Your flag must include exactly one <code>{</code> and one <code>}</code>.</li>
<li>The length of your flag must be a prime.</li>
<li>The digits in your flag must add up to 26.</li>
<li>The length of your flag must not be greater than the answer to the ultimate question of life, the universe, and everything.</li>
<li>Your flag must contain at least three underscores.</li>
<li>Your flag must not contain the substring <code>flag</code>.</li>
<li>Your flag must fulfil the flag format.</li>
<li>The number of digits in your flag must be a prime.</li>
<li>The number of <code>1</code>'s in your flag must be thrice the number of <code>6</code>'s in your flag.</li>
<li>At most 30% of your flag are digits.</li>
<li>Your flag must not contain any characters from <code>fail</code>.</li>
<li>Your flag must include at most two distinct vowels.</li>
<li>Your flag must include five characters, not necessarily distinct, from <code>mystiz</code>.</li>
<li>Your flag must contain exactly 20 distinct characters.</li>
<li>Your flag must not contain upper-case characters.</li>
<li>Your flag must contain the substring <code>y0u</code>.</li>
<li>Your flag must not contain consecutive double letters.</li>
<li>At least 40% of your flag are hexadecimal digits.</li>
<li>Your flag must match the REGEX <code>/[A-Za-z0-9]{9}/</code>.</li>
<li>The ASCII values of the characters in your flag must sum up to a multiple of 65.</li>
<li>Every occurrance of <code>n</code> in your flag must immediately followed by a digit.</li>
<li>No characters in your flag can occur more than 6 times.</li>
<li>Rule 22 should still be satisfied if each of the <code>3</code>s in your flag have been replaced by a <code>@</code>.</li>
</ol>
<p>Apparently, there is hope finding the flag. Maybe we can try harder...</p>


<figure>
  <img src="/images/2024-01-27-hkcert-ctf/the-flag-game-rule-29.png" title="What even is that rule?">
  
  <figcaption>What even is that rule?</figcaption>
  
</figure>

<h4 id="doing-it-in-a-reverse-engineering-way">Doing it in a reverse engineering way<a href="#doing-it-in-a-reverse-engineering-way" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<div class="alert warning">
  âœ‹ğŸ¾ <strong>Don't attempt manually.</strong> It might be a good idea doing it manually as to explore the challenge. However, it might be a rabbit hole because the text description might not reflect the actual rule correctly. On the other hand, the number of rules is unknown to us. Maybe there are 1000 or 10000?
</div>

<p>It is worth noting that the flag checking procedure is done solely on the client side. Thus we can read everything we need from the source code. Additionally, when we read <code>/js/app.38bf3c86.js</code>, we can see that there is a trailing line:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">//# sourceMappingURL=app.38bf3c86.js.map
</span></span></span></code></pre></div><p>This is a good sign, and we can see that there is a <code>/js/app.38bf3c86.js.map</code>. This is heavily used during development, because we are able to look up the line of code that causes unexpected errors, even if the code is minified. We are also to recover the source code from the source map, and the browsers are doing that automatically. For Chrome, we can go to &quot;Sources&quot; â†’ &quot;Page&quot; and read the source code.</p>


<figure>
  <img src="/images/2024-01-27-hkcert-ctf/the-flag-game-source-map.png" title="">
  
</figure>

<p>We can retrieve the full list of rules from the recovered <code>rules.js</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">const</span> <span class="nx">rules</span> <span class="o">=</span> <span class="p">[{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// first 25 rules skipped
</span></span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;Your flag must reach a strength 4 in &lt;a href=&#34;https://dropbox.tech/security/zxcvbn-realistic-password-strength-estimation&#34; target=&#34;_blank&#34; ref=&#34;nofollow&#34;&gt;zxcvbn password test&lt;/a&gt;.&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">checker</span><span class="o">:</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">zxcvbn</span><span class="p">(</span><span class="nx">u</span><span class="p">).</span><span class="nx">score</span> <span class="o">===</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;Rule 20 should no longer be satisfied if all of the &lt;code&gt;d&lt;/code&gt;s in your flag are removed.&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">checker</span><span class="o">:</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">u</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/d/g</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">filter</span><span class="p">(</span><span class="nx">c</span> <span class="p">=&gt;</span> <span class="s1">&#39;0123456789abcdefABCDEF&#39;</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">c</span><span class="p">)).</span><span class="nx">length</span> <span class="o">/</span> <span class="nx">u</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/d/g</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mf">0.4</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;YÌ¸ÌÌ…ÌŠÍ†Í†Ì‚Í†ÌÍÍŠÌÍ Í‡Ì¥ÍœÍ™Ì™Ì¼Ì°Ì¬Í”ÌœÌ ÌºÌ®oÌµÌˆÌ•Í„Í‚Í‚Ì‘Ì†ÌŒÍ„Í„Í€Ì”ÌÌƒÍ›Í“Ì©Ì²Ì±ÍÌ Í“uÌ·Í‹Í†Ì•Ì¿Ì„ÌœÌœÍÌ¼Í™ÌrÌµÌ¾Í‚ÌÌ›Ì¿ÍŒÌ‰ÍˆÍ‰Í• Ì¸Í’Ì”Ì›Ì›Ì›Í‹ÌÌ³Í…Ì©Ì™fÌ´Í˜Í‚Ì€Ì‡Í„ÌŠÌ„ÌÌ•Í˜Í˜ÍŠÍÌ²ÍˆÌ¤Ì Ì—Í™Ì Ì®lÌ·ÍƒÍÌÌƒÌ†Ì€Ì‡Ì‚ÍƒÍÍ”Ì¤Ì£Ì¡Ì®aÌµÌ’Ì‚Ì”Ì‘Ì€Ì“Ì“ÌˆÌŒÍƒÍŒÌ›ÍŒÌ•Ì€Í…Ì¹Í“ÍˆÌŸÍ–Ì¨gÌ¸Í˜ÌŒÌ‰Í„Ì‘Í‹Ì€Ì¨ Ì¸Ì¾ÍƒÌƒÌŒÌ”ÌºÌ¬Ì¨mÌ¸Í˜ÌÌÌÍ˜Ì‰Ì½Í•Ì—uÌµÍŒÍ‚ÌºÌ®Ì˜Ì¡ÌªÌ§Ì–Ì¢Í–Ì—ÌÌ²Ì¥sÌ¶ÌŠÌƒÍÍÍÌ›Ì‰ÌÌˆÌ‚Í—Í˜Í›ÍÌŒÌ²Ì¥Ì¦Ì°tÌµÍ›ÌƒÌÍÍƒÌ½ÌƒÌˆÌ‰ÌÌ¿Ì„Í‹Ì‘Ì¤ÍœÌ³Ì©Í“Ì¦Ì¹ÍšÌ«Ì¹Ì£ÌªÌ  Ì·Ì‰ÍƒÍ„ÌÌ¾ÌÍ‹ÍŠÌ›Í„ÌˆÍ„Ì­Í™Í”Í‰ÌªÍÍ–ÌªÌ¥Í™Í“Ì±ÍbÌ¸Ì„ÌƒÌ›Ì½Í Í‚Í†ÍÍŒÌ—Í™Ì¤Ì¡Ì Í–Ì³eÌµÌÍŒÍ€ÌÌÌÌ›Ì…Ì½Ì¬Ì¼Ì¢Í–Í•Ì°ÍÌ³Ì ÌŸÌ±ÍÌÌ¼Í Ì¸ÍƒÍƒÍŠÍ›Ì‰Ì“Í€Ì›Ì•Í€ÍÌÍ‹Í˜Í—ÌÌ™â–’Ì´Í‹Í’Ì‹ÌÍ„Ì¡Ì±â–ˆÌ´ÌˆÌ€ÍŠÍÌ€ÌÌ“Ì†Ì•Í†Í’ÌŠÌˆÌ‘ÌÌ²â–’Ì·ÌÌ¿ÍÌ®Ì—Ì¤Ì™Í–Ì¢Ì¤â–“Ì¸ÌƒÌ®â–“Ì·ÍÌ‰ÍÍƒÌ‚ÍšÌ©ÍšÍ…Í•Ì¯â–ˆÌ¸ÍŒÍ˜Í—Ì‘Ì‚ÌšÌ‹Í›Ì‰Í›Í‹Ì‹ÍšÍœâ–’Ì´ÍÍ’ÍÌ–â–“Ì¸ÌŠÍ—ÍÌŒÍÌˆÍƒÌ£Ì¦â–ˆÌµÍ†ÍŠÌ¼Ì¡Ì¹Í–Ì¡Ì¼ÌœÌ¦ÌŸÌ™Í–Í“â–“Ì·ÌÍÌ‹ÌÌ„Ì’Ì”ÍŒÍ‚Ì†Ì©Ì¨Ì¼Ì—Ì¡Íœâ–’Ì·Ì’Ì›Í˜Í‚Í‹Í Ì¥â–“Ì´Í†Í„Í€Ì‹Ì‘Ì”Ì”Í ÍŠÍ—Í“Ì¢Ì Ì²Ì§Ì˜Ì–Í“ÌœÌ±ÍœÌ¦Ì­Ì­Í“â–’Ì¸Í‹Ì†Í˜Í˜ÌÌÌƒÌÍ‘ÌŒÌ‘Ì¿Ì”Ì“ÌˆÍšÌ¬ÍœÌºÌ™ÌªÌ—ÌŸâ–ˆÌ¶Ì‘Ì½Ì‰Ì›Ì‚Í‚ÍÍ†Í‹ÍÍŒÌÌ“Ì‹Ì‰ÌÌ¯Ì§Ì»Ì¥Íâ–’Ì·Ì„Í›ÌÌšÌÌƒÌ•Ì«Ìâ–“Ì´Ì…Ì‡ÍÍ Ì²Ì¬Ì¨Ì¯ÌÍ‰Ì¥Ì¡.Ì¸Ì¿ÍÍÌ’Ì‰ÍƒÌÌ”Ì¾Ì›ÍÍ†Ì Ì¨Ì²Ì¹Ì¨Ì®Ì™Ì¤Ì¬ÌÌ¼Ì–&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">checker</span><span class="o">:</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">sha224</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;b08c89&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;YÌ´ÌÍ„Í„Ì½ÌƒÍšÍ‰ÌÌ™Í•Ì«ÍšÌÌœÍ•Ì¢Ì©oÌ´ÍƒÌ‡Ì€ÌÌ‡Ì¾Í‘Í’Ì‘ÌˆÌ€Ì‚Ì“Ì³Ì«Ì¤Ì¨Ì°Ì§ÌÍ–Í–Ì¢ÌœÌ¼ÍšÌ¼uÌ·ÍÍÌ‹ÌŒÌ„ÌÌ•Ì‡Ì½ÌˆÌ’Ì’ÌˆÌ¯Ì«ÍœÍÍ™Ì¤Ì°Ì©ÍœÌœÍ‡rÌ´ÌŠÍ’ÌšÍÌÍ„ÍŠÌ¡Ì—Ì©Ì¼Í•Í“Ì—Ì¬ÍˆÌ¤Ì˜Ì§Ì£ÌŸÍš Ì·ÍƒÌƒÍ˜Ì‹ÌŒÌ•Í‚ÌÌšÌ†ÍŒÍÌ¹Ì¹ÌºÌœÌ—Ì®Í•Ì©Ì—ÌªÌ©Ì—fÌ¶Í˜ÌˆÍÍÍ„Ì¿Í„Ì‘Í†Ì½Ì¾Ì˜Ì¥Ì˜ÍšÌ£ÌÍ–Ì«Ì¬Ì¬Ì˜ÌÍ‰lÌ´Í Í’Í„Í’Í˜Í Ì½ÍƒÌ‡Í’ÌŠÍ†Ì¢ÍˆÌ±ÌœÌ¤ÌÌ¬ÌœÌ¬ÌŸÌ¯Ì»aÌ¸Í†Ì‡Í›Ì›Ì’ÌÍ€ÍÌ…ÌÌŒÍÌ‰Í„ÌÌ¨Ì¥Ì¤ÌÌ­Ì¬Ì»Ì¥Ì¢Ì±gÌµÍ„ÍŠÌƒÌÌƒÍÌŠÍ„Í†ÍƒÍÌ„ÌœÌ¡ÍˆÍœÍÍ™ÌºÌ˜Ì±Ì©ÍˆÍ“Ì­ ÌµÌ’ÍÍ‹Í˜Í’ÍÌ„ÍƒÍƒÌ•ÌÌœÌÍ…Ì°Ì»Ì§Í…Ì¯ÌŸÍ–ÍœÌ­Ì«mÌ¸Ì…Ì„ÌšÌ‹Ì‰ÌŠÌˆÍÍ„Í—Í„ÍÌ»Ì¡ÍˆÌ¨Ì¼ÌœÍ•Í–ÍšÌ§Ì¯ÌªÌ§uÌµÍ„Ì‹ÍÍ„Ì€ÍÌŒÌšÍƒÍ’Ì„ÌÍŒÌ®Ì±Ì©sÌ·ÍŠÌ˜ÍÍ“ÌœÍˆÌ¨Ì™Ì®Ì™ÍÍ–tÌ´Í—Ì½Ì¿Í›ÌŠÌ½Ì”Í‹Ì’ÌÌÌ™Ì² Ì·ÌÌÍ˜ÌÍÌ”ÍÌ†ÍƒÌ€Í ÌŒÌÌ±Í“ÌÍ‰Ì«bÌ´Ì•Í‚ÌˆÌ•ÍÌ”Ì¾Í—ÍƒÌ½Ì”Í˜Ì“ÍÌÌ—Í™Í‡Ì˜Í–Í…Ì¬Ì²Ì˜Ì—ÍeÌ´ÌÍ‚ÍÍ›ÌšÌ…ÌÌ“Í˜ÍÌ¾ÌšÌ½ÍÍœÌ˜Ì¨Ì²Í• ÌµÌÍÌ‘Í€Í˜Í—Ì›Í†ÍÍ…ÍˆÌ™Ì¨Ì¬â–’Ì¸Ì›Í„Í„ÍÌ‚Í‚ÌÍ ÌÌ•ÍÍ“â–“Ì·Ì”Í—Ì’Í‘Í€ÌƒÍ…ÍšÌ¥Ì³Ì¼â–ˆÌ¸ÌšÌ•Ì‹ÌƒÌ‚ÍŒÍ‘Í—Ì¥ÌŸÌ¬ÌÍšÌ–Í”Ì¹â–ˆÌ¸ÍÍÍ˜Í†Í‘Í—ÌˆÌ„ÌÌ€Ì‚Í’ÌˆÌ–Í“ÍœÍšÍ™Í™Ì™ÌÍ”Ì»Ì¨Ì¯Ì²Ì®Íšâ–ˆÌ¶ÌŠÍ„Í†Ì“Í‹Í‘ÌšÌ„Ì€Ì‰ÌÌ±Ì³ÍšÌœÌ˜Í–Ì±Ì¼â–“Ì´Í‹Í˜ÌÌ‘ÌšÌƒÍƒÌšÍÌŠÌ”Í„ÌŠÌ§Ì±ÌºÍšÌ¢Ì¡Ì Ì–â–’ÌµÌ‰Ì…ÍŠÍ€Ì»Ì—ÍÌ¨Í•Ì¡Í–Ì±Ì¹ÌœÌÌÌ²Ì¢â–’Ì¶Í—Ì¡Í™ÌªÍ•ÌœÍ”Ì¬ÌœÍâ–“Ì¸Í Í—Í ÌÍÌ¥Ì£Ì£â–ˆÌ¶ÌŠÍ‹Ì‹ÌÍŠÍ†Í‹Ì¾Ì‚ÌŒÌ…Í„Ì„Ì‘Ì¯Ì¯Ì¤â–“Ì¸ÌˆÌ’Í„Í‚Í‡Í“Ìâ–ˆÌµÌ•Ì‘Ì‰Í’ÍÌ½ÍÌ‚ÌŠÌŒÌ”Ì„ÌŒÌ½ÍÌ¥Ì¦Ì™Ì¡â–’Ì¶Ì†ÌšÌ™Ì¡Í–Ì¬Ì—Ì¨Í“ÌÍšâ–“Ì¸Ì…Í—Ì€ÌšÍ‘Ì‚Í—Ì‚Ì„ÍƒÍ€ÌÍ”Í™Í“Ì¹ÍˆÌ«Ì§Í•Ì—â–’Ì¶Ì„ÍˆÌ­Íœâ–ˆÌ¶ÍÍŠÌƒÍ€ÌÌÌ‰ÌÍÌÌƒÌ‰Ì¿Ì¥ÍœÍ–Ì¨Ì¢Í•Ì§Ì§Ì¯Í•Ì—Í™.Ì´Í†Í’Ì…Ì‡Ì‹ÌÍ‹Ì‘Ì¿ÍÌ³Ì»Ì¯ÌÍ–Í”Ì§ÍœÌ¦Í”Ì§Ì¡&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">checker</span><span class="o">:</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">sha256</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;d0687a&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;YÌ¶Ì‰ÍÍ„Ì‹Í—Í’Ì”Ì‚Ì‹Í—ÍÌ‹Ì­Í™oÌ¶Ì‚Ì›Ì¿ÍŠÌ’Ì„Í›Í‰Ì¤ÌœÌ«Ì¡Ì¨ÍÍœÌ©uÌ¸Ì†ÌšÍÍ‘ÌƒÌ‹Ì»Í…Ì¨Ì™Ì­Ì±rÌ´ÌÌ‚ÌÍˆÌ Í™Ì¢ÍÍˆÌ­Í™ÌªÌ³Í‰Í‡ Ì¸ÍÌšÌƒÌ‹Í Í›Í‚ÍƒÌ“Ì€Ì¾Ì²Í‡fÌ¸Í€Í„Í†ÌˆÍÍ„ÌŠÍ€ÍšÌ—Ì¨ÌºÌ¹lÌµÌŠÌÌ‡Ì‘Ì‚ÌˆÍ‘ÍÌÌ„Ì‡Ì‘ÍÍÍ˜Ì¥ÌÌ¯Ì¥Ì—Ì—ÌÌ™ÌœÌ¦ÌÌ©ÌºaÌ¶ÍÌ½Ì„Ì’Ì‡Í‘Í„Í˜Ì‰ÌÌÍ›ÍŠÍŠÌ¡Ì®Í•Ì©Ì°ÍÌ©Ì©gÌ¸Í„Í€Ì‚ÍÌ§Í‡Ì©Ì¼ÌªÌ«Ì¨Ì˜Ì¬Ì­Ì¦Í“Ì¡ Ì´Í’ÍÌ•Í—Ì‘Ì…ÌÍ‚Ì…ÌŠÌ›ÌšÌŠÌšÌ±Ì™ÌœÍœÍ‡ÍšÍ–mÌ·Í Ì€ÍÍ›Ì‚Ì¿Ì¿ÍÌ«Ì–Ì°Í“uÌ·Ì’ÌÍ›ÍÌ–ÍÌ°Ì™Ì°Ì˜Ì¬Í•sÌ´Ì„ÍÌ‹Í›Ì±ÍÌ¯ÍÌ˜Ì¬Ì»ÍÌŸtÌ·ÍÌÌƒÍ˜ÍÌ‹Ì‰Ì‘Ì’Í›Ì£Ì™ÌªÌ—Ì¥Í™ÌÌ¦Ì²Ì¨ Ì¸Ì›Ì†Ì‡Ì„ÌŠÌ¾ÍƒÍŒÌ“ÌƒÌŠÍÌ¨Í‰Ì¹Í…ÌÌŸÌœÌ©Í•Ì¼Ì¢Ì¡bÌ´Ì€ÌƒÌÌ‡ÌÌ½ÌšÌ¿ÍÌ€Ì‡ÌÍ’Í‚Ì›Í”Ì¥Ì¡Ì±ÌŸÌ¨Ì±Ì«Ì ÍšÌ–ÌºÌ¡eÌ´Ì‰Ì£ÍšÌŸÌŸÍšÍ–ÌºÌ±Í•Í™Ì¬ÍÌ¯Ì«Ì Ì´Ì…Í†ÌÍ€Í„ÌÌ‰Í˜Ì“ÍÍ Í›Í€ÌÍ‚Ì˜Í–ÍÌ¤Í…Ì©Ì™Ì³ÌºÌ–Ì§Ì¢â–ˆÌ¸Í˜ÍÌ¾Ì€Ì¤Ì«Ì—Ì¨Ì¬Ì®ÌÌ¤ÌŸâ–ˆÌ·ÍÌÍÌÌ…Ì‘ÌŠÍ†ÌÌÌ›Í›Í‹Í™Ì°Ì¤Ì¹Ì¼Ì¥â–“ÌµÍ—ÌÍŠÌÌ†ÌšÍŠÌ‹ÍÍŠÍ„Í Ì”ÍˆÌ—Í‡Í”ÌŸÌ–Ì®ÍšÌ³Ì™ÌÍ“Ì¡â–ˆÌ·Ì½Í‚Ì€Ì•ÌÌ€ÌšÍ„Ì Ì¤â–ˆÌ·ÌÍŒÌ‡ÍÌ¦Ì°Ì˜Ì±Ì¨ÍšÌ°Ì£Ì§â–’Ì¸Ì›ÌÍ’Ì‘ÌÍ€ÌŠÍ‘ÌƒÌ‡Ì‚ÌˆÌšÌªÍ•â–’Ì¶Ì‹ÌÍ›Ì”Í›Í›ÌŠÍ„Í˜Ì‚Ì‡ÌŒÌ•Í—Ì¦Ì£Ì™Ì®Ì¦Í“Ì–Ì¹ÍšÍ‡Ì¯â–“Ì·Ì‚ÌˆÌˆÍ‘ÌšÌ‡Í›Ì¬â–“Ì¸Í„Ì•Í Í‹ÍÌ‘Í‚Í—Ì€ÌŒÌ„Í’Ì’Í”ÌÌ¬Ì©Í‰Íâ–ˆÌ´Ì½ÌƒÍÍ ÍŒÍ„ÌŒÌ’ÌŠÌÍ•Í™Ì©Ì¦ÌºÌ°Ì–ÍÌ©Ì™Í–Ì»Ì¬Ì–â–“ÌµÌÌ”ÌÍÍÍ—Í„Ì‡Ì…Ì’Ì›Ì‡ÌÌ³Ì»Í“Ì£Ì»Ì¢Ì™Ì–Ì˜Ì²â–“Ì¸Ì”Ì‹ÌÌ½ÌÌ”Í‚Ì”Ì“Ì’Ì‘Í‚Ì”Í‡Í”Ì©ÌœÌ–Ì—Ì¼â–’ÌµÍ—Í‚Ì‘ÌÌŠÍÌ‰Í€Í„Ì„Ì”Í‘Í—ÌÍ–Ì¼ÌºÌ°Í”ÌœÌ©Í”ÌºÌ«Ì¯Í‰Ì–ÌÌ¡â–ˆÌ·Ì‚Í‹Í‘Ì“ÌÌ”Í„ÍÌ›Ì³Í…Ì¢Ì¤Ì£Í”Í”Ì¯â–ˆÌµÌ“Ì¾Í„ÍŠÌ’Ì€Í›ÌÌÌÌ°Ì§â–’Ì·Ì’Í Ì¾Í›Í Í‹ÌÌ¨ÌœÌ¨Í•Ì²Ì—Ì¢Ì§.Ì·ÍŒÍ›ÌšÍŠÌ•ÌÌ‘Ì‰ÌÌŠÍ„Í…Ì¦Í“Í‡Ì§Ì«Ì®Íš&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">checker</span><span class="o">:</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">sha256</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;87b3c7&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;YÌ´Ì‚ÌoÌ¶ÍÌŒÌ¬Ì¼uÌµÌÌŠÍ‰ÌºrÌµÌÍÍˆ Ì·Ì†ÍŒÌ˜fÌ¶ÌÌŸlÌ¸ÍÌ²aÌ¶ÍÍ„Ì£ÌœgÌ·ÍÌ–Ì¨ Ì·Ì½Ì›Ì°mÌ¶Ì½Í‰Í™uÌ¶Ì„Í€Í–Ì¥sÌ¸ÌÍÌ¢Í”tÌ´ÌˆÌŒÍ•Ì® Ì¸Ì¾ÍÌªbÌµÌ‹ÌœeÌµÍŒÍƒÌŸÌŸ ÌµÌÌšÌ¨â–“Ì¸Ì•Ì¬â–’Ì·Ì‰Ì»Ì™â–’Ì´Í‚Ì³Ì˜â–ˆÌ´Ì†Í›Ìœâ–“Ì¸Ì½Í…â–“Ì·Ì…Í‚Ì¬â–’Ì´ÌÌ¬Ì—â–’Ì´ÍÌ‡Ì³Íšâ–ˆÌ·Í›Ìâ–“Ì¶ÌÌ±Í•â–’Ì·Ì’Ì³â–’ÌµÌ¿Ì²â–“ÌµÍ˜ÌÌ¯â–“Ì¶ÌˆÍ„Ì â–“ÌµÍÌœÌ˜â–’Ì·Ì“ÌÌ¼Ì™.Ì¸ÌÌ¹Ì§&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">checker</span><span class="o">:</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">sha224</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">22</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;8b035b&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;YÌ´Ì‰Í’Ì®ÍoÌ´Í„Ì¨uÌ¸Ì†Í’ÍšÌ§rÌ´ÍƒÌ³ ÌµÌ…Í†Ì˜Í‡fÌ·Ì‘Ì®lÌ´Ì‚Ì±Ì¡aÌµÌ†Í‹ÍœÍ‡gÌµÍ†Í‡ Ì¸ÍÌ‡ÌÌ¯mÌµÌ¿ÍšuÌµÍ†Ì½Í™ÌœsÌ·Í Ì¢tÌ´Ì•Ì”Ì©Ì³ Ì´Ì’Ì’ÍˆÌ¤bÌµÌ„Í“eÌ·Í€Ì‰Ì Ì´ÍƒÌÌ˜â–ˆÌ·Í„Ì–Ì§â–’Ì¸Ì•Í„Í…â–’ÌµÍ›ÌŸâ–ˆÌµÍ‘Í€ÌŸâ–“Ì´ÍŠÍâ–“Ì´ÍƒÌÍ–Íšâ–ˆÌ¶ÌÍ™Ìâ–ˆÌ¶Ì•ÌÌ â–’Ì´ÌÌŠÍâ–ˆÌ´Ì‘Ì¾Í…Ì®â–ˆÌµÌ¿Í…â–“Ì¸Ì‚Í“â–ˆÌ´ÌŠÌ’Ì§Ì¯â–ˆÌ¶ÌÌ²Ìâ–’Ì´Í Ì‰Ì±â–’Ì¸Ì‘Ìª.Ì·Ì…Ì»&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">checker</span><span class="o">:</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">sha224</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;8a9de8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;YÌ¶Ì”ÌšÌ¼Ì¥oÌ´Ì‘ÌŸÌ¦uÌ¶Í†Ì—rÌ´Ì›Ì¨ Ì¸Ì‰Ì¤Í–fÌ¶Í’ÌªÌ£lÌ·Ì¾ÍaÌµÌ’ÍÍ–ÌœgÌµÌ„Ì‡Ì£Í– Ì¸ÍŒÍ—ÌºÍ•mÌ¸ÍŠÌ‰ÌÌ«uÌ¶ÍƒÌ«ÍsÌ¸Í‘ÌŠÌœtÌµÌšÍˆÍ• Ì¶Ì‹Ì½Ì¹bÌ¶Ì‘ÌˆÌ¯eÌ´Ì‰Í„Ìœ Ì´ÍÌ½ÌŸâ–“Ì¶Í‚Ì›Ì¹â–“Ì´Í„Ì¡â–ˆÌ´ÌƒÌ‰ÍšÌ»â–ˆÌ¸Ì“Ì¦Í‡â–“Ì´ÍŠÌ…Í“Ì»â–“Ì´Í‚Ì—Ì¹â–“Ì¸Í„Ì‰Ì¯Íˆâ–ˆÌ¸ÌÌ¹Ì â–“Ì·ÌÌ¾Íœâ–ˆÌ¸ÌƒÍ”â–’Ì¶ÍÍœÌºâ–“Ì¶Í—Í›ÍšÌ¯â–“Ì´Í„Í‘Ì¹Ì–â–ˆÌ´Ì„Ì™Ì¬â–“Ì¶Ì”Ì”Ì–Í”â–ˆÌ¶ÍŠÍ›Í”Í–.Ì·ÌÌ¾Í“&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">checker</span><span class="o">:</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">sha256</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">26</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;7be965&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;YÌ´Í˜ÍŠÍÌ¬oÌµÍ„ÌºuÌ´Ì‘ÌŒÍÍˆrÌ¸Í€ÍÍ—Í‡ Ì·Í’Í›ÍÌ—Ì¬Ì­fÌ´Ì‚Ì—Í“lÌ´Ì„Ì±ÍÌaÌµÌšÌ¡gÌ·Ì’Ì¾Ì»Ì¹Ì¯ Ì·ÌÍ˜ÌœmÌ¶ÌÍŒÌªuÌ´Ì¿Ì­sÌ¶Ì•Ì‡Ì‡ÌºtÌ·ÍÌƒÍ– Ì·ÍÍ›ÌºbÌ¸Í‘Ì‹ÌÍˆeÌ·Í’Ì¢Í‡ Ì·Í„Ì­Ìªâ–ˆÌ¶Ì”Ì²â–’ÌµÍ‚Í‚ÌºÌ§Íœâ–“Ì´Ì‰Ì„Ì¦Ì°â–’Ì¸ÍƒÌ”Ì—â–“Ì´Ì‡Í˜Ì‘Í‰ÍœÌ»â–“Ì¶Í€Ì›Íâ–’Ì¶Ì†Ì§â–ˆÌ´ÌÌªÌ»Ì¢â–“Ì¸ÍƒÌ’ÍŠÌ¥Ì—Ìâ–’Ì·Ì‹Ì‚Ì€Ì¹â–“Ì¶ÌˆÌŒÌ Ì§Í–â–’Ì·Í†Ì¯â–ˆÌ¶ÍƒÍ›Ì™ÍˆÌŸâ–“Ì¶Ì‰Ì°â–’Ì·Ì•Ì¾Ì¡ÌŸâ–’Ì´Ì‘ÌÌ½ÌŸÍ….Ì¸Ì¾ÍŒÌ”Ì¯Í…Íˆ&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">checker</span><span class="o">:</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">sha224</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;bf7eeb&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;YÌ´Ì“Ì•Í˜Ì Ì¨oÌ¶Ì‹Í„Ì¥Ì–uÌ¸ÌÍ†ÌŠÌªrÌµÍ€Í• Ì¶Ì„Ì•Í„ÌÍ”Ì§fÌ´ÍŒÍ™lÌ¸Í€Ì²Ì©Ì«aÌ¸ÌÌ…Í‘Ì¥ÍšgÌµÍ€ÍŠÌ”Í‰Ì²Ì¬ ÌµÍ’Ì…Ì¾Ì¤ÍmÌµÍ‹Ì‘ÌŒÌ¼Ì®uÌ·Ì”ÌÌƒÍ‰Ì¤Í”sÌµÌ‹Ì”Ì¬tÌ·ÌƒÌ‘Ì¥ÍšÌ˜ Ì·Í†ÌÌbÌ´Ì•Ì“Ì©Í™eÌ¸Ì‚Ì– Ì·Ì’ÍÌ¨Íšâ–“Ì·Ì‰Í‰â–“Ì·Ì†ÍÌ™Ì¯Ì¹â–ˆÌ¸Í—ÌÌ®Ì¡Ì¨â–“Ì·Í‹Íœâ–’Ì·ÍŒÍ„ÌÍÌ©â–’Ì¶Ì½Í‚Í’Ì¢â–’ÌµÌ‘Í„Í„Ì™Ì¹Ì¯â–’Ì·Ì‹Í‚Ì¾Ì¥Ì®Ì£â–“ÌµÌˆÌ…ÌÌ¢â–’Ì´Í„ÌÍÌ°Íšâ–’ÌµÍ›Ì€Í‡Íâ–ˆÌ·ÌˆÌ“Ì”Ì²Ì¦â–ˆÌ·Ì‡Í„Ì¡â–ˆÌ¸Í†Í„Ì€ÌœÌ¬â–’Ì·Ì†ÍƒÌ¡Ì¦â–“ÌµÍ‚ÌÍÌ±Ì±.Ì¶Ì¿Ì“Ì•Ì®&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">checker</span><span class="o">:</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">sha256</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">36</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;7ef31a&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;YÌ·Í†Í„Ì¡ÍÌ oÌµÌÍ‘Ì°Ì¹Ì«uÌ´Í„Ì‘Ì‚Ì³ÍrÌµÌ€Í†ÌƒÍÍ… Ì¶Ì¿Ì‹Ì½Ì²fÌ´ÌŠÌ¤lÌ¶ÌÍ’ÍœÌ¢aÌ·Í‹ÌÌ‹Ì˜Ì¥Ì§gÌµÌ…Ì³ ÌµÌ€Í‚Ì¼Ì£Ì±mÌ´Ì‚Ì°ÍÌ®uÌ¸ÍÌ½Í€ÌœÌÌ²sÌ´Ì„Ì‘ÌªtÌ·Ì‹Ì±Ì¬ Ì¸ÍÍ˜Ì“ÌŸÌªbÌ´Ì„ÍeÌ¸Í˜ÌˆÌ•Í–Í–Ì™ Ì´Ì›ÌƒÌÌŸÍ…â–’ÌµÌŠÍŠÌ–Íœâ–ˆÌµÍ’ÍÌ¢â–ˆÌµÍ„Í•Ì¯â–ˆÌ¸ÌŠÌ‹ÌŒÌâ–“Ì·ÍÌÌ˜â–“ÌµÍÍ™â–’Ì¶ÌÍÍŠÌ¤â–“Ì¶Í’Ìœâ–“Ì·ÌŠÌšÌ¤Ì—Í™â–’Ì¶Í‘Í€Ì”ÌŸÌ™Í•â–“Ì´ÍÍ—Ì€Ì¢Ì¦â–’Ì¶ÌˆÌ™Íˆâ–“Ì´ÌŒÍ–â–ˆÌ¶ÍÌ–ÍšÌ¥â–“ÌµÌ‚Ì¡Ì®â–“Ì´Ì„Ì¥Í‰.Ì´ÍƒÌ›Ì€Í”Ì™&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">checker</span><span class="o">:</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">sha256</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;40f34c&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;YÌ´Ì’Ì¤ÍœÌ¨oÌ¸Ì†ÍœÌÍ‡uÌ·Ì‡Ì¹Ì¡rÌ·ÍÌºÍÌ˜ Ì·Ì‹Í•ÍšfÌµÌˆÌ‹Í•Í–Ì—lÌµÌ•Í‰Ì£aÌµÌ‚Ì‚Ì›Ì£gÌ¸ÌÍ“ Ì´Ì„ÍÍÌ£ÌªÌ¨mÌ¸Í€Ì‹Ì‘Ì»uÌµÌŒÌ°Ì¡Ì–sÌ¶ÍÍŒÍ’Ì©Ì—tÌµÌ€Ì½Ì’Í“Ì™ Ì´Ì“Í—Ì°Í“Ì±bÌ´Í„Í›ÍœÌ¢eÌ´Ì‘Ì¹ ÌµÌÌ°â–ˆÌ¸Ì‚Ì±Ì°Ì­â–ˆÌ¶ÌˆÌ‰Ì˜â–ˆÌ¸Í†Ì–ÌŸÍ‡â–ˆÌµÌ’Ì¿Ì§Ìªâ–ˆÌ´Í‚Í—Ìœâ–“Ì´Í€Ì¥ÍšÍ“â–ˆÌ¶Ì›Ì…Í˜Ì¼Ì¥Ì¡â–’Ì´Í‚Ì»Í“â–’Ì·Ì¿Ì³â–“ÌµÌÌ°Ì¹Ì¬â–“Ì¶Ì‰Ì¾ÌœÌ—â–“Ì¶Ì†ÌŠÌÍ…Ìºâ–ˆÌ¶Ì†Ì³Ì¬â–“Ì¸Ì‚Í‘ÌÌ¬Ì¤Ì¨â–“Ì¶Í„Ì¼Ì Ì¹â–ˆÌµÌšÍ—Ì€Ì¹Ì.Ì¶ÌÌÌ‡Ì˜&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">checker</span><span class="o">:</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">sha256</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;b72709&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;YÌ·ÍƒÍ‘ÍÌ³Ì®oÌµÌ¾Ì“ÌÌ°Ì©uÌ·Ì‹Í™Í‡rÌ¸ÌƒÌ‡Ì‘Ì°Ì«Ì° ÌµÍ‚Ì”Ì„Ì™Ì¨ÌŸfÌ´Í‘Í“ÌlÌµÌ‘Í„ÌÌºÌ¥aÌ·Ì”Í–ÍœÍ“gÌµÌ…ÌÍ‚ÌÍ‡ ÌµÌŠÌ“Í€Í‰ÌºmÌµÌ‡Ì†Ì­Ì™uÌµÍ‚Ì‰Ì²sÌµÌ…Í‘Í…Ì©tÌµÌšÌ’Ì™Í…Ì³ Ì´Í’ÌŠÌ²Ì¢Ì©bÌ·ÌˆÌ³Ì¤eÌ·Í€ÌˆÌ¡ Ì¸Í›Ì‹Ì’ÌÍ™â–ˆÌ´Ì¿ÌƒÍ…Ì¨Ìºâ–’Ì·Í‘Ì¹Íœâ–ˆÌ¸ÌÍ’ÌŒÌ¯â–ˆÌ¸ÍÍ„ÍÌ˜â–’Ì·Í†Ì©Ì²Íˆâ–“ÌµÍ„Ì¥Ì–â–’Ì´Ì‚Ì½Ìºâ–ˆÌ´ÌšÌªÌ¨Ì£â–’ÌµÌŠÌ²Ì®â–“Ì·ÍÌ³â–’Ì·Í‹ÍÌ¼Ì¹Íˆâ–ˆÌµÌ‚Í˜ÌŸÌ³Ì»â–’Ì¶Ì‡Ì§Ìªâ–’Ì¸ÌˆÌ¦Í‰Ì­â–ˆÌ¸ÌƒÍ›Í…â–ˆÌ¸Ì‡Ì¡.Ì¶Í’Ì„Ì‹Í™Ì»&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">checker</span><span class="o">:</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">sha256</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">38</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;e3c817&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;YÌ¶Í†Ì“Ì„Ì®Í™oÌµÌ…Ì‰Ì”ÍˆÍuÌ´Í‹Ì‘Ì²Ì»rÌ·ÍÌšÌ°Ì° Ì·Í ÌÌ¦Ì«ÌªfÌ¶Ì€Ì¼lÌ·ÍÌ‡Ì†Ì¹aÌ´Ì›Í“Ì°ÌºgÌµÍ’Ì¯ Ì´Í Ì›Í›Ì¯Í‰mÌ·Ì“Ì‰ÌÌ¹Í™uÌ·ÌŠÌ£sÌµÌ•Ì¨Ì tÌ¸Ì†Í“Ì«Ì Ì·ÍÍbÌ·ÍÍ Ì‰Ì²eÌ¶Ì‡ÌºÌ¡Ì± Ì´Í€Í–â–ˆÌ¸Í—Ì‚Ìâ–’Ì·ÍÍÍÌ â–“Ì¸ÌÍÌ™ÌÍˆâ–“Ì´Í‘Í“â–’Ì¸Í„Ì•Ì¿Íâ–“Ì¶Í€Ìªâ–“Ì¶Ì‡Í•Í…Ì§â–ˆÌ´Í›ÌÌœÌ°â–“Ì´Ì‡Í’Ì¯Ì°Ì¡â–’ÌµÌŒÍ–â–“Ì¶ÌˆÍ€Í“Ì¦â–’ÌµÌ”ÍÍÍšâ–ˆÌµÍ†Ì”Í”Í‰â–ˆÌ¶ÌƒÌ©Ì¦Ìâ–ˆÌ·ÍÌ£Ì¨Íˆâ–ˆÌµÌŠÌƒÌ±Ì£Ì©.ÌµÍ’Ì›Ì—&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">checker</span><span class="o">:</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">sha224</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">28</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;0b67cb&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;YÌ·Ì„Ì’Í’Í™Ì¢oÌµÍ‘Ì„Ì©Ì¡Ì³Ì—uÌ´ÌƒÌ‰Ì’ÌƒÍ”Ì±rÌ¶ÍÌÍÌ¯Ì± Ì·Ì€Ì‘ÌšÍ…Ì Ì¦fÌµÍÍ Ì Ì¤Ì­lÌ´ÍÌ¿Í Í•Ì²aÌ¸ÍŒÌ˜Í•Ì­Ì¹gÌ¸ÌÌ¬Ì¹ ÌµÍÌ‘Ì®mÌ¶Í‹Ì”Ì®Ì«ÌŸuÌ¸Ì…Ì£Í‡sÌ´ÌšÌ†Ì”Í†ÍÍ‡tÌ¶ÌÌŒÌ™Ì®Ì¼Ì§ Ì´Í’ÍƒÍ‹Ì‡Í™bÌ·ÍÌ’Ì¢eÌ¶ÌŠÌ½Í Ì™ÍœÍˆÍ– Ì¸Ì•ÍÌ©Ìâ–“ÌµÌÌ¼ÍœÍˆâ–’Ì·Ì“Í›Ì•Ì™ÍœÍˆâ–ˆÌ¸Í‚Í‘Í‹ÍŒÍ“Ì˜Ì¤â–’Ì¶Í Ì‘ÍÍ†Ì™Ì±Ì—Í‡â–ˆÌ¸Í†ÍƒÌ¦â–ˆÌµÍÍ”Í“â–“ÌµÍÌ¡Ì©â–’ÌµÌ›Ì¦Ì«Ì¬Í”â–“Ì¶Ì’Ì¦Ì¹Ì¯Í…â–ˆÌµÌŠÌ¿Ì‡Í”Í–â–’Ì¸ÌšÍ‚ÍÌœâ–’Ì´Ì‹ÍÌ²â–’Ì´ÍÍÌ»â–“Ì¸Ì¾ÍŠÌ«â–ˆÌ·Ì„Í€Ì¿Ì’ÍÍ“Ì¼Ì¡â–“Ì´Ì„ÌƒÌ„Íœ.Ì·ÍŒÌ”ÌÌˆÌŸÌ¢&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">checker</span><span class="o">:</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">sha256</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">32</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;f9f48b&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;YÌµÍÌŒÌ‡Í–Í‡oÌ¶ÌˆÍ†Í–uÌ´ÌÌªrÌµÌ’Ì›Ì¼Ì—Ì¦Ì§ Ì·ÍÍ†Ì‹ÍœÌ Ì£Ì fÌ¸Í›Í–lÌ¸Ì›Í’Ì¡Ì Ì¢aÌ·Í—Ì©Ì¡Ì—gÌ¶Ì…ÍÌ‹Í›Ì–Í Ì¸ÍÌ®Ì¨ÌºÌ¯mÌµÍÍ Í›ÍœÌ©ÍuÌ¶Í‘ÌŠÍ„Í€ÍÌ©sÌµÌ€Í›Í•tÌ´Ì‡Ì©Ì£Ì°Ìº Ì¶ÌƒÍ‚ÍÌ¦bÌ·ÍÌ²Ì£eÌ¶ÌŠÍ„Í‡Ì® Ì´ÍÍŠÌ¢Í“â–“Ì¶Í—Í‘Ì£Ì³Ì Ì»â–“ÌµÌŒÌ€Í„ÌÍ…â–“Ì¶Ì…Í‹Ì‡ÍŠÌ˜Íâ–ˆÌ·Ì½Ì£Ì°Ì¥Íâ–ˆÌµÌ†Ì…Í€Ì“ÌœÌ©Ì¢Íâ–“Ì´Í‚ÌšÌ‰Í’Ì˜Ì¦Ì¦Í‰â–ˆÌ´Í„ÌŸÌ­ÍÌ±â–“Ì´ÍÌÌ‡Í—Ì­Í”Ì—Íœâ–“Ì·ÍÍ†Ì»ÌªÌâ–ˆÌ¶Ì‰Ì‘Ì”Í‰Ì¬Ì Ì¥â–ˆÌµÍ„ÌÍŠÍšÌ ÍˆÌ¦â–’Ì¸ÌÌÍ“ÍÍˆâ–’Ì·Ì¾Ì½Ì±Ì²Ì–â–“Ì·Ì‹Í„Í‹Ì½Ì±Ìºâ–’Ì¸Í—Ì¾ÍÌ¨â–’Ì¶ÌƒÍÌ›ÍˆÍ“ÌºÌ¯.Ì´Ì½Í„Ì¿Ì±ÌºÍ&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">checker</span><span class="o">:</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">sha224</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">34</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;69260f&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;YÌ¶Í†ÌÌ£Í•Ì¹oÌµÍ›Í„ÍÍÌªÍ™Ì–uÌ¸ÌÍ„Í Í“Ì­rÌµÌŒÍ—ÌÌ± Ì¸ÍÌÍšÌ˜fÌ¶Ì›Ì”Ì¡Ì«Ì»Ì¤lÌµÍ‚ÍÌ‰ÍˆÍ…aÌ¸Í ÍÍˆgÌ·Í‚Ì’ÍÌ’Ì ÌµÍ„ÌŠÍ€ÍŠÌ¢Ì¦mÌ¸Ì…ÌŒÍÌ‹Ì—ÍœuÌ´Í Ì‡Í˜ÌÌ©Ì¢sÌ¸Í˜ÍÍ‡ÌŸÌ»tÌ¸Í—Í Í€Ì©Ì®Ì¯ Ì¸Ì„Í Ì–ÍœbÌµÍÍƒÍ˜Ì®Ì¤eÌµÌ„Í‹Ì’Ì™Ì™ ÌµÍ„Ì¾Ì Ì¨â–ˆÌ´ÌŒÍ Ìâ–“ÌµÍ‘Ì§Í‰Ì²Ì¼â–ˆÌ¸Ì½Ì—Ì«â–’Ì·ÌƒÍ’ÌƒÍœâ–ˆÌ·Ì½Í„Ì”Ì»Ì¼Ì¯â–“Ì¶ÌŒÍ“Ì©Ìªâ–ˆÌ´ÌˆÍŠÌ™ÍÌ¡Ì»â–ˆÌ¸ÌÍ‘ÌÌ¬Ì±Ì¨â–ˆÌµÍ„ÌÌ”Ì¦Í…Íˆâ–’Ì¸Í˜Í‚Í‚ÍŠÌÍÌ¼Ì¥â–’Ì´Ì‡Ì›Ì•Ì¯Ì¥Ì¯Ì£â–“ÌµÌ‹Ì¬Ì®ÌŸÍ‰â–’Ì·Í’Ì¤ÌªÍ“Ì¼â–’Ì´Ì›ÍŠÌŒÍ’ÍˆÍ–Ì§Íœâ–“ÌµÌ‚Í†Ì¡â–“Ì·Ì¿Ì­Ì™Ì«.Ì¸ÌšÌ³&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">checker</span><span class="o">:</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">sha256</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">18</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;c25dd2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;YÌ·ÍÌ€Ì¼oÌ´ÌŠÍˆuÌ´Ì•Ì’Ì‘ÌÌ±Ì¹rÌ´Ì‡ÌšÌ¼Ì³Ì±ÍœÍ– Ì´ÌƒÌ•ÍÍ‹Ì Ì¦fÌ·ÍÍ„Ì¨Ì²Ì£lÌ·ÍŠÌ‰ÌÍšaÌ¶ÌƒÌ²Ì§Ì±Ì©gÌ´ÌŠÌ‘Ì¾Ì Í“ Ì¶Ì‚Ì‚Í‘ÌºÍ‡Ì—mÌ´ÌÌÌ‹Ì•Í„Ì³uÌ¸Í‚ÍŒÌŠÌ¯Ì­Ì³sÌ¸Í‹Ì‰ÌƒÌÌ‘Í•Í–Ì¬Í“tÌ·ÌƒÌ‰ÌÌ„Ì¯Ì§ÌŸ Ì¶Ì„Í—ÍŒÍ‘Ì€Ì—ÌÌ£Ì¦Ì¤bÌ·Í„ÍƒÌÌ­Ì¨Ì—eÌ¸Í›Ì‘ÌšÌ‘Ì¹Ì°Ì±Ì« Ì¸Í‘ÍƒÍƒÌ¨Ì¬Ì±Ì²Ì®â–’Ì·Í†Ì‡ÌªÌ²â–’Ì·ÍŒÌˆÍƒÍÍ‚Ì â–“Ì´ÌƒÍÍ—Ì‡ÍÌ–â–ˆÌ´Í€Ì–Ì²â–“Ì¶ÌƒÍœÌ­ÍˆÌ¨Ì—â–’Ì¸Ì‘ÌŠÌ†Ì­Ì¢â–ˆÌ·Í˜ÌÍÌ‘Ì­ÍÍˆâ–ˆÌµÌ’Ì‘ÌƒÌÌ Ì¼ÌºÌ Ì­â–ˆÌµÌˆÍ˜Ì£â–ˆÌ·Ì”Ì•Ì†ÌÍšÌ«Ì®â–“Ì¶Í—ÌÍ–Ì­Í™Ì¼â–ˆÌ¸Ì‡ÍŠÌÍ—Ì“ÍœÌ±Í”â–ˆÌ·Ì‰Í—ÍŠÌ‰Ì‰Ì¤Ì¡Ì¯Í–â–ˆÌ´Í Í›Ì”Ì¡â–ˆÌ·Í›Í‘ÌƒÌ‚Ìœâ–ˆÌ´Ì½Ì¢Ì¦Ì¥Ì¯.Ì¸ÌˆÌˆÌÌ”Í…Ì³Í”Í“Í™&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">checker</span><span class="o">:</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">sha256</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;cbe2c9&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;YÌ¶Í„ÌÍ’Í‚Ì’Ì»oÌµÌ”ÍÌÌ¨uÌ¶Ì‚ÌŒÌ¾Í›Ì‚Ì¯Ì¯Í™rÌ¸ÍÌ“Ì‚Í„ÌœÌ¥Ìª ÌµÍ Í‘Ì‰Ì“Ì½ÌÍ‡Í…fÌ·ÌŒÌ–Ì§Í–lÌµÌ…Ì’Ì±Ì¨aÌ¸Í—Ì½Í‹Ì½Ì³ÍÍ”Ì­gÌ´Ì‰Ì„Í‘Ì”Ì•Ì¼ Ì·ÌƒÌ‡Ì†Ì¾Ì‡ÌªÌ¹mÌ·ÌÍ˜Í”Í–Ì¤uÌ´ÍƒÍ„ÌÌ¨Ì«sÌ·ÌÌ¹Ì¢tÌ´Í‹Ì‘Ì’ÍœÌÌ¬ Ì·ÌƒÍ‘Í„Ì…Í’Ì­Í™Ì Ì¡bÌ·ÌÌ¾ÌÌ•ÍŒÌ»ÌŸÌœÍ‡eÌ¶Ì‘ÍÌ„ÌˆÌ¢Í•ÌœÍ–Ìœ Ì·Ì¾Ì’ÌÍ•Ì¦Ì¦â–’ÌµÌ‘Í›ÍÌÍ„Ì§Í–Ì¤â–“ÌµÍ—Ì”Í˜Í„ÌÌ¨â–ˆÌµÌÌ¿ÍŒÍ‚ÍŒÌ°Ì»â–“Ì¸Í€ÌŒÌÌ“Í”Ì™ÍÌ¥â–“Ì¸Ì“Í›Ì›Ì¯Ì¤ÍˆÌ¦â–“Ì´Í„ÌƒÍ˜Ì•Í†Ì§Í‡Í”Ì¢â–ˆÌµÌˆÌ¯Ì¤Ì²Ì¦Ì—â–ˆÌ·ÌšÍ„Ì£Ì¢Ì³Ì™Ì°â–ˆÌ¸Ì‚ÌƒÍƒÌÍÌ™Ì¬Ì©Ì—â–ˆÌ·Í’Ì”ÌªÌ—Í‡Í™Íœâ–“Ì·Ì‘ÍˆÌ±Ì»Ì¬Í‡â–ˆÌµÍÌ‹ÍÌ±Ì«Ì¯ÌªÌ™â–ˆÌ´Í‹Í™Í•ÌŸÌ±Ìâ–ˆÌ¸ÌÍ‹Í€Í“â–’ÌµÍ˜Í†ÍŠÍÌ¾Ì¥Í•â–’Ì¸ÌÌºÌ—ÍÌ«.ÌµÍÌº&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">checker</span><span class="o">:</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">sha224</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;ce45fd&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;YÌ¶Í‹ÍŠÍ ÍÌ‘Ì¤ÌºÌoÌ¸ÍŒÍ‚Ì…Ì’ÍÍˆÌ©uÌ¸Í„Ì½Ì­ÌªrÌ´ÌˆÌ„Ì¿Ì€Í—Ì™Ì¯Ì¦Ì— Ì¸Ì¿ÌŒÌœfÌµÍ—Ì“Ì¼Ì§ÍÍ…ÍlÌ¶Ì›Ì…Ì§Ì¼Í‡aÌ´Í†Í†ÍÍÌ–Ì¦Ì¯gÌ´Ì…Ì¿Ì“Í›Ì˜ Ì¸ÍÍ˜ÌÌ°Í“Ì©Í™mÌµÍŒÍ€ÌÌ«Ì³Ì™uÌ¶Ì‰ÌƒÌ£sÌ¶Í‹Í…tÌ¶Ì’Ì½ÍÍ‚Ì¥Í–ÌœÌŸ Ì¶Í‘ÌÍ‹Í„Ì²ÌœÌ˜bÌ·ÌÌˆÌ”Ì‹Ì½ÍœÌeÌ·Ì…ÌÍ—Ì“Ì’Ì»Ì¡Ì° ÌµÌ’Ì‘ÍšÌ Ì Íâ–’Ì¸Ì‰Ì‰ÍÍ Ì«Ìœâ–“Ì´ÌÌ‘Ì¿Í„Ì¢Íšâ–ˆÌ¶ÍƒÍ‚Í€Í’Ì¬Ì–Ìâ–’Ì´ÍÌ©ÍœÍ™â–’ÌµÍ Ì•Ì—Ì¦â–ˆÌ·Í’Ì½Ì¾Ì‹Ì¯Ì«Ìâ–“Ì·Ì„Ì„Ì‰ÌÌ‡Ì­ÌºÌ»Í•â–’Ì·ÌÌ§â–’Ì¶ÌÌ’Ì£Ì«Ì±â–’Ì¶Í„Ì«ÍšÌ™â–’Ì´ÌÌ•ÌÌÌºÌ¬Ì¼Íˆâ–ˆÌ¶Í—Í‚ÌÌÍ“Ì©â–’Ì¸Í’ÌÌ±Ì—Ì¹Ì¬â–“Ì¸Ì‹Ì¿ÌŠÌˆÌ Ì¦â–’ÌµÌ‘ÌÌŠÍƒÌˆÌâ–ˆÌ¶Ì”ÌŠÍ…Ìœ.Ì¶ÍŠÍÌ‚Ì›Ì§Ì£&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">checker</span><span class="o">:</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">sha256</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">42</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;e3c817&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}]</span>
</span></span></code></pre></div><p>We can see that the &quot;obfuscated&quot; rules are checking the SHA256 and SHA224 digests of the prefixes. We can rewrite the above rules as a checker function:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">isFlag</span><span class="p">(</span><span class="nx">flag</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">sha224</span><span class="p">(</span><span class="nx">flag</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;b08c89&#39;</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">sha224</span><span class="p">(</span><span class="nx">flag</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;ce45fd&#39;</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">sha256</span><span class="p">(</span><span class="nx">flag</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;87b3c7&#39;</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">sha256</span><span class="p">(</span><span class="nx">flag</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;d0687a&#39;</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">sha256</span><span class="p">(</span><span class="nx">flag</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;cbe2c9&#39;</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">sha256</span><span class="p">(</span><span class="nx">flag</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">18</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;c25dd2&#39;</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">sha256</span><span class="p">(</span><span class="nx">flag</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;b72709&#39;</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">sha224</span><span class="p">(</span><span class="nx">flag</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">22</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;8b035b&#39;</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">sha256</span><span class="p">(</span><span class="nx">flag</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;40f34c&#39;</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">sha256</span><span class="p">(</span><span class="nx">flag</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">26</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;7be965&#39;</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">sha224</span><span class="p">(</span><span class="nx">flag</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">28</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;0b67cb&#39;</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">sha224</span><span class="p">(</span><span class="nx">flag</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;bf7eeb&#39;</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">sha256</span><span class="p">(</span><span class="nx">flag</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">32</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;f9f48b&#39;</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">sha224</span><span class="p">(</span><span class="nx">flag</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">34</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;69260f&#39;</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">sha256</span><span class="p">(</span><span class="nx">flag</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">36</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;7ef31a&#39;</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">sha256</span><span class="p">(</span><span class="nx">flag</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">38</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;e3c817&#39;</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">sha224</span><span class="p">(</span><span class="nx">flag</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;8a9de8&#39;</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">sha256</span><span class="p">(</span><span class="nx">flag</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">42</span><span class="p">)).</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;e3c817&#39;</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Since we know the flag starts with <code>hkcert23</code>, we know 8 bytes of the flag. To recover the full flag, we can repeatedly exhaust two more bytes to check if the next rule is valid.</p>
<p>Eventually we will have the flag: <code>hkcert23{h0p3_y0u_u53d_th3_s0urc3m4p}</code>.</p>
<h2 id="loot-and-scoot">Loot and Scoot<a href="#loot-and-scoot" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h3 id="challenge-summary-4">Challenge Summary<a href="#challenge-summary-4" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<blockquote>
<p>Collect the keys and unlock the crypt to the flag.</p>
<p>http://HOST:PORT/</p>
<p>Attachments: <a href="https://github.com/blackb6a/hkcert-ctf-2023-challenges/releases/download/v1.0.0/loot-and-scoot_91f788ef9735eb6ba507b61fa313e230.zip"
   
   target="_blank" rel="noopener noreferrer" >loot-and-scoot.zip</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></p>
</blockquote>


<figure>
  <img src="/images/2024-01-27-hkcert-ctf/loot-and-scoot-game.png" title="">
  
</figure>

<p>In the challenge, we are given a binary (written in C) which is the server, as well as a web client for interaction.</p>
<p>The goal is to unlock the chambers and interact with <img src="/images/2024-01-27-hkcert-ctf/loot-and-scoot-flag.png" style="display: inline;"> the flag within 100 seconds, as we have 100 HP and we lose 1 HP every second.</p>
<h3 id="solution-4">Solution<a href="#solution-4" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>We are given the binary for the backend written in C and a HTTP client. The backend uses protocol buffers and websocket to allow interactions with the web.</p>
<p>As the challenge author, I will just skip the reverse engineering part and share the source code directly.</p>



  <div class="collapsable-code">
    <input id="176948352" type="checkbox" checked />
    <label for="176948352">
      <span class="collapsable-code__language">c</span>
      <span class="collapsable-code__title">Source code for game.c</span>
      <span class="collapsable-code__toggle" data-label-expand="[â–³]" data-label-collapse="[â–½]"></span>
    </label>
    <pre class="language-c" ><code>
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;assert.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;ws.h&gt;
#include &#34;maze_runner.pb-c.h&#34;

#define GRID_COLS 55
#define GRID_ROWS 55
#define COORD(x, y) (GRID_COLS * y &#43; x)
#define DIST2(x, y) ((x) * (x) &#43; (y) * (y))
#define TILESET_SIZE 12
#define ITEM_COUNT 4
#define MAX_CLIENTS 1024

typedef struct GameTile GameTile;
typedef struct Player Player;
typedef struct Monster Monster;

typedef struct Context
{
    GameTile **tileset;
    GameTile **grid;
    Player *player;
    Monster *monster;
    int *inventory;
    char *message;
    ws_cli_conn_t *client;
} Context;

typedef struct Player
{
    int x;
    int y;
    int facing;
    int health;
} Player;

typedef struct Monster
{
    int x;
    int y;
} Monster;

typedef struct GameTile
{
    int type;
    void (*on_enter)(Context *ctx, int x, int y);
    void (*on_interact)(Context *ctx, int x, int y);
    int is_walkable;
    int is_interactable;
} GameTile;

// ---

unsigned long long int GRID[] = {
    0, 0, 0, 2459530691549855744, 144680483117212162, 2450523355428823554, 2306443351725048354, 137975832616, 9007199793717280, 9042384163708960, 2450558539798685984, 153722729841951266, 2450523492867768866, 2345624797730, 2305843009215791104, 35321811050496, 536879136, 2450523492865671168, 153687544932999714, 2459565738516677154, 2305878202748379682, 2314885393377402912, 2314885530281582624, 2305843147189518368, 2450558676702994944, 2450523492867768834, 153687682908815906, 2305878193621565986, 35321813147648, 9042384163708928, 9007336695791648, 153687544930902562, 144680483115115010, 153687682906718722, 2305878194122793474, 2314885392842629152, 2305843009750573056, 2449958335265374208, 144680483115115010, 2459565876492509730, 144680346215129602, 9007337230565922, 538968064, 9007337230565376, 153685474722979872, 2459565875957735938, 2459530691583549986, 153722729841959426, 2314850345907396610, 9042383628935168, 2305878194122653728, 153722721216233504, 2450523492330897954, 2459565738516677154, 144715668026163714, 2314885530279477280, 2314885393379491872, 0, 2459530554110902272, 144715530048242178, 2459565875955638818, 9607679205057058, 2305878331563704352, 2314885392840532000, 0, 144715530585120768, 2450523354891944450, 2459565875955630626, 9044591812682274, 9007199254749216, 2314885530816356352, 2305843009213693952, 2459565738518774304, 153687544932991490, 2459565875955630626, 2305878339648365090, 2305878331026841600, 2314885530279485472, 2314885392840523776, 153687545467765250, 153687682906726946, 2459565875955630594, 2314885530850034178, 2305878331024736288, 2314885530816356384, 153157709678510080, 2450558539261936130, 153687682369856002, 144715667487195650, 35322350141954, 8192, 2314885530816356352, 2459563668847731234, 2459565876494606882, 5927337589569888802, 144680487954305634, 137438962178, 35184908967936, 2459000718894309408, 2459530683498897442, 144680346213032482, 144680345678250530, 144680346215121410, 2305843146652647458, 9007199254749216, 137977929760, 2459565739021967392, 144715667489292802, 144680346215121442, 2450523355428823586, 9007336693702656, 9007337232662528, 2105376, 144680345678127136, 153722867280912898, 2459530554144588290, 2315415366607708706, 2305878331563712544, 2314885530279485472, 32, 153722729839861792, 144680345678250498, 2459565875955638818, 9044591812682274, 2305843147191615520, 9007199793717248, 0, 153687682371944992, 2450523354889855522, 2459565876494598690, 2305878340187333154, 2305843146652655616, 2105376, 0, 153687682371953152, 2459565875957735970, 153722866744042018, 137474744866, 137977921536, 2305843009750573088, 35184911056928, 153687682906726946, 153687544930902562, 2459565738516677122, 2314850346444390914, 2314885530279477248, 2314885530816348192, 144150509886898208, 2450558539798807074, 2450523492330897922, 153722729302983170, 2305843146654745122, 9042383628935200, 2305878331563712512, 153685474725068832, 2459565739053548066, 144715668024066562, 144715530050339330, 9042384163700738, 9007336695791648, 2305878194122661888, 2459565730432032800, 2450523354889855490, 2450558677237760546, 153722729302991362, 9007337230565408, 2314885530281574432, 9007199791620128, 153722729271402528, 153722729302991362, 144715530048242210, 565157602402850, 2314885393377402880, 2105344, 35184911065088, 2450523424146063392, 144680345678250498, 144680483117203970, 3035428494472512002, 2314850346444267552, 2314850346446364672, 2314885393379500064, 2459530691585638443, 2459530692120420898, 2459565875957735970, 9160491554, 0, 0, 0, 0};

void on_default_enter(Context *ctx, int x, int y) {}

void on_default_interact(Context *ctx, int x, int y) {}

void on_key_1_interact(Context *ctx, int x, int y)
{
    char *message = malloc(20 &#43; 1);
    strcpy(message, &#34;You picked up a key.&#34;);
    ctx-&gt;message = message;

    ctx-&gt;inventory[0] &#43;= 1;
    ctx-&gt;grid[COORD(x, y)]-&gt;type = 2;
    ctx-&gt;grid[COORD(x, y)]-&gt;is_walkable = 1;
    ctx-&gt;grid[COORD(x, y)]-&gt;on_interact = on_default_interact;
    ctx-&gt;grid[COORD(x, y)]-&gt;is_interactable = 0;
}

void on_key_2_interact(Context *ctx, int x, int y)
{
    char *message = malloc(20 &#43; 1);
    strcpy(message, &#34;You picked up a key.&#34;);
    ctx-&gt;message = message;

    ctx-&gt;inventory[1] &#43;= 1;
    ctx-&gt;grid[COORD(x, y)]-&gt;type = 2;
    ctx-&gt;grid[COORD(x, y)]-&gt;is_walkable = 1;
    ctx-&gt;grid[COORD(x, y)]-&gt;on_interact = on_default_interact;
    ctx-&gt;grid[COORD(x, y)]-&gt;is_interactable = 0;
}

void on_key_3_interact(Context *ctx, int x, int y)
{
    char *message = malloc(20 &#43; 1);
    strcpy(message, &#34;You picked up a key.&#34;);
    ctx-&gt;message = message;

    ctx-&gt;inventory[2] &#43;= 1;
    ctx-&gt;grid[COORD(x, y)]-&gt;type = 2;
    ctx-&gt;grid[COORD(x, y)]-&gt;is_walkable = 1;
    ctx-&gt;grid[COORD(x, y)]-&gt;on_interact = on_default_interact;
    ctx-&gt;grid[COORD(x, y)]-&gt;is_interactable = 0;
}

void on_key_4_interact(Context *ctx, int x, int y)
{
    char *message = malloc(20 &#43; 1);
    strcpy(message, &#34;You picked up a key.&#34;);
    ctx-&gt;message = message;

    ctx-&gt;inventory[3] &#43;= 1;
    ctx-&gt;grid[COORD(x, y)]-&gt;type = 2;
    ctx-&gt;grid[COORD(x, y)]-&gt;is_walkable = 1;
    ctx-&gt;grid[COORD(x, y)]-&gt;on_interact = on_default_interact;
    ctx-&gt;grid[COORD(x, y)]-&gt;is_interactable = 0;
}

void on_gate_1_interact(Context *ctx, int x, int y)
{
    if (ctx-&gt;inventory[0] == 0)
    {
        char *message = malloc(32 &#43; 1);
        strcpy(message, &#34;You don&#39;t have the required key!&#34;);
        ctx-&gt;message = message;
        return;
    }
    else
    {
        char *message = malloc(22 &#43; 1);
        strcpy(message, &#34;You unlocked a gate.&#34;);
        ctx-&gt;message = message;
    }
    ctx-&gt;inventory[0]--;
    ctx-&gt;grid[COORD(x, y)]-&gt;type = 2;
    ctx-&gt;grid[COORD(x, y)]-&gt;is_walkable = 1;
    ctx-&gt;grid[COORD(x, y)]-&gt;on_interact = on_default_interact;
    ctx-&gt;grid[COORD(x, y)]-&gt;is_interactable = 0;
}

void on_gate_2_interact(Context *ctx, int x, int y)
{
    if (ctx-&gt;inventory[1] == 0)
    {
        char *message = malloc(32 &#43; 1);
        strcpy(message, &#34;You don&#39;t have the required key!&#34;);
        ctx-&gt;message = message;
        return;
    }
    else
    {
        char *message = malloc(22 &#43; 1);
        strcpy(message, &#34;You unlocked a gate.&#34;);
        ctx-&gt;message = message;
    }
    ctx-&gt;inventory[1]--;
    ctx-&gt;grid[COORD(x, y)]-&gt;type = 2;
    ctx-&gt;grid[COORD(x, y)]-&gt;is_walkable = 1;
    ctx-&gt;grid[COORD(x, y)]-&gt;on_interact = on_default_interact;
    ctx-&gt;grid[COORD(x, y)]-&gt;is_interactable = 0;
}

void on_gate_3_interact(Context *ctx, int x, int y)
{
    if (ctx-&gt;inventory[2] == 0)
    {
        char *message = malloc(32 &#43; 1);
        strcpy(message, &#34;You don&#39;t have the required key!&#34;);
        ctx-&gt;message = message;
        return;
    }
    else
    {
        char *message = malloc(22 &#43; 1);
        strcpy(message, &#34;You unlocked a gate.&#34;);
        ctx-&gt;message = message;
    }
    ctx-&gt;inventory[2]--;
    ctx-&gt;grid[COORD(x, y)]-&gt;type = 2;
    ctx-&gt;grid[COORD(x, y)]-&gt;is_walkable = 1;
    ctx-&gt;grid[COORD(x, y)]-&gt;on_interact = on_default_interact;
    ctx-&gt;grid[COORD(x, y)]-&gt;is_interactable = 0;
}

void on_gate_4_interact(Context *ctx, int x, int y)
{
    if (ctx-&gt;inventory[3] == 0)
    {
        char *message = malloc(32 &#43; 1);
        strcpy(message, &#34;You don&#39;t have the required key!&#34;);
        ctx-&gt;message = message;
        return;
    }
    else
    {
        char *message = malloc(22 &#43; 1);
        strcpy(message, &#34;You unlocked a gate.&#34;);
        ctx-&gt;message = message;
    }
    ctx-&gt;inventory[3]--;
    ctx-&gt;grid[COORD(x, y)]-&gt;type = 2;
    ctx-&gt;grid[COORD(x, y)]-&gt;is_walkable = 1;
    ctx-&gt;grid[COORD(x, y)]-&gt;on_interact = on_default_interact;
    ctx-&gt;grid[COORD(x, y)]-&gt;is_interactable = 0;
}

void on_flag_interact(Context *ctx, int x, int y)
{
    FILE *fd = fopen(&#34;flag.txt&#34;, &#34;r&#34;);
    char flag[128];
    char *message = malloc(256);

    fscanf(fd, &#34;%s&#34;, flag);
    sprintf(message, &#34;Congratulations! You got the flag: %s.\n&#34;, flag);
    ctx-&gt;message = message;
}

int walk(Context *ctx, int dx, int dy)
{
    int x1 = ctx-&gt;player-&gt;x, y1 = ctx-&gt;player-&gt;y;

    int x2 = x1 &#43; dx, y2 = y1 &#43; dy;

    if (!ctx-&gt;grid[COORD(x2, y2)]-&gt;is_walkable)
        return 1;
    if (ctx-&gt;monster-&gt;x == x2 &amp;&amp; ctx-&gt;monster-&gt;y == y2)
        return 1;
    ctx-&gt;player-&gt;x &#43;= dx;
    ctx-&gt;player-&gt;y &#43;= dy;
    ctx-&gt;grid[COORD(x2, y2)]-&gt;on_enter(ctx, x2, y2);
    return 0;
}

int DXS[4] = {&#43;0, &#43;1, &#43;0, -1};
int DYS[4] = {-1, &#43;0, &#43;1, &#43;0};

int FAN_XXS[4] = {0, &#43;1, 0, -1};
int FAN_XYS[4] = {&#43;1, 0, -1, 0};
int FAN_YXS[4] = {-1, 0, &#43;1, 0};
int FAN_YYS[4] = {0, &#43;1, 0, -1};

Context *ctxs[MAX_CLIENTS];

void send_state_via_ws(Context *ctx)
{
    if (ctx == NULL)
        return;
    ws_cli_conn_t *client = ctx-&gt;client;

    int x = ctx-&gt;player-&gt;x;
    int y = ctx-&gt;player-&gt;y;

    int x2 = ctx-&gt;player-&gt;x &#43; DXS[ctx-&gt;player-&gt;facing];
    int y2 = ctx-&gt;player-&gt;y &#43; DYS[ctx-&gt;player-&gt;facing];

    Response res = RESPONSE__INIT;

    // grids
    Tile **grids = malloc(25 * sizeof(Tile *));
    int n_grids = 0;

    for (int i = 0; i &lt; 5; i&#43;&#43;)
    {
        for (int j = -i; j &lt;= i; j&#43;&#43;)
        {
            Tile *tile = malloc(sizeof(Tile));
            tile__init(tile);
            tile-&gt;offset_horizontal = i;
            tile-&gt;offset_vertical = j;

            int x = ctx-&gt;player-&gt;x &#43; FAN_XXS[ctx-&gt;player-&gt;facing] * i &#43; FAN_XYS[ctx-&gt;player-&gt;facing] * j;
            int y = ctx-&gt;player-&gt;y &#43; FAN_YXS[ctx-&gt;player-&gt;facing] * i &#43; FAN_YYS[ctx-&gt;player-&gt;facing] * j;

            int type;
            if (x &lt; 0 || x &gt;= GRID_COLS)
                type = 0;
            else if (y &lt; 0 || y &gt;= GRID_ROWS)
                type = 0;
            else
                type = ctx-&gt;grid[COORD(x, y)]-&gt;type;
            tile-&gt;type = type;
            grids[n_grids&#43;&#43;] = tile;
        }
    }

    res.n_grids = n_grids;
    res.grids = grids;

    // entities
    Entity **entities = malloc(25 * sizeof(Entity *));
    int n_entities = 0;

    for (int i = 0; i &lt; 5; i&#43;&#43;)
    {
        for (int j = -i; j &lt;= i; j&#43;&#43;)
        {
            Entity *entity = malloc(sizeof(Entity));
            entity__init(entity);
            entity-&gt;offset_horizontal = i;
            entity-&gt;offset_vertical = j;

            int x = ctx-&gt;player-&gt;x &#43; FAN_XXS[ctx-&gt;player-&gt;facing] * i &#43; FAN_XYS[ctx-&gt;player-&gt;facing] * j;
            int y = ctx-&gt;player-&gt;y &#43; FAN_YXS[ctx-&gt;player-&gt;facing] * i &#43; FAN_YYS[ctx-&gt;player-&gt;facing] * j;

            if (ctx-&gt;monster-&gt;x == x &amp;&amp; ctx-&gt;monster-&gt;y == y)
                entity-&gt;type = 1;

            entities[n_entities&#43;&#43;] = entity;
        }
    }

    res.n_entities = n_entities;
    res.entities = entities;

    // inventory
    res.n_item_counts = ITEM_COUNT;
    res.item_counts = ctx-&gt;inventory;

    // message
    res.message = ctx-&gt;message;

    // possible moves
    int n_possible_moves = 0;
    Move possible_moves[4] = {0};
    possible_moves[n_possible_moves&#43;&#43;] = MOVE__LEFT;
    possible_moves[n_possible_moves&#43;&#43;] = MOVE__RIGHT;
    if (0 &lt;= x2 &amp;&amp; x2 &lt; GRID_COLS &amp;&amp;
        0 &lt;= y2 &amp;&amp; y2 &lt; GRID_ROWS &amp;&amp;
        ctx-&gt;grid[COORD(x2, y2)]-&gt;is_walkable)
        possible_moves[n_possible_moves&#43;&#43;] = MOVE__FORWARD;
    if (0 &lt;= x2 &amp;&amp; x2 &lt; GRID_COLS &amp;&amp;
        0 &lt;= y2 &amp;&amp; y2 &lt; GRID_ROWS &amp;&amp;
        ctx-&gt;grid[COORD(x2, y2)]-&gt;is_interactable)
        possible_moves[n_possible_moves&#43;&#43;] = MOVE__INTERACT;

    res.n_possible_moves = n_possible_moves;
    res.possible_moves = possible_moves;

    res.health = ctx-&gt;player-&gt;health;

    size_t packed_response_size = response__get_packed_size(&amp;res);
    char *packed_response = malloc(packed_response_size);
    response__pack(&amp;res, packed_response);
    ws_sendframe_bin(client, packed_response, packed_response_size);

    if (ctx-&gt;message != NULL)
    {
        free(ctx-&gt;message);
        ctx-&gt;message = NULL;
    }
    for (int i = 0; i &lt; 25; i&#43;&#43;)
        free(grids[i]);
    free(grids);
    free(packed_response);

void onopen(ws_cli_conn_t *client)
{
    char *cli;
    cli = ws_getaddress(client);

    int client_id = ws_get_id(client);

    // ---

    GameTile *wall_tile = malloc(sizeof(GameTile));
    wall_tile-&gt;type = 0;
    wall_tile-&gt;on_enter = on_default_enter;
    wall_tile-&gt;on_interact = on_default_interact;
    wall_tile-&gt;is_walkable = 0;
    wall_tile-&gt;is_interactable = 0;

    GameTile *fake_wall_tile = malloc(sizeof(GameTile));
    fake_wall_tile-&gt;type = 1;
    fake_wall_tile-&gt;on_enter = on_default_enter;
    fake_wall_tile-&gt;on_interact = on_default_interact;
    fake_wall_tile-&gt;is_walkable = 1;
    fake_wall_tile-&gt;is_interactable = 0;

    GameTile *walk_tile = malloc(sizeof(GameTile));
    walk_tile-&gt;type = 2;
    walk_tile-&gt;on_enter = on_default_enter;
    walk_tile-&gt;on_interact = on_default_interact;
    walk_tile-&gt;is_walkable = 1;
    walk_tile-&gt;is_interactable = 0;

    GameTile *flag_tile = malloc(sizeof(GameTile));
    flag_tile-&gt;type = 3;
    flag_tile-&gt;on_enter = on_default_enter;
    flag_tile-&gt;on_interact = on_flag_interact;
    flag_tile-&gt;is_walkable = 0;
    flag_tile-&gt;is_interactable = 1;

    GameTile *gate_1_tile = malloc(sizeof(GameTile));
    gate_1_tile-&gt;type = 4;
    gate_1_tile-&gt;on_enter = on_default_enter;
    gate_1_tile-&gt;on_interact = on_gate_1_interact;
    gate_1_tile-&gt;is_walkable = 0;
    gate_1_tile-&gt;is_interactable = 1;

    GameTile *gate_2_tile = malloc(sizeof(GameTile));
    gate_2_tile-&gt;type = 5;
    gate_2_tile-&gt;on_enter = on_default_enter;
    gate_2_tile-&gt;on_interact = on_gate_2_interact;
    gate_2_tile-&gt;is_walkable = 0;
    gate_2_tile-&gt;is_interactable = 1;

    GameTile *gate_3_tile = malloc(sizeof(GameTile));
    gate_3_tile-&gt;type = 6;
    gate_3_tile-&gt;on_enter = on_default_enter;
    gate_3_tile-&gt;on_interact = on_gate_3_interact;
    gate_3_tile-&gt;is_walkable = 0;
    gate_3_tile-&gt;is_interactable = 1;

    GameTile *gate_4_tile = malloc(sizeof(GameTile));
    gate_4_tile-&gt;type = 7;
    gate_4_tile-&gt;on_enter = on_default_enter;
    gate_4_tile-&gt;on_interact = on_gate_4_interact;
    gate_4_tile-&gt;is_walkable = 0;
    gate_4_tile-&gt;is_interactable = 1;

    GameTile *key_1_tile = malloc(sizeof(GameTile));
    key_1_tile-&gt;type = 8;
    key_1_tile-&gt;on_enter = on_default_enter;
    key_1_tile-&gt;on_interact = on_key_1_interact;
    key_1_tile-&gt;is_walkable = 0;
    key_1_tile-&gt;is_interactable = 1;

    GameTile *key_2_tile = malloc(sizeof(GameTile));
    key_2_tile-&gt;type = 9;
    key_2_tile-&gt;on_enter = on_default_enter;
    key_2_tile-&gt;on_interact = on_key_2_interact;
    key_2_tile-&gt;is_walkable = 0;
    key_2_tile-&gt;is_interactable = 1;

    GameTile *key_3_tile = malloc(sizeof(GameTile));
    key_3_tile-&gt;type = 10;
    key_3_tile-&gt;on_enter = on_default_enter;
    key_3_tile-&gt;on_interact = on_key_3_interact;
    key_3_tile-&gt;is_walkable = 0;
    key_3_tile-&gt;is_interactable = 1;

    GameTile *key_4_tile = malloc(sizeof(GameTile));
    key_4_tile-&gt;type = 11;
    key_4_tile-&gt;on_enter = on_default_enter;
    key_4_tile-&gt;on_interact = on_key_4_interact;
    key_4_tile-&gt;is_walkable = 0;
    key_4_tile-&gt;is_interactable = 1;

    GameTile **tileset = malloc(TILESET_SIZE * sizeof(GameTile *));
    tileset[0] = wall_tile;
    tileset[1] = fake_wall_tile;
    tileset[2] = walk_tile;
    tileset[3] = flag_tile;
    tileset[4] = gate_1_tile;
    tileset[5] = gate_2_tile;
    tileset[6] = gate_3_tile;
    tileset[7] = gate_4_tile;
    tileset[8] = key_1_tile;
    tileset[9] = key_2_tile;
    tileset[10] = key_3_tile;
    tileset[11] = key_4_tile;

    GameTile **grid = malloc(GRID_ROWS * GRID_COLS * sizeof(GameTile *));
    for (int x = 0; x &lt; GRID_COLS; x&#43;&#43;)
        for (int y = 0; y &lt; GRID_ROWS; y&#43;&#43;)
        {
            unsigned long long int range_grid = GRID[COORD(x, y) &gt;&gt; 4];
            grid[COORD(x, y)] = tileset[(range_grid &gt;&gt; (4 * (COORD(x, y) &amp; 0xf))) &amp; 0xf];
        }

    Player *player = malloc(sizeof(Player));
    player-&gt;x = 3;
    player-&gt;y = 27;
    player-&gt;facing = 1;
    player-&gt;health = 100;

    Monster *monster = malloc(sizeof(Monster));
    monster-&gt;x = GRID_COLS - 4;
    monster-&gt;y = GRID_ROWS - 4;

    int *inventory = malloc(sizeof(int) * ITEM_COUNT);

    memset(inventory, 0, sizeof(int) * ITEM_COUNT);

    Context *ctx = malloc(sizeof(Context));
    ctx-&gt;tileset = tileset;
    ctx-&gt;grid = grid;
    ctx-&gt;player = player;
    ctx-&gt;monster = monster;
    ctx-&gt;inventory = inventory;
    ctx-&gt;client = client;
    ctx-&gt;message = NULL;

    send_state_via_ws(ctx);

    ctxs[client_id] = ctx;
}

void onclose(ws_cli_conn_t *client)
{
    char *cli;
    cli = ws_getaddress(client);
    int client_id = ws_get_id(client);

    Context *ctx = ctxs[client_id];

    for (int i = 0; i &lt; TILESET_SIZE; i&#43;&#43;)
        free(ctx-&gt;tileset[i]);
    free(ctx-&gt;tileset);
    free(ctx-&gt;grid);
    free(ctx-&gt;player);
    free(ctx-&gt;monster);
    free(ctx-&gt;inventory);
    free(ctx);
    ctxs[client_id] = NULL;
}

void onmessage(ws_cli_conn_t *client,
               const unsigned char *msg, uint64_t size, int type)
{
    char *cli;
    cli = ws_getaddress(client);

    int client_id = ws_get_id(client);
    Context *ctx = ctxs[client_id];

    Request *req = request__unpack(NULL, size, msg);
    if (req == NULL)
        return;

    switch (req-&gt;move)
    {
    case MOVE__LEFT:
        ctx-&gt;player-&gt;facing = (ctx-&gt;player-&gt;facing - 1) &amp; 3;
        break;
    case MOVE__RIGHT:
        ctx-&gt;player-&gt;facing = (ctx-&gt;player-&gt;facing &#43; 1) &amp; 3;
        break;
    case MOVE__FORWARD:
        int dx = DXS[ctx-&gt;player-&gt;facing];
        int dy = DYS[ctx-&gt;player-&gt;facing];
        walk(ctx, dx, dy);
        break;
    case MOVE__INTERACT:
        int x = ctx-&gt;player-&gt;x &#43; DXS[ctx-&gt;player-&gt;facing];
        int y = ctx-&gt;player-&gt;y &#43; DYS[ctx-&gt;player-&gt;facing];
        ctx-&gt;grid[COORD(x, y)]-&gt;on_interact(ctx, x, y);
        break;
    default:
        return;
    }
    send_state_via_ws(ctx);
}

int sgn(int x)
{
    if (x == 0)
        return 0;
    if (x &lt; 0)
        return -1;
    return 1;
}

// Return 1 if the game is still running, 0 otherwise
int tick(Context *ctx)
{
    int dx = ctx-&gt;player-&gt;x - ctx-&gt;monster-&gt;x;
    int dy = ctx-&gt;player-&gt;y - ctx-&gt;monster-&gt;y;

    ctx-&gt;player-&gt;health -= 1;
    if (ctx-&gt;player-&gt;health == 0)
        return 0;

    if (DIST2(dx, dy) == 1)
    {
        ctx-&gt;player-&gt;health -= 10;
        if (ctx-&gt;player-&gt;health &lt;= 0)
        {
            ctx-&gt;player-&gt;health = 0;
            return 0;
        }
        char *message = malloc(27 &#43; 1);
        strcpy(message, &#34;You were bitten by a snake!&#34;);
        ctx-&gt;message = message;
    }
    else if (DIST2(dx, dy) &lt;= 10 * 10)
    {
        int facing = 0;
        if (abs(dx) &gt;= abs(dy))
        {
            facing = 2 - sgn(dx);
        }
        else
        {
            facing = 1 &#43; sgn(dy);
        }

        int x = ctx-&gt;monster-&gt;x &#43; DXS[facing];
        int y = ctx-&gt;monster-&gt;y &#43; DYS[facing];
        if (ctx-&gt;grid[COORD(x, y)]-&gt;is_walkable)
        {
            ctx-&gt;monster-&gt;x = x;
            ctx-&gt;monster-&gt;y = y;
        }
    }

    return 1;
}

int main()
{
    struct ws_events evs;
    evs.onopen = &amp;onopen;
    evs.onclose = &amp;onclose;
    evs.onmessage = &amp;onmessage;

    ws_socket(&amp;evs, 8080, 1, 1000);

    while (1)
    {
        for (int i = 0; i &lt; MAX_CLIENTS; i&#43;&#43;)
        {
            Context *ctx = ctxs[i];
            if (ctx == NULL)
                continue;
            int is_alive = tick(ctx);
            if (!is_alive)
            {
                char *message = malloc(25 &#43; 1);
                strcpy(message, &#34;You ran out of stamina...&#34;);
                ctx-&gt;message = message;
            }
            send_state_via_ws(ctx);
            if (!is_alive)
            {
                ws_cli_conn_t *client = ctx-&gt;client;
                ws_close_client(client);
            }
        }
        sleep(1);
    }

    return 0;
}
</code></pre>
  </div>


<p>When connected to the server, the binary will run the <code>onopen</code> function and define a context specific to the client. A <code>Context</code> struct is created and the struct members are defined and it stores the current game state, which will be constantly updated during the gameplay. If we look at the variable <code>GRID</code> and the tileset, we are able to draw the game map by ourselves:</p>


<figure>
  <img src="/images/2024-01-27-hkcert-ctf/loot-and-scoot-map.png" title="">
  
</figure>

<p>The player spawns in the middle left at the beginning. There are four keys at the corners and there are five gates yet to be unlocked with these keys. The objective is to interact with the flag in the middle right.</p>
<p>There are some difficulties identified by reading the map:</p>
<ol>
<li>We might need to penetrate through walls to grab the keys on the left.</li>
<li>We have to dodge the snake to grab the key on the bottom right.</li>
<li>We might need to duplicate the key on the top right.</li>
</ol>
<h4 id="penetrating-the-walls-part-one">Penetrating the walls, part one<a href="#penetrating-the-walls-part-one" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p>To start with, we will grab <img src="/images/2024-01-27-hkcert-ctf/loot-and-scoot-key-3.png" style="display: inline;"> on the bottom left. Observe that there is a different wall tile near the key.</p>


<figure>
  <img src="/images/2024-01-27-hkcert-ctf/loot-and-scoot-map-key-3.png" title="The bottom right corner of the map.">
  
  <figcaption>The bottom right corner of the map.</figcaption>
  
</figure>

<div class="alert danger">
  ğŸ˜¡ <strong>They are visually the same in the game!</strong> I intentionally used a different sprite for the different wall tiles, which actually looked the same in the game. However, I expect one could note the differences by extracting the type IDs of the tiles.
</div>

<p>The normal wall tiles (type <code>0</code>) are given the attribute <code>is_walkable = 0</code>, while the special wall tile (type <code>1</code>) has the attribute <code>is_walkable = 1</code>. Although it looks like a wall, we can actually walk through it.</p>
<h4 id="dodging-the-snake">Dodging the snake<a href="#dodging-the-snake" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p>We are going to grab <img src="/images/2024-01-27-hkcert-ctf/loot-and-scoot-key-4.png" style="display: inline;"> without getting bitten by snakes, which is fatal. We will lost 10 HP every bite. Also, the snake will attempt to move forward to our direction if we are too close to it. Fortunately, the snake AI is pretty dumb and you could easily lure it away. Since we did not rate limit the client's requests, it is also fine to walk 100 blocks per second. This allow us easily avoiding the venom.</p>


<figure>
  <img src="/images/2024-01-27-hkcert-ctf/loot-and-scoot-map-key-4.gif" title="Juking the snake.">
  
  <figcaption>Juking the snake.</figcaption>
  
</figure>

<h4 id="duplicating-the-key">Duplicating the key<a href="#duplicating-the-key" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p><img src="/images/2024-01-27-hkcert-ctf/loot-and-scoot-key-2.png" style="display: inline;"> is easy to grab. There are no snakes, no impenetrable walls, no nothing. We can walk towards the key and grab that manually. Since the corresponding key will be consumed when we open a gate, we need multiple <img src="/images/2024-01-27-hkcert-ctf/loot-and-scoot-key-2.png" style="display: inline;">s. That is actually not the case, and we will actually unlock <em>both</em> gates at once.</p>
<p>This is actually a flaw (intended!) in the program. Look at the source code when a gate is interacted:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">on_gate_2_interact</span><span class="p">(</span><span class="n">Context</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">inventory</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">char</span> <span class="o">*</span><span class="n">message</span> <span class="o">=</span> <span class="nf">malloc</span><span class="p">(</span><span class="mi">32</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">strcpy</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s">&#34;You don&#39;t have the required key!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">char</span> <span class="o">*</span><span class="n">message</span> <span class="o">=</span> <span class="nf">malloc</span><span class="p">(</span><span class="mi">22</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">strcpy</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s">&#34;You unlocked a gate.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">inventory</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">grid</span><span class="p">[</span><span class="nf">COORD</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)]</span><span class="o">-&gt;</span><span class="n">type</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">grid</span><span class="p">[</span><span class="nf">COORD</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)]</span><span class="o">-&gt;</span><span class="n">is_walkable</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">grid</span><span class="p">[</span><span class="nf">COORD</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)]</span><span class="o">-&gt;</span><span class="n">on_interact</span> <span class="o">=</span> <span class="n">on_default_interact</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">grid</span><span class="p">[</span><span class="nf">COORD</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)]</span><span class="o">-&gt;</span><span class="n">is_interactable</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>The grid is copied to client's context when the connection is made. Also, the line</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">grid</span><span class="p">[</span><span class="nf">COORD</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)]</span><span class="o">-&gt;</span><span class="n">is_walkable</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span></code></pre></div><p>sets the gate into a walkable grid when we have the key. It is important to note that <code>ctx-&gt;grid[COORD(x, y)]</code> is a <em>pointer</em> to the <code>GameTile</code>. Instead of setting the grid on a particular coordinate to a walkable path, it sets the &quot;gate 2&quot; tile into a walkable tile. With that said, every &quot;gate 2&quot; tile will be replaced by a path tile.</p>


<figure>
  <img src="/images/2024-01-27-hkcert-ctf/loot-and-scoot-map-gate-2.gif" title="Opening two gates with one key.">
  
  <figcaption>Opening two gates with one key.</figcaption>
  
</figure>

<h4 id="penetrating-the-walls-part-two">Penetrating the walls, part two<a href="#penetrating-the-walls-part-two" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p>We will try to get through the inpenetratable wall to get <img src="/images/2024-01-27-hkcert-ctf/loot-and-scoot-key-1.png" style="display: inline;"> on the top left... Well, you simply can't. You must get through the first gate without having that key.</p>
<p>The map in this game is implemented as an one-dimensional array and the indexes are calculated by the <code>COORD</code> macro from 2D coordinates. Smell something fishy?</p>
<p>Look at the map again and label the indexes and the coordinates on the tiles:</p>


<figure>
  <img src="/images/2024-01-27-hkcert-ctf/loot-and-scoot-map-gate-1-1.gif" title="The middle left and middle right of the map.">
  
  <figcaption>The middle left and middle right of the map.</figcaption>
  
</figure>

<p>However, the state sent to us includes a list of possible moves. If we are at $x = 0$ and we are facing leftwards, $x_2$ below is $x_2 = -1 &lt; 0$. Now we do not have <code>FORWARD</code> in our <code>possible_moves</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">send_state_via_ws</span><span class="p">(</span><span class="n">Context</span> <span class="o">*</span><span class="n">ctx</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// (skipped...)
</span></span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">player</span><span class="o">-&gt;</span><span class="n">x</span> <span class="o">+</span> <span class="n">DXS</span><span class="p">[</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">player</span><span class="o">-&gt;</span><span class="n">facing</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">player</span><span class="o">-&gt;</span><span class="n">y</span> <span class="o">+</span> <span class="n">DYS</span><span class="p">[</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">player</span><span class="o">-&gt;</span><span class="n">facing</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// (skipped...)
</span></span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">x2</span> <span class="o">&amp;&amp;</span> <span class="n">x2</span> <span class="o">&lt;</span> <span class="n">GRID_COLS</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">y2</span> <span class="o">&amp;&amp;</span> <span class="n">y2</span> <span class="o">&lt;</span> <span class="n">GRID_ROWS</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">        <span class="n">ctx</span><span class="o">-&gt;</span><span class="n">grid</span><span class="p">[</span><span class="nf">COORD</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)]</span><span class="o">-&gt;</span><span class="n">is_walkable</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">possible_moves</span><span class="p">[</span><span class="n">n_possible_moves</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">MOVE__FORWARD</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// (skipped...)
</span></span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Thus we will be unable to move forward as it has been blocked by the web client:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">moveForward</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">possibleMovesList</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">proto</span><span class="p">.</span><span class="nx">Move</span><span class="p">.</span><span class="nx">FORWARD</span><span class="p">))</span> <span class="k">return</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">proto</span><span class="p">.</span><span class="nx">Request</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="nx">request</span><span class="p">.</span><span class="nx">setMove</span><span class="p">(</span><span class="nx">proto</span><span class="p">.</span><span class="nx">Move</span><span class="p">.</span><span class="nx">FORWARD</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">ws</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">serializeBinary</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>To deal with that, we can patch the function and throw the guard clause away. Since the server does <em>not</em> check require $x_2 \geq 0$ in the <code>walk</code> function. In this way, we can simply &quot;teleport&quot; from the left to the right.</p>


<figure>
  <img src="/images/2024-01-27-hkcert-ctf/loot-and-scoot-map-gate-1-2.gif" title="We moved in a warped space!">
  
  <figcaption>We moved in a warped space!</figcaption>
  
</figure>

<p>Finally, let me share a screenshot of the game <em>Danganronpa v3</em>, where I borrowed the idea in this part.</p>


<figure>
  <img src="/images/2024-01-27-hkcert-ctf/loot-and-scoot-danganronpa.png" title="Taken from the game Danganronpa v3, where this part is inspired from.">
  
  <figcaption>Taken from the game Danganronpa v3, where this part is inspired from.</figcaption>
  
</figure>

<p>Now we can skip the first gate and unlock the remaining gates. What is left is to walk towards the flag tile and interact with it, yielding the flag:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">hkcert23{h0w_d1d_y0u_f1nd_s0_m4ny_vu1n3r461117y_47_th3_s4m3_t1m3??}
</span></span></code></pre></div><h3 id="postmortem">Postmortem<a href="#postmortem" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>I am very happy that the challenge actually worked. This is one of the challenges I wrote in late October, which is less than one month before the CTF begins. Good that it is still a decent challenge. Since the main focus is to identify bugs rather than dig deep into reverse engineering, I decided to implement the backend in C. Given that I am such an inexperienced C programmer, I am very grateful that the challenge was not pwnable (at least during the contest period).</p>


<figure>
  <img src="/images/2024-01-27-hkcert-ctf/lihkg-dog-math.gif" title="">
  
</figure>

<p>Apart from handling the C pointers, I also struggled a lot of visualing stuffs in 3D. Eventually, I decided to build everything from the ground up using CSS. That was not easy for someone like me (who is bad at geometry), and I spent around one day to get this implemented. Without <a href="https://franklinta.com/2014/09/08/computing-css-matrix3d-transforms/"
   
   target="_blank" rel="noopener noreferrer" >this blogpost from Franklin Ta</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg>, I think I can never have the challenge finished. This is one of the screenshots I took while I develop:</p>


<figure>
  <img src="/images/2024-01-27-hkcert-ctf/loot-and-scoot-dev-walls.png" title="">
  
</figure>

<p>Finally, I did not work on the graphics at all. What I did is to glue the royalty-free resources below into a viable user interface. Kudos to the project owners!</p>
<ul>
<li><a href="https://ronenness.github.io/RPGUI/"
   
   target="_blank" rel="noopener noreferrer" >RPGUI</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg> as the web interface</li>
<li><a href="https://thkaspar.itch.io/tth-animals"
   
   target="_blank" rel="noopener noreferrer" >Tiny, tiny Heroes - Animals</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg> for the snake, our only enemy in the game</li>
<li><a href="https://analogstudios.itch.io/dungeonold"
   
   target="_blank" rel="noopener noreferrer" >dungeonOld_</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg> for the tileset</li>
<li><a href="https://snoopethduckduck.itch.io/things"
   
   target="_blank" rel="noopener noreferrer" >Things</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg> for the items, including the keys and the flag</li>
<li><a href="https://bagong-games.itch.io/hana-caraka-base-character"
   
   target="_blank" rel="noopener noreferrer" >Hana Caraka - Base Character</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg> for the player used in the above illustrations</li>
</ul>

        </div></div>

      
      <aside class="toc-container">
        <a href="#" class="toc-title-link">
          HKCERT CTF 2023 Postmortem (III): The Remaining Challenges
        </a>
        <div class="js-toc"></div>
      </aside>
      

      
      <div class="py-3">
        
          <a class="btn" href="/posts/2024/2024-02-03-tetctf-adapt/">â† TetCTF 2024: adapt</a>
        

        
          <a class="btn float-end" href="/posts/2024/2024-01-27-hkcert-ctf-2/">HKCERT CTF 2023 Postmortem (II): Harder Crypto Challenges â†’</a>
        
      </div>
      

    </div>
  </div>

    </div>
  </main>
  <div class="container">
  <footer class="py-3 my-4 border-top">
    <p class="text-center text-body-secondary">&copy; 2025 Powered by <em>Hugo</em>. Theme crafted by <em>Mystiz</em> with Bootstrap 5, inspired from <em>Terminal</em>.</p>
  </footer>
</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/katex.min.css"
  integrity="sha384-Pu5+C18nP5dwykLJOhd2U4Xen7rjScHN/qusop27hdd2drI+lL5KvX7YntvT8yew" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/katex.min.js"
  integrity="sha384-2B8pfmZZ6JlVoScJm/5hQfNS2TI/6hPqDZInzzPc8oHpN5SgeNOf4LzREO6p5YtZ" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/contrib/auto-render.min.js"
  integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous"
  onload="renderMathInElement(document.body, { delimiters: [{ left: '$$', right: '$$', display: true }, { left: '\\[', right: '\\]', display: true }, { left: '$', right: '$', display: false }, { left: '\\(', right: '\\)', display: false }], trust: true })"></script>

<script src="https://cdn.jsdelivr.net/npm/@viz-js/viz@3.24.0/dist/viz-global.min.js"></script>
<script>
Viz.instance().then(viz => {
  const unescape = function (s) {
    const t = s.replace(/&amp;/g, '&')
    return t.replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&#34;/g, '"')
  }

  document.querySelectorAll('[class=graphviz]').forEach(node => {
    const source = unescape(node.innerText);
    console.log(source);
    const svg = viz.renderSVGElement(source, { engine: 'dot' });
    console.log(2);
    node.parentNode.appendChild(svg);
    node.style.display = 'none';
  });
});
</script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.36.4/tocbot.min.js"
  integrity="sha512-BZUSsJAPNtkd+kdY/bD7hvQKZ5zlgWt++KGy/Pa/5uEJNgs0jZ6JaX6MuclRUanowuxmhb5S3LRPEa3QmrUVfA==" crossorigin="anonymous"
  referrerpolicy="no-referrer"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.36.4/tocbot.min.css"
  integrity="sha512-/ANQiHMqpRl+E0zEAd250N21OOmJsYbhiJWY0Y8yG0TII47yZn1+gDNobMlf+h/FTyImprLXYgXbX3bCYyq/vg==" crossorigin="anonymous"
  referrerpolicy="no-referrer" />
<script type="text/javascript">
tocbot.init({
  headingSelector: 'h1, h2, h3, h4',
  orderedList: false,
  collapseDepth: 2,
  headingsOffset: 60,
  scrollSmoothOffset: -60
})
</script>


<script>
  document.querySelectorAll('pre code').forEach(el => {
    console.log(el)
    const lang = Array.from(el.classList).find(className => className.startsWith('language-'));
    if (!lang) return;

    
    if (lang.startsWith('language-diff-')) {
      el.classList.add('diff-highlight');
    }
  })
</script>
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script>
mermaid.initialize({
  startOnLoad: true,
  htmlLabels: true,
  securityLevel: "loose",
  theme: 'base',
  themeVariables: {
    background: '#22222c',
    primaryColor: '#33333c',
    primaryTextColor: '#ffe4e1',
  }
});
</script>

</body>
</html>

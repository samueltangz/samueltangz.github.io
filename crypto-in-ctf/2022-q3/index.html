<!DOCTYPE html>
<html lang="en-us" dir="ltr" data-bs-theme="dark">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Crypto in CTF: Q3 2022 | Mystify</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&family=Libre+Baskerville:ital,wght@0,400..700;1,400..700&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.8/css/bootstrap.min.css"
  integrity="sha512-2bBQCjcnw658Lho4nlXJcc6WkV/UxpE/sAokbXPxQNGqmNdQrWqtw26Ns9kFF/yG792pKR1Sx8/Y1Lf1XN4GKA==" crossorigin="anonymous"
  referrerpolicy="no-referrer" />
<link rel="stylesheet" href="/css/main.min.27b43d01a5c4432e35e87df4c1026d71d0e56b69b492a4e65a5564c213f27fa9.css" integrity="sha256-J7Q9AaXEQy416H30wQJtcdDla2m0kqTmWlVkwhPyf6k=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/prism.min.ebb6c0bd3fe6ed4e16ec09f3b52903ee18ddfb21e33b6882030d951a91b213e4.css" integrity="sha256-67bAvT/m7U4W7AnztSkD7hjd&#43;yHjO2iCAw2VGpGyE&#43;Q=" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.8/js/bootstrap.min.js"
  integrity="sha512-nKXmKvJyiGQy343jatQlzDprflyB5c+tKCzGP3Uq67v+lmzfnZUi/ZT+fc6ITZfSC5HhaBKUIvr/nTLCV+7F+Q==" crossorigin="anonymous"
  referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous"
  referrerpolicy="no-referrer"></script>
        <script src="/js/main.f2979a93a325fecf9605263bd141398a311c8e23388ed7dcff74f92f7e632866.js" integrity="sha256-8peak6Ml/s&#43;WBSY70UE5ijEcjiM4jtfc/3T5L35jKGY=" crossorigin="anonymous"></script>
        <script src="/js/prism.0ecb34b0181efd0f9aa6d1a8fc2e4814ffbdd9acc78d93d02a94e01f64f87f35.js" integrity="sha256-Dss0sBge/Q&#43;aptGo/C5IFP&#43;92azHjZPQKpTgH2T4fzU=" crossorigin="anonymous"></script>



</head>
<body class="overflow-y-scroll">
  <nav class="navbar navbar-expand-lg sticky-top bg-body-tertiary">
  <div class="container">
    <a class="navbar-brand" href="/">Mystify</a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
      <div class="navbar-nav">
        
        
          <a class="nav-link " href="/about-me/">
            About Me 
          </a>
        
          <a class="nav-link " href="/blogroll/">
            Blogroll 
          </a>
        
          <a class="nav-link " href="/crypto-in-ctf/">
            Crypto in CTF 
          </a>
        
      </div>
    </div>
  </div>
</nav>

  <main>
    <div class="container mt-3">
      
  <div class="row justify-content-center">
    <div class="col-8">
      <h1 class="post-title">Crypto in CTF: Q3 2022</h1>

      

      <div class="post-content js-toc-content"><div>
          <table class="table table-striped table-bordered">
  <thead>
    
    <tr>
      
      <th>
        CTF
      </th>
      
      <th>
        Challenge Name
      </th>
      
      <th>
        Solves (Difficulty)
      </th>
      
    </tr>
    
  </thead>
  <tbody>
    
    <tr>
      
      <td>
        Google CTF 2022
      </td>
      
      <td>
        Cycling üî•
      </td>
      
      <td>
        50/382 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Google CTF 2022
      </td>
      
      <td>
        Electric Mayhem CLS
      </td>
      
      <td>
        70/382 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Google CTF 2022
      </td>
      
      <td>
        Maybe Someday
      </td>
      
      <td>
        35/382 (‚≠ê‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Google CTF 2022
      </td>
      
      <td>
        Enigma
      </td>
      
      <td>
        9/382 (‚≠ê‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Google CTF 2022
      </td>
      
      <td>
        Custom Protocol üî•
      </td>
      
      <td>
        5/382 (‚≠ê‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Google CTF 2022
      </td>
      
      <td>
        Electric Mayhem PQC üî•
      </td>
      
      <td>
        3/382 (‚≠ê‚≠ê‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        Aniely
      </td>
      
      <td>
        76/421 (‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        Watery soup üî•
      </td>
      
      <td>
        15/421 (‚≠ê‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        Oak land
      </td>
      
      <td>
        35/421 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        polyRSA
      </td>
      
      <td>
        145/421 (‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        313 Loyal
      </td>
      
      <td>
        17/421 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        Cantilever
      </td>
      
      <td>
        60/421 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        Side step
      </td>
      
      <td>
        28/421 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        Faonsa
      </td>
      
      <td>
        21/421 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        Resign
      </td>
      
      <td>
        35/421 (-)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        DBB
      </td>
      
      <td>
        43/421 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        Soda üî•
      </td>
      
      <td>
        17/421 (‚≠ê‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        Sparse
      </td>
      
      <td>
        38/421 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        Fiercest
      </td>
      
      <td>
        29/421 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        Persian cat
      </td>
      
      <td>
        13/421 (‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        Keydream
      </td>
      
      <td>
        42/421 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        NLCS üî•
      </td>
      
      <td>
        5/421 (‚≠ê‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        Shaim
      </td>
      
      <td>
        15/421 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        Lagima
      </td>
      
      <td>
        24/421 (‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        Starter ECC
      </td>
      
      <td>
        43/421 (‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        Versace
      </td>
      
      <td>
        15/421 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        Crypto CTF 2022
      </td>
      
      <td>
        GSDP
      </td>
      
      <td>
        24/421 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        UIUCTF 2022
      </td>
      
      <td>
        asr
      </td>
      
      <td>
        56/395 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        UIUCTF 2022
      </td>
      
      <td>
        Wringing Rings
      </td>
      
      <td>
        44/395 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        UIUCTF 2022
      </td>
      
      <td>
        Elliptic Clock Crypto
      </td>
      
      <td>
        27/395 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        UIUCTF 2022
      </td>
      
      <td>
        mom can we have AES
      </td>
      
      <td>
        22/395 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        UIUCTF 2022
      </td>
      
      <td>
        That-crete Log
      </td>
      
      <td>
        21/395 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        UIUCTF 2022
      </td>
      
      <td>
        Bro-key-n
      </td>
      
      <td>
        14/395 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        corCTF 2022
      </td>
      
      <td>
        tadpole
      </td>
      
      <td>
        262/978 (‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        corCTF 2022
      </td>
      
      <td>
        luckyguess
      </td>
      
      <td>
        150/978 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        corCTF 2022
      </td>
      
      <td>
        exchanged
      </td>
      
      <td>
        94/978 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        corCTF 2022
      </td>
      
      <td>
        hidE
      </td>
      
      <td>
        88/978 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        corCTF 2022
      </td>
      
      <td>
        generous
      </td>
      
      <td>
        49/978 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        corCTF 2022
      </td>
      
      <td>
        leapfrog
      </td>
      
      <td>
        36/978 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        corCTF 2022
      </td>
      
      <td>
        corrupted-curves
      </td>
      
      <td>
        20/978 (‚≠ê‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        corCTF 2022
      </td>
      
      <td>
        threetreasures
      </td>
      
      <td>
        19/978 (‚≠ê‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        corCTF 2022
      </td>
      
      <td>
        corrupted-curves+ üî•
      </td>
      
      <td>
        15/978 (‚≠ê‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        corCTF 2022
      </td>
      
      <td>
        rlfsr
      </td>
      
      <td>
        14/978 (‚≠ê‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        corCTF 2022
      </td>
      
      <td>
        D3S üî•
      </td>
      
      <td>
        1/978 (‚≠ê‚≠ê‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        MapleCTF 2022
      </td>
      
      <td>
        brsaby
      </td>
      
      <td>
        166/618 (‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        MapleCTF 2022
      </td>
      
      <td>
        jwt
      </td>
      
      <td>
        79/618 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        MapleCTF 2022
      </td>
      
      <td>
        Spiral-baby
      </td>
      
      <td>
        57/618 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        MapleCTF 2022
      </td>
      
      <td>
        qotp-real
      </td>
      
      <td>
        27/618 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        MapleCTF 2022
      </td>
      
      <td>
        e000p
      </td>
      
      <td>
        18/618 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        MapleCTF 2022
      </td>
      
      <td>
        Spiral üî•
      </td>
      
      <td>
        9/618 (‚≠ê‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        MapleCTF 2022
      </td>
      
      <td>
        clipper chip
      </td>
      
      <td>
        2/618 (‚ùì)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        BalsnCTF 2022
      </td>
      
      <td>
        Yet another RSA with hint
      </td>
      
      <td>
        38/584 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        BalsnCTF 2022
      </td>
      
      <td>
        vss üî•
      </td>
      
      <td>
        9/584 (‚≠ê‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        BalsnCTF 2022
      </td>
      
      <td>
        lfsr üî•
      </td>
      
      <td>
        6/584 (‚≠ê‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        DownUnderCTF 2022
      </td>
      
      <td>
        baby arx
      </td>
      
      <td>
        279/1407 (‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        DownUnderCTF 2022
      </td>
      
      <td>
        oracle for block cipher
      </td>
      
      <td>
        102/1407 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        DownUnderCTF 2022
      </td>
      
      <td>
        cheap ring theory
      </td>
      
      <td>
        101/1407 (‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        DownUnderCTF 2022
      </td>
      
      <td>
        rsa interval oracle i
      </td>
      
      <td>
        79/1407 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        DownUnderCTF 2022
      </td>
      
      <td>
        rsa interval oracle ii üî•
      </td>
      
      <td>
        36/1407 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        DownUnderCTF 2022
      </td>
      
      <td>
        rsa interval oracle iii
      </td>
      
      <td>
        23/1407 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        DownUnderCTF 2022
      </td>
      
      <td>
        rsa interval oracle iv üî•
      </td>
      
      <td>
        5/1407 (‚≠ê‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        DownUnderCTF 2022
      </td>
      
      <td>
        time locked
      </td>
      
      <td>
        18/1407 (‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        DownUnderCTF 2022
      </td>
      
      <td>
        faulty arx üî•
      </td>
      
      <td>
        11/1407 (‚≠ê‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        DownUnderCTF 2022
      </td>
      
      <td>
        1337crypt v3 üî•
      </td>
      
      <td>
        2/1407 (‚≠ê‚≠ê‚≠ê)
      </td>
      
    </tr>
    
    <tr>
      
      <td>
        DownUnderCTF 2022
      </td>
      
      <td>
        kyber¬±
      </td>
      
      <td>
        1/1407 (‚≠ê‚≠ê‚≠ê‚≠ê)
      </td>
      
    </tr>
    
  </tbody>
</table>
<h2 id="google-ctf-2022">Google CTF 2022<a href="#google-ctf-2022" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h3 id="cycling-">Cycling üî•<a href="#cycling-" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 50/382</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>rsa</code></li>
<li>Source: <a href="https://github.com/google/google-ctf/tree/master/2022/crypto-cycling"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<p>We are given a RSA public key $(n, e)$ and $c_0$, the ciphertext of $m_0$ (the flag). If we denote $(m, c)$ be a message-ciphertext pair, then $c = \text{Enc}(m) := m^e\ \text{mod}\ n$. Given also</p>
<p>$$\text{Enc}^{2^{1025} - 3}(c) := \underbrace{\text{Enc}(\text{Enc}(...\text{Enc}}_{\text{Enc applied}\ 2^{1025}-3\ \text{times}}(c))) = m.$$</p>
<p>The objective is to recover $m_0$.</p>
<h3 id="electric-mayhem-cls">Electric Mayhem CLS<a href="#electric-mayhem-cls" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 70/382</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>aes</code>, <code>power analysis</code></li>
<li>Source: <a href="https://github.com/google/google-ctf/tree/master/2022/crypto-electric-mayhem-cls"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<div class="alert info">
  üõ†Ô∏è <strong>To-be written.</strong> This is a placeholder because I am lazy. Please read the tags, or the official source meanwhile.
</div>

<h3 id="maybe-someday">Maybe Someday<a href="#maybe-someday" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 35/382</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>paillier</code></li>
<li>Source: <a href="https://github.com/google/google-ctf/tree/master/2022/crypto-maybe-someday"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<p>We are given a public key of Paillier cryptosystem $(n, g)$, and is asked to complete 16 rounds of challenge $\mathcal{C}$. In each round of $\mathcal{C}$:</p>
<ol>
<li>The server generates a random $s$, which of two bytes long.</li>
<li>The server $m_0 := \text{SHA512}(s)$.</li>
<li>The server encrypts a PKCSv1.5-padded $m_0$ with the public key $(n, g)$ and sends its ciphertext $c_0$ to the player.</li>
<li>The player sends $c_1, c_2, ..., c_{20}$ to the server.</li>
<li>The server checks and tells the player if each of the corresponding $m_i$'s is PKCSv1.5-compliant.</li>
<li>The player sends $\hat{m_0}$ to the server. If $\hat{m_0} = m_0$, the player wins this round.</li>
</ol>
<p>The objective for the player is to win 16 rounds of $\mathcal{C}$ for the flag.</p>
<h3 id="enigma">Enigma<a href="#enigma" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 9/382</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>enigma</code></li>
<li>Source: <a href="https://github.com/google/google-ctf/tree/master/2022/crypto-enigma"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<div class="alert info">
  üõ†Ô∏è <strong>To-be written.</strong> This is a placeholder because I am lazy. Please read the tags, or the official source meanwhile.
</div>

<h3 id="custom-protocol-">Custom Protocol üî•<a href="#custom-protocol-" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 5/382</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>rsa</code>, <code>faulty signature</code></li>
<li>Source: <a href="https://github.com/google/google-ctf/tree/master/2022/crypto-custom-protocol"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<div class="alert info">
  üõ†Ô∏è <strong>To-be written.</strong> This is a placeholder because I am lazy. Please read the tags, or the official source meanwhile.
</div>

<h3 id="electric-mayhem-pqc-">Electric Mayhem PQC üî•<a href="#electric-mayhem-pqc-" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 3/382</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>kyber512</code>, <code>power analysis</code></li>
<li>Source: <a href="https://github.com/google/google-ctf/tree/master/2022/crypto-electric-mayhem-pqc"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<div class="alert info">
  üõ†Ô∏è <strong>To-be written.</strong> This is a placeholder because I am lazy. Please read the tags, or the official source meanwhile.
</div>

<h2 id="crypto-ctf-2022">Crypto CTF 2022<a href="#crypto-ctf-2022" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h3 id="aniely">Aniely<a href="#aniely" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 76/421</li>
<li>Difficulty: ‚≠ê</li>
<li>Tags: <code>implementation</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<p>Define the <code>aniely_encrypt</code> function as below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">aniely_stream</span><span class="p">(</span><span class="n">passphrase</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="k">def</span> <span class="nf">mixer</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="p">((</span><span class="n">u</span> <span class="o">&lt;&lt;</span> <span class="n">v</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span><span class="p">)</span> <span class="o">|</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">32</span> <span class="o">-</span> <span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">def</span> <span class="nf">forge</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">			<span class="n">w</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="n">b</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">			<span class="n">w</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">mixer</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">^</span> <span class="n">w</span><span class="p">[</span><span class="n">d</span><span class="p">],</span> <span class="mi">16</span> <span class="o">//</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">			<span class="n">w</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="n">d</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">			<span class="n">w</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="n">mixer</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">^</span> <span class="n">w</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="p">(</span><span class="mi">12</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">bring</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl">	<span class="n">bring</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x61707865</span><span class="p">,</span> <span class="mh">0x3320646e</span><span class="p">,</span> <span class="mh">0x79622d32</span><span class="p">,</span> <span class="mh">0x6b206574</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	<span class="n">bring</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;8L&#39;</span><span class="p">,</span> <span class="n">passphrase</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">bring</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="n">bring</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0</span>
</span></span><span class="line"><span class="cl">	<span class="n">bring</span><span class="p">[</span><span class="mi">14</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">w</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">bring</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">			<span class="n">forge</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x4</span><span class="p">,</span> <span class="mh">0x8</span><span class="p">,</span> <span class="mh">0xc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="n">forge</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mh">0x1</span><span class="p">,</span> <span class="mh">0x5</span><span class="p">,</span> <span class="mh">0x9</span><span class="p">,</span> <span class="mh">0xd</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="n">forge</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mh">0x2</span><span class="p">,</span> <span class="mh">0x6</span><span class="p">,</span> <span class="mh">0xa</span><span class="p">,</span> <span class="mh">0xe</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="n">forge</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mh">0x3</span><span class="p">,</span> <span class="mh">0x7</span><span class="p">,</span> <span class="mh">0xb</span><span class="p">,</span> <span class="mh">0xf</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="n">forge</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">,</span> <span class="mh">0x5</span><span class="p">,</span> <span class="mh">0xa</span><span class="p">,</span> <span class="mh">0xf</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="n">forge</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mh">0x1</span><span class="p">,</span> <span class="mh">0x6</span><span class="p">,</span> <span class="mh">0xb</span><span class="p">,</span> <span class="mh">0xc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="n">forge</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mh">0x2</span><span class="p">,</span> <span class="mh">0x7</span><span class="p">,</span> <span class="mh">0x8</span><span class="p">,</span> <span class="mh">0xd</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="n">forge</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mh">0x3</span><span class="p">,</span> <span class="mh">0x4</span><span class="p">,</span> <span class="mh">0x9</span><span class="p">,</span> <span class="mh">0xe</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;16L&#39;</span><span class="p">,</span> <span class="o">*</span><span class="p">((</span><span class="n">w</span><span class="p">[</span><span class="n">_</span><span class="p">]</span> <span class="o">+</span> <span class="n">bring</span><span class="p">[</span><span class="n">_</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">))):</span>
</span></span><span class="line"><span class="cl">			<span class="k">yield</span> <span class="n">c</span>
</span></span><span class="line"><span class="cl">		<span class="n">bring</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">bring</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="n">bring</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="n">bring</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">bring</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">aniely_encrypt</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">passphrase</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">passphrase</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">passphrase</span> <span class="o">=</span> <span class="p">(</span><span class="n">passphrase</span> <span class="o">*</span> <span class="p">(</span><span class="mi">32</span> <span class="o">//</span> <span class="nb">len</span><span class="p">(</span><span class="n">passphrase</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))[:</span><span class="mi">32</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	<span class="n">rand</span> <span class="o">=</span> <span class="n">urandom</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">a</span> <span class="o">^</span> <span class="n">b</span> <span class="o">^</span> <span class="n">c</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">aniely_stream</span><span class="p">(</span><span class="n">passphrase</span><span class="p">),</span> <span class="n">rand</span><span class="p">))</span>
</span></span></code></pre></div><p>We are given $\text{key} = \text{passphrase} \oplus \text{flag}$ and $c = \text{AnielyEncrypt}(\text{passphrase}, \text{key})$. The goal is to recover $\text{flag}$.</p>
<h3 id="watery-soup-">Watery soup üî•<a href="#watery-soup-" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 15/421</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>math</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<p>The server has a secret $f \in [2^{256}, 2^{511})$. We can send many pairs of $(p, g)$ ($p \in [2^{127}, 2^{224})$ being a prime and $g \in [2^{64}, 2^{127})$) and obtain $r$, with</p>
<p>$$r = [(g^3f)^{f-g} \cdot f + f^2 + g]\ \text{mod}\ p.$$</p>
<p>The goal is to recover $f$ (the flag).</p>
<h3 id="oak-land">Oak land<a href="#oak-land" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 35/421</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>math</code>, <code>dlog</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<p>We are given $p$, $e$, $f$, $g$ and $c$ as below:</p>
<pre tabindex="0"><code>p = 7389313481223384214994762619823300589978423075857540712007981373887018860174846208000957230283669342186460652521580595183523706412588695116906905718440770776239313669678685198683933547601793742596023475603667
e = 31337
f = 7236042467316654159796543399639966340258093274047941788600980451877044636122969830708918356119442228154447395855689559447196348683125675305629837437591088260218138895919514078948650757100432223219969122629790
g = 1878626136321051642174045874618248475160620873585704351202865003185878331837410979441756843820270907300810543618813757245154196050399357659526631164136221434463496532263979506870318259276669412698827040743576
c = 871346503375040565701864845493751233877009611275883500035764036792906970084258238763963152627486758242101207127598485219754255161617890137664012548226251138485059295263306930653899766537171223837761341914356
</code></pre><p>We are also given the relation</p>
<p>$$c \equiv 110 e^x + 313 f^x + 114 g^x\ (\text{mod}\ p).$$</p>
<p>The goal is to find $x$.</p>
<h3 id="polyrsa">polyRSA<a href="#polyrsa" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 145/421</li>
<li>Difficulty: ‚≠ê</li>
<li>Tags: <code>rsa</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<p>We are given the RSA public key $(n, e = 31337)$ and the encrypted flag $c$:</p>
<pre tabindex="0"><code>n = 44538727182858207226040251762322467288176239968967952269350336889655421753182750730773886813281253762528207970314694060562016861614492626112150259048393048617529867598499261392152098087985858905944606287003243
c = 37578889436345667053409195986387874079577521081198523844555524501835825138236698001996990844798291201187483119265306641889824719989940722147655181198458261772053545832559971159703922610578530282146835945192532
</code></pre><p>Given that the primes for the modulus, $p, q$, are given by</p>
<p>$$\left\{
\begin{aligned}
p &amp;= k^6 + 7k^4 - 40k^3 + 12k^2 - 114k + 31377 \\
q &amp;= k^5 - 8k^4 + 19k^3 - 313k^2 - 14k + 14011
\end{aligned}
\right.
$$</p>
<h3 id="313-loyal">313 Loyal<a href="#313-loyal" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 17/421</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>paillier</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<p>When connected to the server, $x_1, x_2, ..., x_k$ are generated such that</p>
<ol>
<li>$x_1 &lt; x_2 &lt; ... &lt; x_k$, and</li>
<li>$x_i = 2^{10} r_i + f_i$ for $i = 1, 2, ..., k$ where $r_i \in [2, 2^{64})$ is random and $f_i$ is the $i$-th character of the flag.</li>
</ol>
<p>We can send multiple pairs of $(n, g, p)$ with $n \geq 2^{256}$, $g \in \mathbb{Z}$ and $p(x) = \sum p_i x^i$ being a polynomial, and the server will return a shuffled list of $(c_1, c_2, ..., c_k)$, where</p>
<p>$$c_i := \left(\prod {p_i}^{x^i}\right)^{s_i} g^m \cdot r^n\ \text{mod}\ n^2$$</p>
<p>with $s_i \in [2, n)$ being random. The objective is to recover the flag $(f_1, f_2, ..., f_k)$.</p>
<h3 id="cantilever">Cantilever<a href="#cantilever" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 60/421</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>rsa</code>, <code>dlog</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<p>We are given a RSA public key $(n, e = 65537)$ and $c_1, c_2$ defined below.</p>
<pre tabindex="0"><code>n = 7069789930583271525053215046247773438899869283661158227309691853515987055334306019600324056376312479212090202373516405860759222837585952590589336295698718699890424169542280710721069784487366121478569760563045886361884895363592898476736269784284754788133722060718026577238640218755539268465317292713320841554802703379684173485217045274942603346947299152498798736808975912326592689302969859834957202716983626393365387411319175917999258829839695189774082810459527737342402920881184864625678296442001837072332161966439361793009893108796934406114288057583563496587655548536011677451960307597573257032154009427010069578913
c1 = 488692928085934899944055554857568564903346089951134051486941368561567330884363274156339625953702601270565654444836193796061118053575538224794730472032345171432952984560662218697488844007827176184413713651118743456250147472678673801728916283759932987216388378211555067885210167894310696549664382751443669387953644382833924884208966436685137553434532738845959014828804809425096115758364136546390809453200055265653531950423111482644330073443545410319576097902472017235065047191133112557289289189187696092145850680765843608118584107829268136014912479701945735063525799796920293418182776436767911172221104640501952880057
c2 = 109770827223661560471527567179288748906402603483328748683689436879660543465776899146036833470531024202351087008847594392666852763100570391337823820240726499421306887565697452868723849092658743267256316770223643723095601213088336064635680075206929620159782416078143076506249031972043819429093074684182845530529249907297736582589125917235222921623698038868900282049587768700860009877737045693722732170123306528145661683416808514556360429554775212088169626620488741903267154641722293484797745665402402381445609873333905772582972140944493849645600529147490903067975300304532955461710562911203871840101407995813072692212
</code></pre><p>Additionally, the prime factors of $n$, namely $p$ and $q$, are given by</p>
<p>$$p = 2 r_1 r_2 ... r_u + 1\ \text{and}\ q = 2 s_1 s_2 ... s_v + 1,$$</p>
<p>where $r_1, ..., r_u, s_1, ..., s_v$ are all primes (less than $2^{20}$). Also, $c_1$ and $c_2$ are given by</p>
<p>$$\left\{\begin{aligned}
c_1 &amp;= {m_1}^e\ \text{mod}\ n \\
c_2 &amp;= e^{m_2}\ \text{mod}\ n
\end{aligned}\right.,$$</p>
<p>where $m_1$ and $m_2$ are two parts of the flag. The goal is to recover $m_1$ and $m_2$.</p>
<h3 id="side-step">Side step<a href="#side-step" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 28/421</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>side channel</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<p>Let $p = 2^{1024} - 2^{234} - 2^{267} - 2^{291} - 2^{403} - 1$.</p>
<p>When connected to the server, a secret $s \in [2, (p-1)/2]$ is randomly generated and is kept secret. We can send quadratic residues $g$ to the server and it returns the value of <code>pow_d(g, s, p)</code> defined below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">pow_d</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">t</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">bin</span><span class="p">(</span><span class="n">e</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]:</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span> <span class="n">t</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">		<span class="n">r</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="n">_</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">g</span> <span class="o">%</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span>
</span></span></code></pre></div><p>The objective is to send $g$ to the server such that $g^s\ \text{mod}\ p = 4$.</p>
<h3 id="faonsa">Faonsa<a href="#faonsa" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 21/421</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>elgamal</code>, <code>fault attack</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<div class="alert warning">
  <strong>Note.</strong> This challenge is known having an unintended solution. That said, the number of solves may not reflect the actual difficulty.
</div>

<p>When connected to the server, a 256-bit safe prime $p$ (i.e., $p = 2q+1$ where $q$ is also a prime), a primitive root $g \in \mathbb{Z}_p$ and a random $x \in [2, p/2)$ are generated. Define also $y = g^x\ \text{mod}\ p$.</p>
<p>We are given $(p, g, y)$ (ElGamal public key). Denote $P = p$ and $Y = y$. We can perform the three operations:</p>
<ol>
<li><strong>[Apply Fault]</strong> Flip up to 30 bits of $p$ and make it the new $P$. Set $Y = g^x\ \text{mod}\ P$.</li>
<li><strong>[Sign]</strong> Sign an arbitrary message $m\ (\neq m_0)$ with the ElGamal key $x, (P, g, Y)$.</li>
<li><strong>[Verify]</strong> Verify the signature $(m, s)$ using the public key $(P, g, Y)$. Additionally, if the signature is valid and $m = m_0$, the server will also send the flag.</li>
</ol>
<p>The goal is to obtain the flag using the <em>verify</em> operation.</p>
<h3 id="resign">Resign<a href="#resign" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 35/421</li>
<li>Difficulty: -</li>
<li>Tags: <code>rsa</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<p>We are given a message $m$ and a signature $s$. The objective is to generate a RSA key such that the $s$ is a signature of the message $m$.</p>
<h3 id="dbb">DBB<a href="#dbb" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 43/421</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>ecc</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<p>Let $P$ and $Q$ be points over elliptic curve $\mathcal{C}$, with $Q = m \cdot P$ ($m &lt; n$) and</p>
<p>$$\mathcal{C}: y^2 \equiv x^3 + ax + b\ (\text{mod}\ n).$$</p>
<p>We are given $n$, $P_x$, $Q_x$ and $Q_y$. The goal is to find $m$.</p>
<pre tabindex="0"><code>n = 34251514713797768233812437040287772542697202020425182292607025836827373815449
Px = 7331
Qx = 10680461779722115247262931380341483368049926186118123639977587326958923276962
Qy = 4003189979292111789806553325182843073711756529590890801151565205419771496727
</code></pre><h3 id="soda-">Soda üî•<a href="#soda-" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 17/421</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>rsa</code>, <code>math</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<div class="alert warning">
  <strong>Note.</strong> This challenge is known having an unintended solution. That said, the number of solves may not reflect the actual difficulty.
</div>

<p>A pair secret $p, q$ is determined and used for all remote connections. We are given $n = pq$, $g = 31337$ and $m_0 \approx 2^{159}$. We can also send $s\ (\neq m_0)$ to the server and it computes <code>soda(g, p, q, s)</code>, defined below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">soda</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">n</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="n">isPrime</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="ow">and</span> <span class="n">m</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">128</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">e</span> <span class="o">=</span> <span class="n">m</span>
</span></span><span class="line"><span class="cl">	<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">e</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="o">**</span><span class="mi">152</span><span class="p">)</span> <span class="o">^</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="n">GCD</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">d</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="nb">pow</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span></code></pre></div><p>The objective is to find $s$ such that $s^e\ \text{mod}\ n = g$, where <code>e = 2 * (pow(g, m0**2, n) % 2**152) ^ 1</code>.</p>
<h3 id="sparse">Sparse<a href="#sparse" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 38/421</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>rsa</code>, <code>math</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<p>Let $p$ and $q$ be the two 417-bit prime factors of the RSA public modulus $n$ such that</p>
<p>$$q = p + \sum_{i=1}^5 r_i \cdot 2^{b_i},$$</p>
<p>where $r_i \in \{-1, 0, 1\}$ and $b_i \in \{3, ..., 413\}$ for $i = 1, 2, 3, 4, 5$. We are given the RSA public key $(n, e = 65537)$ and the ciphertext $c$ (encrypted by the RSA key). The objective is to decrypt $c$ for the flag.</p>
<h3 id="fiercest">Fiercest<a href="#fiercest" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 29/421</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>rsa</code>, <code>fault attack</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<div class="alert warning">
  <strong>Note.</strong> This challenge is known having an unintended solution. That said, the number of solves may not reflect the actual difficulty.
</div>

<p>When connected to the server, a 1024-bit RSA modulus $n$ is generated. We are given $n, e = 65537$ as the RSA public key. Denote $N = n$. We can perform the two operations:</p>
<ol>
<li><strong>[Apply Fault]</strong> Flip up to 2 bits of $n$ and set it as the new $N$.</li>
<li><strong>[Verify]</strong> Verify the signature $(m, s)$ using the public key $(N, e)$. Additionally, if the signature is valid and $m = m_0$, the server will also send the flag.</li>
</ol>
<p>The goal is to obtain the flag using the <em>verify</em> operation.</p>
<h3 id="persian-cat">Persian cat<a href="#persian-cat" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 13/421</li>
<li>Difficulty: ‚≠ê</li>
<li>Tags: <code>block cipher</code>, <code>custom cipher</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<div class="alert warning">
  <strong>Note.</strong> This challenge is known having an unintended solution. That said, the number of solves may not reflect the actual difficulty.
</div>

<p>The challenge implements a custom cipher (code below). The server keeps a secret key (namely <code>skey</code>) and we are allowed to send <code>m</code> (needs to be ASCII-printable). We will obtain <code>encrypt(m + flag, skey)</code>.</p>
<p>The objective is to recover <code>flag</code>.</p>



  <div class="collapsable-code">
    <input id="693541278" type="checkbox" checked />
    <label for="693541278">
      <span class="collapsable-code__language">python</span>
      <span class="collapsable-code__title">Persian cat cipher</span>
      <span class="collapsable-code__toggle" data-label-expand="[‚ñ≥]" data-label-collapse="[‚ñΩ]"></span>
    </label>
    <pre class="language-python" ><code>
Omega = [
		0x4e, 0x96, 0xfd, 0x7d, 0x8d, 0xf6, 0xdb, 0x33, 0x1e, 0x16, 0x9b, 0x6a, 0xe2, 0xc9, 0xa9, 0xe0, 
		0x34, 0xe6, 0x86, 0xd6, 0x52, 0x02, 0x25, 0x1f, 0x23, 0xdf, 0xd5, 0x12, 0x45, 0x6b, 0x6f, 0x4d, 
		0x31, 0x77, 0x09, 0xbf, 0x93, 0xca, 0x4b, 0xef, 0xee, 0x7c, 0x53, 0x1a, 0xc8, 0xea, 0x9d, 0xda, 
		0x32, 0xa4, 0x11, 0x7b, 0xd8, 0x3f, 0x13, 0x57, 0x75, 0xcb, 0x37, 0x9a, 0x83, 0xa5, 0x3e, 0xd3, 
		0x4a, 0x1d, 0x29, 0xb9, 0x18, 0x27, 0x2d, 0x0f, 0x15, 0x0d, 0x66, 0xae, 0xf5, 0xfa, 0x08, 0x9f, 
		0xc6, 0x55, 0xa0, 0xb7, 0x28, 0x0e, 0xf4, 0x01, 0x04, 0x46, 0xf9, 0x39, 0xe3, 0x7f, 0x5e, 0x61, 
		0x40, 0x26, 0xec, 0xb6, 0x14, 0xf0, 0x59, 0x50, 0xcf, 0x3a, 0x8b, 0x43, 0xaf, 0x10, 0xe5, 0xe8, 
		0x03, 0xbd, 0x51, 0xa7, 0x1c, 0x8e, 0x7a, 0x98, 0x3c, 0xeb, 0xac, 0x54, 0x84, 0xf7, 0x62, 0x88, 
		0x64, 0xa8, 0xbb, 0xab, 0xe1, 0x95, 0x94, 0x41, 0x2a, 0x60, 0x30, 0xcc, 0x48, 0xd2, 0x89, 0xb2, 
		0x65, 0x76, 0x0a, 0xb8, 0x56, 0x4f, 0xc3, 0x87, 0xdd, 0x4c, 0xc2, 0xd4, 0x82, 0x35, 0x90, 0xa2, 
		0x5f, 0xad, 0x19, 0x74, 0x73, 0xd0, 0x24, 0x69, 0x20, 0x07, 0xdc, 0x1b, 0x44, 0x58, 0xff, 0x5a, 
		0x6c, 0xf2, 0xfb, 0x8c, 0x79, 0x97, 0xa6, 0x22, 0xb4, 0x7e, 0x5b, 0x17, 0x2f, 0x91, 0x71, 0xfe, 
		0x38, 0xa3, 0x05, 0xb1, 0xba, 0x99, 0xd9, 0xf1, 0x21, 0x5c, 0x67, 0x6d, 0xde, 0xaa, 0xc7, 0x8f, 
		0x81, 0x0b, 0xb0, 0xbc, 0x0c, 0xcd, 0x63, 0xc1, 0xfc, 0xc0, 0x42, 0x78, 0xc5, 0x8a, 0x06, 0x3d, 
		0x2e, 0x9e, 0xa1, 0x80, 0xb3, 0xf8, 0xe9, 0x68, 0xd1, 0x36, 0x70, 0x49, 0xc4, 0xd7, 0x2c, 0x6e, 
		0xe7, 0xb5, 0xbe, 0x92, 0xce, 0xed, 0xf3, 0x9c, 0xe4, 0x3b, 0x47, 0x2b, 0x85, 0x5d, 0x72, 0x01
		]

def padding(msg):
	if len(msg) % 32 != 0:
		extra = &#39;*&#39; * (32 - len(msg) % 32)
		return msg &#43; extra
	else:
		return msg

def keygen(u, v):
	return [a ^ b for a, b in zip(u, v)][:20]

def roadrunner(table, roadrunner_wile, lili, lilibeth, omega):
	for z in range(16):
		roadrunner_wile[z] = (((omega[table[lili[z][0]]] | omega[table[lili[z][1]]]) &#43;
			(omega[table[lili[z][2]]] | omega[table[lili[z][3]]])) ^ ((omega[table[lili[z][4]]] &#43;
			omega[table[lili[z][5]]]) &#43; (omega[table[lili[z][6]]] ^ omega[table[lili[z][7]]]))) % 256
		roadrunner_wile[z] = (roadrunner_wile[z] &#43; (((~omega[table[lili[z][8]]] ^ omega[table[lili[z][9]]]) &#43;
			(omega[table[lili[z][10]]] &amp; ~omega[table[lili[z][11]]])) ^ ((omega[table[lili[z][12]]] ^ 
			~omega[table[lili[z][13]]]) &#43; (omega[table[lili[z][14]]] ^ omega[table[lili[z][15]]])))) % 256
		roadrunner_wile[z] = (roadrunner_wile[z] &#43; lilibeth[roadrunner_wile[z]] &#43; lilibeth[z]) % 256
	return roadrunner_wile

def roadrunner_init(table, roadrunner_wile, lili, lilibeth, omega):
	SBOX = [
		[10, 11, 4, 5, 15, 0, 2, 3, 1, 9, 14, 6, 7, 12, 8, 13], 
		[1, 11, 13, 2, 0, 7, 3, 8, 14, 4, 6, 15, 5, 10, 12, 9], 
		[1, 9, 0, 4, 11, 5, 2, 8, 15, 7, 3, 6, 10, 14, 13, 12], 
		[5, 0, 9, 8, 3, 10, 12, 4, 1, 6, 7, 11, 15, 14, 2, 13], 
		[10, 6, 13, 3, 2, 11, 12, 14, 5, 9, 4, 1, 0, 8, 15, 7], 
		[15, 6, 1, 10, 7, 13, 14, 8, 3, 12, 0, 5, 2, 9, 4, 11], 
		[13, 7, 9, 5, 14, 12, 8, 15, 6, 0, 10, 4, 3, 11, 2, 1], 
		[13, 15, 8, 10, 6, 11, 9, 7, 12, 2, 3, 4, 14, 0, 5, 1], 
		[11, 3, 14, 7, 4, 8, 12, 2, 13, 0, 6, 1, 9, 10, 5, 15], 
		[2, 3, 14, 9, 11, 5, 15, 0, 4, 7, 1, 6, 12, 13, 8, 10], 
		[13, 3, 14, 1, 10, 0, 6, 5, 7, 2, 4, 9, 12, 8, 11, 15], 
		[15, 7, 4, 12, 14, 2, 9, 6, 3, 1, 13, 5, 0, 8, 11, 10], 
		[10, 7, 5, 14, 6, 2, 15, 1, 8, 11, 12, 9, 0, 3, 4, 13], 
		[1, 5, 0, 4, 6, 9, 11, 12, 3, 14, 7, 2, 15, 8, 13, 10], 
		[14, 9, 11, 2, 10, 4, 3, 0, 5, 8, 6, 15, 1, 12, 13, 7], 
		[11, 13, 6, 2, 0, 9, 3, 12, 1, 8, 7, 15, 4, 5, 10, 14]
		]
	for z in range(16):
		roadrunner_wile[z] = (((omega[table[SBOX[z][0]]] | omega[table[SBOX[z][1]]]) &#43;
			(omega[table[SBOX[z][2]]] | omega[table[SBOX[z][3]]])) ^ ((omega[table[SBOX[z][4]]] &#43;
			omega[table[SBOX[z][5]]]) &#43; ( omega[table[SBOX[z][6]]] ^ omega[table[SBOX[z][7]]]))) % 256
		roadrunner_wile[z] = (roadrunner_wile[z] &#43; (((~omega[table[SBOX[z][8]]] ^ omega[table[SBOX[z][9]]]) &#43; 
			(omega[table[SBOX[z][10]]] &amp; ~omega[table[SBOX[z][11]]])) ^ ((omega[table[SBOX[z][12]]] ^ 
			~omega[table[SBOX[z][13]]]) &#43; (omega[table[SBOX[z][14]]] ^ omega[table[SBOX[z][15]]])))) % 256
	return roadrunner_wile

def circle_it_out(msg, ruler, roadrunner_wile, lili, lilibeth, enc, l, r, omega):
	for i in range(16):
		l[0][i] = msg[i]
		r[0][i] = msg[i&#43;16]
	for i in range(1, ruler):
		roadrunner_wile = roadrunner(r[i-1], roadrunner_wile, lili, lilibeth, omega)
		for y in range(16):
			l[i][y] = r[i-1][y]
			r[i][y] = (l[i-1][y] ^ roadrunner_wile[y])%256
	for i in range(16):
		enc[i&#43;16] = l[ruler-1][i]%256
		enc[i] = r[ruler-1][i]%256
	return roadrunner_wile, enc, l, r

def circle_it_out_init(msg, ruler, roadrunner_wile, lili, lilibeth, enc, l, r, omega):
	for i in range(16):
		l[0][i] = msg[i]
		r[0][i] = msg[i&#43;16]
	for i in range(1,ruler):
		roadrunner_wile = roadrunner_init(r[i-1], roadrunner_wile, lili, lilibeth, omega)
		for y in range(16):
			l[i][y] = r[i-1][y]
			r[i][y] = (l[i-1][y] ^ roadrunner_wile[y])%256
	for i in range(16):
		enc[i] = l[ruler-1][i]%256
		enc[i&#43;16] = r[ruler-1][i]%256
	return roadrunner_wile, enc, l, r

def persian_init(key, roadrunner_wile, lili, lilibeth, enc, l, r, omega, Omega):
	stkey = [88, 20, 64, 181, 251, 167, 69, 243, 205, 166, 110, 65, 90, 176, 229, 46, 206, 104, 15, 19, 49, 101, 3, 223, 221, 231, 232, 43, 62, 193, 80, 228]
	for compt in range(256):
		omega[compt] = (Omega[compt]^key[compt%20]) % 256
	for w in range(4):
		roadrunner_wile, enc, l, r = circle_it_out_init(stkey, 32, roadrunner_wile, lili, lilibeth, enc, l, r, omega);
		for compt in range(256):
			omega[compt] = (omega[compt]^enc[compt%32])%256
		for compt in range(32):
			stkey[compt] = enc[compt]
	for compt in range(16):
		err = 0
		ix = 0
		while ix &lt; 16:
			roadrunner_wile, enc, l, r = circle_it_out_init(enc, 4, roadrunner_wile, lili, lilibeth, enc, l, r, omega)
			x = 0
			while x &lt; ix:
				if lili[compt][x] == (enc[7]%16):
					x = ix
					err = 1
					roadrunner_wile, enc, l, r = circle_it_out_init(enc, 4, roadrunner_wile, lili, lilibeth, enc, l, r, omega)
				else: x &#43;= 1
			if err == 0: lili[compt][ix] = enc[7]%16
			else:
				err = 0;
				ix = ix-1;
			ix &#43;= 1
	err = 0 
	ix = 0
	while ix &lt; 256:
		roadrunner_wile, enc, l, r = circle_it_out_init(enc, 4, roadrunner_wile, lili, lilibeth, enc, l, r, omega)
		x = 0
		while x &lt; ix:
			if lilibeth[x] == ( enc[7]%256):
				x  = ix 
				err = 1
				roadrunner_wile, enc, l, r = circle_it_out_init(enc, 4, roadrunner_wile, lili, lilibeth, enc, l, r, omega)
			else:	
				x &#43;= 1
		if err == 0: lilibeth[ix]=enc[7]%256
		else:
			err = 0;
			ix = ix-1;
		ix &#43;= 1
	for compt in range(256):
		omega[compt] = (omega[compt] ^ key[compt%20])%256	
	for w in range(4):
		roadrunner_wile, enc, l, r = circle_it_out_init(stkey, 32, roadrunner_wile, lili, lilibeth, enc, l, r, omega)
		for compt in range(256):
			omega[compt] = (omega[compt] ^ enc[compt%32])%256
		for compt in range(32):
			stkey[compt] = enc[compt]
	return roadrunner_wile, lili, lilibeth, enc, l, r, omega

def encrypt_iginition(msg, key):
	roadrunner_wile = [0 for x in range(16)]
	lili = [[0 for x in range(16)] for y in range(256)] 
	lilibeth, omega = [[0 for x in range(256)] for _ in &#39;01&#39;]
	enc = [0 for x in range(32)]
	l, r = [[[0 for x in range(16)] for y in range(32)] for _ in &#39;01&#39;] 
	roadrunner_wile, lili, lilibeth, enc, l, r, omega = persian_init(key, roadrunner_wile, lili, lilibeth, enc, l, r, omega, Omega)
	roadrunner_wile, enc, l, r = circle_it_out(msg, 6, roadrunner_wile, lili, lilibeth, enc, l, r, omega)
	return enc

def encrypt(msg, key):
	msg = padding(msg)
	blocks = [msg[i*32:i*32&#43;32] for i in range(len(msg) // 32)]
	ciphers = []
	enc = encrypt_iginition([ord(item) for item in blocks[0]], key)
	ciphers.append(enc)
	for i in range(len(blocks)-1):
		enc = encrypt_iginition([ord(item) for item in blocks[i&#43;1]], keygen([ord(item) for item in blocks[i]], ciphers[i]))
		ciphers.append(enc)
	return &#34;&#34;.join(&#34;&#34;.join(str(format(i, &#34;02x&#34;)) for i in item) for item in ciphers)
</code></pre>
  </div>


<h3 id="keydream">Keydream<a href="#keydream" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 42/421</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>rsa</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<p>Let $p$ and $q$ be two primes such that</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">rstr</span> <span class="o">=</span> <span class="s1">&#39;CCTF{it_is_fake_flag_&#39;</span> <span class="o">+</span> <span class="n">randstr</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_90OD_luCk___!!}&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="n">rstr</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span> <span class="o">=</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="n">rstr</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span></span></code></pre></div><p>Let $(n = p \cdot q, e = 65537)$ be the public key and $c$ being the encrypted flag. The goal is to recover $m$ (the flag).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">23087202318856030774680571525957068827041569782431397956837104908189620961469336659300387982516148407611623358654041246574100274275974799587138270853364165853708786079644741407579091918180874935364024818882648063256767259283714592098555858095373381673229188828791636142379379969143042636324982275996627729079</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="mi">3621516728616736303019716820373078604485184090642291670706733720518953475684497936351864366709813094154736213978864841551795776449242009307288704109630747654430068522939150168228783644831299534766861590666590062361030323441362406214182358585821009335369275098938212859113101297279381840308568293108965668609</span>
</span></span></code></pre></div><h3 id="nlcs-">NLCS üî•<a href="#nlcs-" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 5/421</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>lfsr</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<p>Let $s_0, s_1, ..., s_{65535}$ be the first $65536$ output bits of the LFSR system using an irreducible polynomial $f(x) = x^{64} + x^{33} + x^{30} + ... \in \mathbb{F}_2[x]$ and the initial state $s_0, s_1, ..., s_{63}$, derived from the flag. We are given the values of</p>
<p>$$\begin{aligned}
t_i := (s_i &amp;+ s_{i + 12} + s_{i + 62} + s_{i + 18} + s_{i + 36}) \\
&amp;+ (s_{i + 2}s_{i + 8} + s_{i + 34}s_{i + 20} + s_{i + 27}s_{i + 60} + s_{i + 31}s_{i + 34} \\
&amp;+ s_{i + 63}s_{i + 48} + s_{i + 50}s_{i + 15} + s_{i + 25}s_{i + 49} + s_{i + 49}s_{i + 7}) \\
&amp;+ (s_{i + 13}s_{i + 61}s_{i + 10} + s_{i + 32}s_{i + 37}s_{i + 29} + s_{i + 9}s_{i + 6}s_{i + 42} \\
&amp;+ s_{i + 59}s_{i + 26}s_{i + 55} + s_{i + 42}s_{i + 41}s_{i + 29} + s_{i + 58}s_{i + 21}s_{i + 24})
\end{aligned}$$</p>
<p>for every $i\in [0, 65536 - 64]$, the goal is to recover $s_0, s_1, \ldots, s_{63}$.</p>
<p><em>Credits: <a href="https://twitter.com/grhkm21" target="_blank" rel="nofollow">@grhkm21</a> for the challenge summary.</em></p>
<h3 id="shaim">Shaim<a href="#shaim" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 15/421</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>hash</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<p>Define the <code>shaim</code> algorithm be the below. We are given a printable message $m_0$ (which has length between 40 and 71). The objective is to find a message $m$ such that <code>shaim(m) == shaim(m0)</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">shaim</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">SBOX</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">		<span class="mh">0xbe</span><span class="p">,</span> <span class="mh">0xc5</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0xb2</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0xa8</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x4c</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0xd6</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0xa7</span><span class="p">,</span> <span class="mh">0x7c</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">		<span class="mh">0x1a</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0xf3</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0xd2</span><span class="p">,</span> <span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0x2c</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="mh">0xa0</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0xcb</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">		<span class="mh">0xe5</span><span class="p">,</span> <span class="mh">0x4d</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x8f</span><span class="p">,</span> <span class="mh">0xd9</span><span class="p">,</span> <span class="mh">0x6d</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0xfc</span><span class="p">,</span> <span class="mh">0xfa</span><span class="p">,</span> <span class="mh">0xba</span><span class="p">,</span> <span class="mh">0xdd</span><span class="p">,</span> <span class="mh">0xc7</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0xc1</span><span class="p">,</span> <span class="mh">0x1c</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">		<span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0x7b</span><span class="p">,</span> <span class="mh">0x4b</span><span class="p">,</span> <span class="mh">0xc8</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0x5d</span><span class="p">,</span> <span class="mh">0xc9</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0x6b</span><span class="p">,</span> <span class="mh">0xdb</span><span class="p">,</span> <span class="mh">0x5e</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="mh">0xfb</span><span class="p">,</span> <span class="mh">0x8d</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x91</span><span class="p">,</span> <span class="mh">0x7e</span><span class="p">,</span> <span class="mh">0xf4</span><span class="p">,</span> <span class="mh">0xe7</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0xb8</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x8b</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">		<span class="mh">0x90</span><span class="p">,</span> <span class="mh">0xe9</span><span class="p">,</span> <span class="mh">0xee</span><span class="p">,</span> <span class="mh">0xd5</span><span class="p">,</span> <span class="mh">0xd3</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xa9</span><span class="p">,</span> <span class="mh">0xae</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0xf5</span><span class="p">,</span> <span class="mh">0xac</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x4a</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">		<span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x8a</span><span class="p">,</span> <span class="mh">0xa3</span><span class="p">,</span> <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0xdf</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0xda</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0xb1</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0xf2</span><span class="p">,</span> <span class="mh">0xfe</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">		<span class="mh">0xbf</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x1b</span><span class="p">,</span> <span class="mh">0x4e</span><span class="p">,</span> <span class="mh">0x9f</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0xa6</span><span class="p">,</span> <span class="mh">0x2b</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0xd4</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0xc6</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x7a</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">		<span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0xc4</span><span class="p">,</span> <span class="mh">0xdc</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0xbc</span><span class="p">,</span> <span class="mh">0x1d</span><span class="p">,</span> <span class="mh">0xb6</span><span class="p">,</span> <span class="mh">0xde</span><span class="p">,</span> <span class="mh">0xe6</span><span class="p">,</span> <span class="mh">0xe3</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">		<span class="mh">0xeb</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x8c</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0xa2</span><span class="p">,</span> <span class="mh">0xc2</span><span class="p">,</span> <span class="mh">0xfd</span><span class="p">,</span> <span class="mh">0x3c</span><span class="p">,</span> <span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0xad</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">		<span class="mh">0x2f</span><span class="p">,</span> <span class="mh">0xbd</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0xa1</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0xca</span><span class="p">,</span> <span class="mh">0x9d</span><span class="p">,</span> <span class="mh">0x3a</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0xd7</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">		<span class="mh">0x59</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0x5c</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0xf9</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xd1</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x9c</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">		<span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x6e</span><span class="p">,</span> <span class="mh">0xb4</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0xce</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x1e</span><span class="p">,</span> <span class="mh">0x2a</span><span class="p">,</span> <span class="mh">0x9b</span><span class="p">,</span> <span class="mh">0xe2</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0xb5</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">		<span class="mh">0x23</span><span class="p">,</span> <span class="mh">0x3d</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0xaa</span><span class="p">,</span> <span class="mh">0xf7</span><span class="p">,</span> <span class="mh">0x9e</span><span class="p">,</span> <span class="mh">0xed</span><span class="p">,</span> <span class="mh">0xb3</span><span class="p">,</span> <span class="mh">0xe1</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x7d</span><span class="p">,</span> <span class="mh">0x3b</span><span class="p">,</span> <span class="mh">0xb7</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x9a</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">		<span class="mh">0x4f</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0xf1</span><span class="p">,</span> <span class="mh">0xf0</span><span class="p">,</span> <span class="mh">0xe0</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0x7f</span><span class="p">,</span> <span class="mh">0xbb</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x5b</span><span class="p">,</span> <span class="mh">0xe4</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0xef</span><span class="p">,</span> <span class="mh">0xea</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">		<span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mh">0xcc</span><span class="p">,</span> <span class="mh">0xb0</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0x3e</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0xaf</span><span class="p">,</span> <span class="mh">0xd8</span><span class="p">,</span> <span class="mh">0x2e</span><span class="p">,</span> <span class="mh">0xa5</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0xa4</span><span class="p">,</span> <span class="mh">0xcf</span>
</span></span><span class="line"><span class="cl">		<span class="p">]</span>
</span></span><span class="line"><span class="cl">	<span class="n">nbit</span><span class="p">,</span> <span class="n">hmsg</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span> <span class="n">msg</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="n">hmsg</span> <span class="o">+=</span> <span class="s1">&#39;f&#39;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">hex</span><span class="p">())</span><span class="o">*</span><span class="mi">4</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">	<span class="n">hmsg</span> <span class="o">+=</span> <span class="p">(</span><span class="n">nbit</span> <span class="o">-</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">hmsg</span><span class="p">)</span> <span class="o">%</span> <span class="n">nbit</span><span class="p">))</span> <span class="o">//</span> <span class="mi">4</span> <span class="o">*</span> <span class="s1">&#39;f&#39;</span>
</span></span><span class="line"><span class="cl">	<span class="n">H</span><span class="p">,</span> <span class="n">SBOX_M</span>  <span class="o">=</span> <span class="p">[],</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">hmsg</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="n">tmp</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="n">SBOX</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">hmsg</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">)])[</span><span class="mi">2</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">		<span class="n">tmp</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span> <span class="o">+</span> <span class="n">tmp</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">tmp</span>
</span></span><span class="line"><span class="cl">		<span class="n">SBOX_M</span> <span class="o">+=</span> <span class="n">tmp</span>
</span></span><span class="line"><span class="cl">	<span class="n">hmsg</span> <span class="o">=</span> <span class="n">SBOX_M</span>  
</span></span><span class="line"><span class="cl">	<span class="n">l</span> <span class="o">=</span> <span class="n">nbit</span> <span class="o">//</span> <span class="mi">4</span>     
</span></span><span class="line"><span class="cl">	<span class="n">H</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">hmsg</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">l</span><span class="p">],</span> <span class="mi">16</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">hmsg</span><span class="p">)</span> <span class="o">//</span> <span class="n">l</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="n">plain</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hmsg</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">l</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">l</span><span class="p">],</span> <span class="mi">16</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="n">key</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">		<span class="n">_DES</span> <span class="o">=</span> <span class="n">DES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">DES</span><span class="o">.</span><span class="n">MODE_OFB</span><span class="p">,</span> <span class="n">IV</span> <span class="o">=</span> <span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">H</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bytes_to_long</span><span class="p">(</span><span class="n">_DES</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">plain</span><span class="p">))</span> <span class="o">^</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="n">dgst</span> <span class="o">=</span> <span class="n">sha256</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">dgst</span>
</span></span></code></pre></div><h3 id="lagima">Lagima<a href="#lagima" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 24/421</li>
<li>Difficulty: ‚≠ê</li>
<li>Tags: <code>math</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<p>Let $n = 313$ and $s$ be a secret integer. We are given $n$ permutations of $[1, n]$, say $p_1, \ldots, p_n \in S_n$, as well as $p_1^s, \ldots, p_n^s$ (i.e., $p_1, p_2, ..., p_n$ applied $s$ times). The goal is to recover $s$.</p>
<p><em>Credits: <a href="https://twitter.com/grhkm21" target="_blank" rel="nofollow">@grhkm21</a> for the challenge summary.</em></p>
<h3 id="starter-ecc">Starter ECC<a href="#starter-ecc" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 43/421</li>
<li>Difficulty: ‚≠ê</li>
<li>Tags: <code>ecc</code>, <code>math</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<p>We are given $n, a, b, x$. The objective is to find $y$ such that $y^2 \equiv x^3 + ax + b\mod n$.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="mi">10715086071862673209484250490600018105614048117055336074437503883703510511249361224931983788156958581275946729175531468251871452856923140435984577574698574803934567774824230985421074605062371141877954182153046477020617917601884853827611232355455223966039590143622792803800879186033924150173912925208583</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="mi">31337</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="mi">66826418568487077181425396984743905464189470072466833884636947306507380342362386488703702812673327367379386970252278963682939080502468506452884260534949120967338532068983307061363686987539408216644249718950365322078643067666802845720939111758309026343239779555536517718292754561631504560989926785152983649035</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">117224988229627436482659673624324558461989737163733991529810987781450160688540001366778824245275287757373389887319739241684244545745583212512813949172078079042775825145312900017512660931667853567060810331541927568102860039898116182248597291899498790518105909390331098630690977858767670061026931938152924839936</span>
</span></span></code></pre></div><p><em>Credits: <a href="https://twitter.com/grhkm21" target="_blank" rel="nofollow">@grhkm21</a> for the challenge summary.</em></p>
<h3 id="versace">Versace<a href="#versace" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 15/421</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>dlog</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<p>Define a custom asymmetric cipher, where the below are the <code>keygen</code> and the <code>encrypt</code> functions:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">keygen</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl">	<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">getRandomRange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="s1">&#39;01&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	<span class="n">fi</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">th</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">fi</span><span class="p">,</span> <span class="n">th</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">pubkey</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">n</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">fi</span><span class="p">,</span> <span class="n">th</span> <span class="o">=</span> <span class="n">pubkey</span>
</span></span><span class="line"><span class="cl">	<span class="n">k</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">getRandomRange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="s1">&#39;012&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	<span class="n">c_1</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">c_2</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">c_3</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">c_4</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">fi</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">th</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">m</span> <span class="o">%</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">c_1</span><span class="p">,</span> <span class="n">c_2</span><span class="p">,</span> <span class="n">c_3</span><span class="p">,</span> <span class="n">c_4</span>
</span></span></code></pre></div><p>Given $n$ and a set of output from <code>pubkey = keygen(n)</code> and <code>enc = encrypt(msg, pubkey)</code>. The objective is to find <code>msg</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">141886649864474336567180245736091175577519141092893110664440298696325928109107819365023509727482657156444454196974621121317731892910779276975799862237645015028934626195549529415068518701179353407407170273107294065819774663163018151369555922179926003735413019069305586784817562889650637936781439564028325920769</span>
</span></span><span class="line"><span class="cl"><span class="n">pubkey</span> <span class="o">=</span> <span class="p">(</span><span class="mi">141886649864474336567180245736091175577519141092893110664440298696325928109107819365023509727482657156444454196974621121317731892910779276975799862237645015028934626195549529415068518701179353407407170273107294065819774663163018151369555922179926003735413019069305586784817562889650637936781439564028325920769</span><span class="p">,</span> <span class="mi">65537</span><span class="p">,</span> <span class="mi">125494383162828289973475117066203219587304356806057400173045477137700391356840397636206107925460433939119412469184723408274805651096828270461235114589209044543108910295997506041345432448035371092981112305692014036117962906342882215492784319467728201344342591126197621795974549431806828947671232171059809967991</span><span class="p">,</span> <span class="mi">138257736445723754207239869344459794807808248188757696052272858978544083465381926995900887162870612185045399616892685750962667762789508194359878372465943702647287813020223160406789982302692329883577043521781397505345137392777694159916452699296748509096494301465498192136911589776144421856343483031920756519249</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">enc</span> <span class="o">=</span> <span class="p">(</span><span class="mi">88920444409754899592335110119456825172544580816901497880270628553955508488170483498726344301421934007876515783471747430111559265733377611608113080609941423596790625452564403457107243481310552344096683637970851198148957553062631972064855184560312748315536290880767375156429548232884895308088306625307674645678</span><span class="p">,</span> <span class="mi">45539956581550314230977168288877082058214432324397034618326297663129864608739856352261029083496409133620455599376139981575342903237304167908534019438874239934645347320209162850653298515960349717851268830205737252263548268549179642907155075129172651815656517165432021020317138111104384072600486843574535899860</span><span class="p">,</span> <span class="mi">69849817078368866947686316374564245958824276178721440086311727765763093314086243149277327430285562537315291446874425715021031882041090977200029684675392021083309757246079110723453995717856469919242618068208424495615283285085190255592463862108516827540775850882615540406750734639040903336048095547788528187976</span><span class="p">,</span> <span class="mi">20285007564778647051596518902857046010716548094264173639037549746086538656814534621919993169453446815272789643882592631536755194356753848872566348635207131520597253599540337542405837637606323276917410384296602682043902830628022440639028040137219164743287397377174047728489836106561656239657061612908104843401</span><span class="p">)</span>
</span></span></code></pre></div><p><em>Credits: <a href="https://twitter.com/grhkm21" target="_blank" rel="nofollow">@grhkm21</a> for the challenge summary.</em></p>
<h3 id="gsdp">GSDP<a href="#gsdp" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 24/421</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>math</code></li>
<li>Author: <a href="https://twitter.com/refactoreal" target="_blank" rel="nofollow">@refactoreal</a>, <a href="https://twitter.com/y3noor" target="_blank" rel="nofollow">@y3noor</a></li>
</ul>
<p>Let $R, S \in M_{5, 5}(\mathbb{Z}_n)$ be random matrices. We are given $n, R, S, Y, C_1$ and $C_2$:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">20474248118672564431085568112167867588651829</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">2168977325369444782802512809005167009163457</span>  <span class="mi">9637731563002649997560875900298785659999735</span> <span class="mi">11402741982195550777990817093767890991834736</span>  <span class="mi">6248261665690503242396669505673833765541530</span> <span class="mi">18383713927317640760514600671318653784954042</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">16744026390724915738262959513570982580233867</span> <span class="mi">10819123318870588054961801715028528659245735</span>  <span class="mi">5382293825969147064471127752184942873958882</span>  <span class="mi">2344559383975384575566938072263260707083674</span>  <span class="mi">6107831242377773278696901510341268870768483</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">13913478639322625565461944432421523802028490</span>  <span class="mi">1657756157808133991943366467693421012417454</span> <span class="mi">20077078978711296540965234618986335826824167</span> <span class="mi">15787724170325517021960596569296223410283963</span> <span class="mi">11311327970428371404045885802092772454814312</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span> <span class="mi">6961572103900078883590821780051797472394845</span>  <span class="mi">9455345930492634517894541442153982197931104</span>  <span class="mi">7188007809979291502164073459871201264229019</span>  <span class="mi">5450777010613496799286069470550372888274079</span> <span class="mi">19294083677962489844799387987438241606854764</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span> <span class="mi">2085952337131731679161648956407072286901978</span>  <span class="mi">6312527395255217479599228946227018949620025</span>  <span class="mi">3768572167307432043022080651953496439648407</span> <span class="mi">12149358492352082063390352013944276402659624</span>  <span class="mi">1238053480843820309901822772557963596458725</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mi">14359986778171934757328112351570087412922923</span> <span class="mi">11851267097835964101770194163721259897123880</span> <span class="mi">12595767519284390452196370829927812771980581</span>   <span class="mi">206471849033914539608937494910010443534631</span> <span class="mi">16748276256578102130941428769109053956841543</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">17260552917456245674154511124533873366489719</span>  <span class="mi">6705751087806309384311406617121931614484164</span> <span class="mi">17060390771834209118913353599009244296476485</span> <span class="mi">14200001344699610276445944574627003822066232</span> <span class="mi">11014902955514050741738009264685742116160993</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span> <span class="mi">6574547665819712697427953197398960761636762</span> <span class="mi">12380657135986764418898027400335749204149860</span> <span class="mi">20268210493845979828493975027685347139394991</span> <span class="mi">18542561637456865344299035395313783209218383</span>  <span class="mi">7517573123535289654812496192079398350464721</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">11797258068553520501845550128339899816126913</span> <span class="mi">18396577268206658268808323909560870783161039</span>  <span class="mi">5490905135614309369346662799065239256309022</span> <span class="mi">14271245849005639472351475697722779937695903</span>  <span class="mi">4543895191969014210971676462965142633095929</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span> <span class="mi">8211670484406041965410550067328494865731128</span>  <span class="mi">9385233048164928123059801337014436991987865</span>  <span class="mi">2095213218314387589455876832673480152942740</span> <span class="mi">13404162072797239424739266925419641170015472</span>  <span class="mi">6893572325245832032339890201821364839102869</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">9455266042843307825749316910810796871873373</span> <span class="mi">15333106063741475447799261101208428669252581</span> <span class="mi">17507977101165165875868259123812011424101505</span> <span class="mi">18840713703683969794184618879025658583771001</span>  <span class="mi">8194677825423260832777930195809869229371863</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">12501728660245911874452737460699597975974127</span> <span class="mi">19510243647017562462989706821025083261970404</span> <span class="mi">16201393977361396153964696776216973010001356</span>  <span class="mi">9663056411865435751212414658633217623172749</span>  <span class="mi">3239680106699734686590526219042751814995824</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span> <span class="mi">3712586611180063604215543952289707697324027</span> <span class="mi">14733212399197986119485181728946640781107458</span>  <span class="mi">2840139099323763287710523315368925837277792</span> <span class="mi">13720228569300291500610175158110171144774084</span>  <span class="mi">6108815350519225911945135207538331156078296</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span> <span class="mi">7943973119701029382921917301472306070824581</span>  <span class="mi">2869347305630973901685036806460889911095637</span> <span class="mi">10842022254827356928486285947954965977783240</span> <span class="mi">20363982398752260203093070660357855892929807</span>  <span class="mi">3232527006736169029584220678644241677651188</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">18741615057330867264302735709730246936126331</span>  <span class="mi">7207581826003452274777064725926668618294351</span> <span class="mi">12235279908760679864964056098862023499484670</span> <span class="mi">11395481161377031878998588680860748310228740</span> <span class="mi">14691306415490831547905993706341909177907668</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">c_1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">14520715136678131886650886394655992310739740</span>  <span class="mi">5133803346119603685589690243318329447613811</span>  <span class="mi">8631069083165564771821540186676532972101042</span> <span class="mi">11371460936058753234877719062830204068473293</span>  <span class="mi">4675643908977844081807119750891783452511801</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="mi">10758446634943798177756512241470807154028028</span>   <span class="mi">230322671654482905785761279475308992164431</span> <span class="mi">19859272618066856343509476253828743509021381</span> <span class="mi">10790059806866303289733349155468067057434048</span>  <span class="mi">7937553273189724162746367232714449171157875</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="mi">12713707768421115203045631708468778038780988</span>  <span class="mi">6562443329388128558909111073920129986165358</span>  <span class="mi">8629397281530840800788762372728359271085200</span>  <span class="mi">3497280351202001940823865223283895540070188</span> <span class="mi">16324531747558707671873605114378727152000738</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="mi">17664302494165645750553234381674396726461155</span> <span class="mi">11329821313213471881023356172069963076578223</span> <span class="mi">17420708004114170496283987639981918922808988</span>  <span class="mi">4025301508682028642713745479550070150287792</span> <span class="mi">13516995862604528976910352157951268294502659</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="mi">13197381126644223748863331681581035046689048</span> <span class="mi">18134793368131211547774737770284104243998582</span>  <span class="mi">3304296884612368960093061281547555357926671</span> <span class="mi">17654343876553302292700074689920978613390384</span> <span class="mi">19965538184282119398237005639724114717256368</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">c_2</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">7467508370111086497875591641000575993385737</span>   <span class="mi">436730215933598480688770862716304678927061</span> <span class="mi">16388674389038775692052384536812272916184391</span>  <span class="mi">1544929917235051621830007372321346311674993</span> <span class="mi">20266847919326089072814025756784393554435095</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span> <span class="mi">8525400103718228392870804572553779730855209</span>  <span class="mi">6910832586632574200490719455813022347001485</span> <span class="mi">17879158289938108082881632425571195671456277</span> <span class="mi">10773037736439027909506921110474733019517450</span>  <span class="mi">6673285991052846421739430171898388311111793</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span> <span class="mi">9870026505859633975247413380429542368374340</span>  <span class="mi">3599087047295232637660012477486366289652163</span>  <span class="mi">9771908525081529326761727267151928531319243</span> <span class="mi">19335625816265272435673905591707160166566864</span> <span class="mi">15219307175745538685718076680399058971932192</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span> <span class="mi">7121095235650179073589022177762837236165521</span> <span class="mi">10051305836914620675997951100253778882475518</span> <span class="mi">14120877609199150307731361282669945615365363</span>  <span class="mi">3064435253345055470095756982744706296418025</span>   <span class="mi">126078528977194834765813221549264972548412</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="mi">18926039657432874696099563502261812215936524</span> <span class="mi">14159758827498805644159739654028640645658626</span>  <span class="mi">4643672049840979864316682883185591331924981</span> <span class="mi">20293416534996028081504808704845564317319704</span>  <span class="mi">5806383537343185356941724671128323142478351</span><span class="p">]</span>
</span></span></code></pre></div><p>We are also given the relations</p>
<p>$$\left\{\begin{aligned}
Y &amp;= f(R)^u \cdot S \cdot f(R)^v \\
C_1 &amp;= h(R)^u \cdot S \cdot h(R)^v \\
C_2 &amp;= \text{HashBase}\left(h(R)^u \cdot Y \cdot h(R)^v\right) \oplus \text{HashBase}(\mathcal{F})
\end{aligned}\right.$$</p>
<p>where $f(x) = a_0 x^4 + a_1 x^3 + ... + a_4$ with $a_i \in [0, 25]$ (not given), $h(x) = x^5 + x + 1$ and $\text{HashBase}$ is the function with given implementation. The objective is to recover $\mathcal{F}$, the flag.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">hash_base</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">m</span> <span class="o">=</span> <span class="n">M</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">_M</span> <span class="o">=</span> <span class="n">M</span><span class="p">(</span><span class="n">zero_matrix</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">			<span class="n">_M</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">M</span><span class="p">(</span><span class="n">_M</span><span class="p">)</span>
</span></span></code></pre></div><p><em>Credits: <a href="https://twitter.com/grhkm21" target="_blank" rel="nofollow">@grhkm21</a> for the challenge summary.</em></p>
<h2 id="uiuctf-2022">UIUCTF 2022<a href="#uiuctf-2022" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h3 id="asr">asr<a href="#asr" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 56/395</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>rsa</code></li>
<li>Author: @zhengdw</li>
<li>Source: <a href="https://github.com/sigpwny/UIUCTF-2022-Public/tree/main/crypto/asr"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<p>We are given $e, d$ (the public and private exponents of RSA) and the encrypted flag. It is known the largest prime factor for $p-1$ and $q-1$ is less than $2^{64}$ ($p$ and $q$ are the prime factors of the public modulus $n$). The goal is to recover the flag.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="mi">195285722677343056731308789302965842898515630705905989253864700147610471486140197351850817673117692460241696816114531352324651403853171392804745693538688912545296861525940847905313261324431856121426611991563634798757309882637947424059539232910352573618475579466190912888605860293465441434324139634261315613929473</span>
</span></span><span class="line"><span class="cl"><span class="n">ct</span> <span class="o">=</span> <span class="mi">212118183964533878687650903337696329626088379125296944148034924018434446792800531043981892206180946802424273758169180391641372690881250694674772100520951338387690486150086059888545223362117314871848416041394861399201900469160864641377209190150270559789319354306267000948644929585048244599181272990506465820030285</span>
</span></span></code></pre></div><h3 id="wringing-rings">Wringing Rings<a href="#wringing-rings" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 44/395</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>secret-sharing</code></li>
<li>Author: Spamakin</li>
<li>Source: <a href="https://github.com/sigpwny/UIUCTF-2022-Public/tree/main/crypto/wringing_rings"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<p>When connected to the server, a secret $s \in [1, 500000]$ is generated. Let $\text{f}$ be a polynomial such that</p>
<p>$$\text{f}(x) := a_9 x^9 + a_8 x^8 + ... + a_1 x + s,$$</p>
<p>where $a_1, a_2, ..., a_9 \in [1, 100000]$ are randomly generated. We are given nine of these ten values: $(1, \text{f}(1))$, $(2, \text{f}(2))$, ..., $(10, \text{f}(10))$. The objective is to find $s$.</p>
<h3 id="elliptic-clock-crypto">Elliptic Clock Crypto<a href="#elliptic-clock-crypto" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 27/395</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>dlog</code></li>
<li>Author: Husnain</li>
<li>Source: <a href="https://github.com/sigpwny/UIUCTF-2022-Public/tree/main/crypto/elliptic_clock_crypto"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<p>Define $\oplus$ operation over $\mathbb{Z}_p$ by:</p>
<p>$$(x_1, y_1) \oplus (x_2, y_2) := (x_1y_2 + y_1x_2, y_1y_2 - x_1x_2).$$</p>
<p>Let $0 \leq a, b &lt; 2^{256}$ be respectively Alice's and Bob's secret key. Let also $A = a \cdot G$, $B = b \cdot G$ ($k \cdot G = G + G + ... + G$, a sum of $k$ $G$'s). We are given $p, A, B$ and $G$. The objective is to find $S := ab \cdot G$.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="mi">62471552838526783778491264313097878073079117790686615043492079411583156507853</span>
</span></span><span class="line"><span class="cl"><span class="n">G</span> <span class="o">=</span> <span class="p">(</span><span class="mi">34510208759284660042264570994647050969649037508662054358547659196695638877343</span><span class="p">,</span> <span class="mi">4603880836195915415499609181813839155074976164846557299963454168096659979337</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="mi">929134947869102207395031929764558470992898835457519444223855594752208888786</span><span class="p">,</span><span class="mi">6062966687214232450679564356947266828438789510002221469043877962705671155351</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">B</span> <span class="o">=</span> <span class="p">(</span><span class="mi">49232075403052702050387790782794967611571247026847692455242150234019745608330</span><span class="p">,</span><span class="mi">46585435492967888378295263037933777203199027198295712697342810710712585850566</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="mom-can-we-have-aes">mom can we have AES<a href="#mom-can-we-have-aes" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 22/395</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>man-in-the-middle</code></li>
<li>Author: Random Object No.79</li>
<li>Source: <a href="https://github.com/sigpwny/UIUCTF-2022-Public/tree/main/crypto/mom_can_we_have_aes"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<div class="alert info">
  üõ†Ô∏è <strong>To-be written.</strong> This is a placeholder because I am lazy. Please read the tags, or the official source meanwhile.
</div>

<h3 id="that-crete-log">That-crete Log<a href="#that-crete-log" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 21/395</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>dlog</code></li>
<li>Author: zhengdw, Spamakin</li>
<li>Source: <a href="https://github.com/sigpwny/UIUCTF-2022-Public/tree/main/crypto/that_crete_log"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<p><div class="alert warning">
  <strong>Note.</strong> In this challenge, the prime check runs the Miller-Rabin test with bases $b = 2, 3, 5, 7, 11, 13, 17, 19, 31337$.
</div>

When connected to the server, a message $m := \text{flag} \oplus \text{token}$ is defined and $\text{token}$ is given. Repeat the below procedures five times:</p>
<ol>
<li>We send $q_1, q_2, ...$ to the server. $q_i$'s needs to be <em>primes</em> with $\text{max}(q_i) \geq 2^{512}$. The product, $p = q_1 \cdot q_2 \cdot ...$ needs to be a prime and $2^{512} \leq p \leq 2^{1024}$. Note that the prime $p$ computed should not be used in a previous round.</li>
<li>The server generates a random $0 \leq x &lt; p$ and sends it to us.</li>
<li>The server computes $y = x^m\ \text{mod}\ p$ and sends it to us.</li>
</ol>
<p>The goal is to recover $\text{flag}$.</p>
<h3 id="bro-key-n">Bro-key-n<a href="#bro-key-n" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 14/395</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>rsa</code></li>
<li>Author: Husnain</li>
<li>Source: <a href="https://github.com/sigpwny/UIUCTF-2022-Public/tree/main/crypto/bro-key-n"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<p>We are given a partially redacted private key file (in <code>.pem</code>). The objective is to recover the private key.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">-----BEGIN RSA PRIVATE KEY-----
</span></span><span class="line"><span class="cl">MIIJJAIBAAKCAgASUWUVXgOvRLJkI77YJ6BlG5t6en55ysW40HpawMJb9bTyWMIn
</span></span><span class="line"><span class="cl">NIkWpL7+swa+eddajk+sL32Fkdf38eUAbq/y0y6T/LGlDLW9RJqEhAxx+fC62Zmu
</span></span><span class="line"><span class="cl">7tUA3DK3CS0LAhrd4oWdU8YE9LFhOID7StpmxaGdoFi8emZGuTXE0ooyG60KObs4
</span></span><span class="line"><span class="cl">dGV3Xbwq1xhM4iG9Drw94PwOlXS5UqDNfCcY0GlrorKsUSJwjNlkPIoos5FtR7KP
</span></span><span class="line"><span class="cl">Rsau1+kd8aeCeAObkZciPRqLDojy3cVXZqKO6qpXHk2qfyEy1AKAFaNyt4sEt3WY
</span></span><span class="line"><span class="cl">ex9qQg9a2W0w12zD01QZnJaKhTkMhdThLHrrBQsbBPQwsjcl7FwT0DQBOPZsas+k
</span></span><span class="line"><span class="cl">WUYbTr++WvKy1pB7j6eC4WUlFFKf3zQ2Z+aHXX0UmPPYDLdlJFgLbyrwEULxW7EO
</span></span><span class="line"><span class="cl">kTZt2IL3c4+ywkK0F6Ty4M+lzW/Wtj0ZcpAd9pudXEgXeCSUMJ6AlU0ckOl1WSpH
</span></span><span class="line"><span class="cl">zORHYZ9aPVt2Ertme7sU4XdJZLFOqXzqN1+Z96GdpUOptOmpeL2/sv/4816OlZdH
</span></span><span class="line"><span class="cl">OIjLErLv73CNhxSJ592zymSZesb0rSnH4T01ResFai6HLOMvE99ezt0lt73XwyRk
</span></span><span class="line"><span class="cl">MGRm0uW35Ir5rOioHkKVgas3dGjH8DED73WOrvt5p0BImSb9jyYzT9odZQIDAQAB
</span></span><span class="line"><span class="cl">AoIB/0WfF5MewOJnN59kPPdRpU6kn0vkRtCg4N6PgntsJ0tdlV+F+mkIRALMJyHn
</span></span><span class="line"><span class="cl">TrqmXNzSB/9ogKwqpa68tKXwDM______________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________YM4i/wJBudIGNGxwJRfOR9HUI2G/wchfC1772bxdFev5+0YM
</span></span><span class="line"><span class="cl">PiuBRnypiaHcf2/AAOmDMZJFyrTqrfy8jmxfdwKCAQAMVay1pGR15Pyz/AEqJvO4
</span></span><span class="line"><span class="cl">lrw09/BHA1xhDTc5uYzlChRuxJEn5ehmc1Lgbawr+jciSkfCnNkEueQYv0+EhPYF
</span></span><span class="line"><span class="cl">lJBsztrCJX3hzcVEU7qJLR4aAP6Px+G0Fd/kxQVbyrCvCKM1ptmpNPqYZE2IR5Ri
</span></span><span class="line"><span class="cl">Fzj4eD7rl1qEaBNIEdNs2VRMmsRwhrqIZcgRVbzcOf5cE3agelmTT/JeGFVFF+Ri
</span></span><span class="line"><span class="cl">knxvhVcSScPKgsfdhpFwcYbeLqbLac7ZQcb1+Qz7XU______________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">________________________________________________________________
</span></span><span class="line"><span class="cl">______________________________________________________
</span></span><span class="line"><span class="cl">-----END RSA PRIVATE KEY-----
</span></span></code></pre></div><h2 id="corctf-2022">corCTF 2022<a href="#corctf-2022" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h3 id="tadpole">tadpole<a href="#tadpole" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 262/978</li>
<li>Difficulty: ‚≠ê</li>
<li>Tags: <code>lcg</code></li>
<li>Author: <a href="https://twitter.com/willwam845" target="_blank" rel="nofollow">@willwam845</a></li>
<li>Source: <a href="https://github.com/Crusaders-of-Rust/corCTF-2022-public-challenge-archive/tree/master/crypto/tadpole"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<p>Let $p$ be a secret prime. We are given the LCG $x_{i+1} = a \cdot x_i + b\ \text{mod}\ p$ with $x_0 = 13337$. We are given $a, b, x_1$ and $x_2$. The objective is to recover $p$.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="mi">7904681699700731398014734140051852539595806699214201704996640156917030632322659247608208994194840235514587046537148300460058962186080655943804500265088604049870276334033409850015651340974377752209566343260236095126079946537115705967909011471361527517536608234561184232228641232031445095605905800675590040729</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="mi">16276123569406561065481657801212560821090379741833362117064628294630146690975007397274564762071994252430611109538448562330994891595998956302505598671868738461167036849263008183930906881997588494441620076078667417828837239330797541019054284027314592321358909551790371565447129285494856611848340083448507929914</span>
</span></span><span class="line"><span class="cl"><span class="n">x1</span> <span class="o">=</span> <span class="mi">52926479498929750044944450970022719277159248911867759992013481774911823190312079157541825423250020665153531167070545276398175787563829542933394906173782217836783565154742242903537987641141610732290449825336292689379131350316072955262065808081711030055841841406454441280215520187695501682433223390854051207100</span>
</span></span><span class="line"><span class="cl"><span class="n">x2</span> <span class="o">=</span> <span class="mi">65547980822717919074991147621216627925232640728803041128894527143789172030203362875900831296779973655308791371486165705460914922484808659375299900737148358509883361622225046840011907835671004704947767016613458301891561318029714351016012481309583866288472491239769813776978841785764693181622804797533665463949</span>
</span></span></code></pre></div><h3 id="luckyguess">luckyguess<a href="#luckyguess" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 150/978</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>lcg</code></li>
<li>Author: <a href="https://twitter.com/willwam845" target="_blank" rel="nofollow">@willwam845</a></li>
<li>Source: <a href="https://github.com/Crusaders-of-Rust/corCTF-2022-public-challenge-archive/tree/master/crypto/luckyguess"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<p>Let $p = 2^{521} - 1$ and $0 \leq a, b \leq 2^{521} - 1$ be two given numbers. Define the LCG by</p>
<p>$$x_{i+1} = a \cdot x_i + b\ \text{mod}\ p.$$</p>
<p>We are asked to give $x, y$. After that, $0 \leq r &lt; 2^{20}$ is randomly generated. We will be given the flag if $x_0 = x$ and $x_r = y$.</p>
<h3 id="exchanged">exchanged<a href="#exchanged" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 94/978</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>math</code>, <code>lcg</code></li>
<li>Author: <a href="https://twitter.com/willwam845" target="_blank" rel="nofollow">@willwam845</a></li>
<li>Source: <a href="https://github.com/Crusaders-of-Rust/corCTF-2022-public-challenge-archive/tree/master/crypto/exchanged"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<p>We are given LCG parameters $p, a, b$ and the seed $x_0$. We are also given $M = x_m, N = x_n$ where $0 \leq m, n &lt; p$. The goal is to find $x_{m+n}$.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="mi">142031099029600410074857132245225995042133907174773113428619183542435280521982827908693709967174895346639746117298434598064909317599742674575275028013832939859778024440938714958561951083471842387497181706195805000375824824688304388119038321175358608957437054475286727321806430701729130544065757189542110211847</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="mi">118090659823726532118457015460393501353551257181901234830868805299366725758012165845638977878322282762929021570278435511082796994178870962500440332899721398426189888618654464380851733007647761349698218193871563040337609238025971961729401986114391957513108804134147523112841191971447906617102015540889276702905</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="mi">57950149871006152434673020146375196555892205626959676251724410016184935825712508121123309360222777559827093965468965268147720027647842492655071706063669328135127202250040935414836416360350924218462798003878266563205893267635176851677889275076622582116735064397099811275094311855310291134721254402338711815917</span>
</span></span><span class="line"><span class="cl"><span class="n">x0</span> <span class="o">=</span> <span class="mi">35701581351111604654913348867007078339402691770410368133625030427202791057766853103510974089592411344065769957370802617378495161837442670157827768677411871042401500071366317439681461271483880858007469502453361706001973441902698612564888892738986839322028935932565866492285930239231621460094395437739108335763</span>
</span></span><span class="line"><span class="cl"><span class="n">M</span> <span class="o">=</span> <span class="mi">27055699502555282613679205402426727304359886337822675232856463708560598772666004663660052528328692282077165590259495090388216629240053397041429587052611133163886938471164829537589711598253115270161090086180001501227164925199272064309777701514693535680247097233110602308486009083412543129797852747444605837628</span>
</span></span><span class="line"><span class="cl"><span class="n">N</span> <span class="o">=</span> <span class="mi">132178320037112737009726468367471898242195923568158234871773607005424001152694338993978703689030147215843125095282272730052868843423659165019475476788785426513627877574198334376818205173785102362137159225281640301442638067549414775820844039938433118586793458501467811405967773962568614238426424346683176754273</span>
</span></span></code></pre></div><h3 id="hide">hidE<a href="#hide" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 88/978</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>rsa</code></li>
<li>Author: quintec</li>
<li>Source: <a href="https://github.com/Crusaders-of-Rust/corCTF-2022-public-challenge-archive/tree/master/crypto/hidE"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<p>When connected to the server, a RSA modulus $n$ is generated. The seed for Python's <code>random</code> package is set to be <code>int(time.time())</code>. We are given $n$ and two methods (we can use these methods as much as we would), which encrypts either the flag, or a user-supplied message using the first $e$ generated by <code>random.randint(1, n)</code> which is coprime with $\varphi(n)$, and sends to the player.</p>
<p>The objective is to recover the flag.</p>
<h3 id="generous">generous<a href="#generous" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 49/978</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>okamoto-uchiyama</code></li>
<li>Author: qoprime</li>
<li>Source: <a href="https://github.com/Crusaders-of-Rust/corCTF-2022-public-challenge-archive/tree/master/crypto/generous"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<p>The below defines the <a href="https://link.springer.com/content/pdf/10.1007/BFb0054135.pdf"
   
   target="_blank" rel="noopener noreferrer" >Okamoto-Uchiyama cryptosystem</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg>.</p>
<p>Let $p$ and $q$ be two primes and $n = p^2q$. Define $2 \leq g &lt; n$ and $h = g^n\ \text{mod}\ n$. The public and private keys are given by $(n, g, h)$ and $(g, p, q)$ respectively.</p>
<p>The encryption function $c := \text{Enc}(m)$ is given by:</p>
<ol>
<li>Generates $1 \leq r &lt; n$ randomly.</li>
<li>Computes $c = g^m \cdot h^r\ \text{mod}\ n$.</li>
</ol>
<p>The decryption function $m := \text{Dec}(c)$ is given by:</p>
<ol>
<li>Computes $a = [(c^{p-1}\ \text{mod}\ p^2) - 1] / p$ and $b = [(g^{p-1}\ \text{mod}\ p^2) - 1] / p$.</li>
<li>Computes $m = a \cdot b^{-1}\ \text{mod}\ p$.</li>
</ol>
<p>When connected to the server, two 512-bit primes $p, q$ are generated and $g$ such that $g^{p-1} \not\equiv 1\ (\text{mod}\ p^2)$. We are given $(n, g, h)$ and the encrypted flag $\text{Enc}(\text{flag})$. After that, we are given the oracle which computes $\text{Dec}(c)\ \text{mod}\ 2$ for user-supplied $c$, for an arbitrary number of times.</p>
<p>The objective is to recover $\text{flag}$.</p>
<h3 id="leapfrog">leapfrog<a href="#leapfrog" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 36/978</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>lcg</code></li>
<li>Author: <a href="https://twitter.com/willwam845" target="_blank" rel="nofollow">@willwam845</a></li>
<li>Source: <a href="https://github.com/Crusaders-of-Rust/corCTF-2022-public-challenge-archive/tree/master/crypto/leapfrog"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<p>We are given the $i$-th output from an unknown LCG (neither $a, b$ nor $p$ are given), with $i = 0, 5, 8, 31, 44, 68, 74, 84, 93, 100, 104, 123$. The goal is to recover $a, b$ and $p$.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">x_0</span>   <span class="o">=</span> <span class="mi">26242498579536691811055981149948736081413123636643477706015419836101346754443</span>
</span></span><span class="line"><span class="cl"><span class="n">x_5</span>   <span class="o">=</span> <span class="mi">30320412755241177141099565765265147075632060183801443609889236855980299685595</span>
</span></span><span class="line"><span class="cl"><span class="n">x_8</span>   <span class="o">=</span> <span class="mi">65684356693401962957802832810273549345608027337432965824937963429120291339333</span>
</span></span><span class="line"><span class="cl"><span class="n">x_31</span>  <span class="o">=</span> <span class="mi">15025547765549333168957368149177848577882555487889680742466312084547650972663</span>
</span></span><span class="line"><span class="cl"><span class="n">x_44</span>  <span class="o">=</span> <span class="mi">46764069432060214735440855620792051531943268335710103593983788232446614161424</span>
</span></span><span class="line"><span class="cl"><span class="n">x_68</span>  <span class="o">=</span> <span class="mi">71575544531523096893697176151110271985899529970263634996534766185719951232899</span>
</span></span><span class="line"><span class="cl"><span class="n">x_74</span>  <span class="o">=</span> <span class="mi">8149547548198503668415702507621754973088994278880874813606458793607866713778</span>
</span></span><span class="line"><span class="cl"><span class="n">x_84</span>  <span class="o">=</span> <span class="mi">12081871161483608517505346339140143493132928051760353815508503241747142024697</span>
</span></span><span class="line"><span class="cl"><span class="n">x_93</span>  <span class="o">=</span> <span class="mi">65627056932006241674763356339068429188278123434638526706264676467885955099667</span>
</span></span><span class="line"><span class="cl"><span class="n">x_100</span> <span class="o">=</span> <span class="mi">23413741607307309476964696379608864503970503243566103692132654387385869400762</span>
</span></span><span class="line"><span class="cl"><span class="n">x_104</span> <span class="o">=</span> <span class="mi">56014408298982744092873649879675961526790332954773022900206888891912862484806</span>
</span></span><span class="line"><span class="cl"><span class="n">x_123</span> <span class="o">=</span> <span class="mi">77000766146189604405769394813422399327596415228762086351262010618717119973525</span>
</span></span><span class="line"><span class="cl"><span class="n">x_139</span> <span class="o">=</span> <span class="mi">14589246063765426640159853561271509992635998018136452450026806673980229327448</span>
</span></span></code></pre></div><h3 id="corrupted-curves">corrupted-curves<a href="#corrupted-curves" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 20/978</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>ecc</code></li>
<li>Author: qoprime</li>
<li>Source: <a href="https://github.com/Crusaders-of-Rust/corCTF-2022-public-challenge-archive/tree/master/crypto/corruptedcurves"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<p>Denote $x_0$ be a secret (the flag).</p>
<p>When connected to the server, a 512-bit prime $p$ and $0 \leq a, b &lt; 2^{384}$ are generated such that there exists $y_0$ such that ${y_0}^2 \equiv {x_0}^3 + a \cdot x_0 + b\ (\text{mod}\ p)$.</p>
<p>We can call the below oracle $\mathcal{O}(x_1)$, where $0 \leq x_1 &lt; p$, as long as $\text{count} &lt; 64$. Initialize $S = \phi$:</p>
<ol>
<li>Generate a 64-bit $e$.</li>
<li>If $x \in S$ or $x &lt; 2^{384}$ or $x &gt; p - 2^{384}$, abort.</li>
<li>Define the curve $C: y^2 \equiv x^3 + (a \oplus e) \cdot x + (b \oplus e)\ (\text{mod}\ p)$.</li>
<li>If there exists a point $P$ such that its $x$-coordinate equals $x_1$, returns its $y$-coordinate and set $\text{count} \leftarrow \text{count} + 1$ and set $S \leftarrow S \cup \{x_1\}$.</li>
</ol>
<p>The goal is to recover $x_0$.</p>
<h3 id="threetreasures">threetreasures<a href="#threetreasures" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 19/978</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>ecc</code></li>
<li>Author: qoprime</li>
<li>Source: <a href="https://github.com/Crusaders-of-Rust/corCTF-2022-public-challenge-archive/tree/master/crypto/threetreasures"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<div class="alert info">
  <strong>Note:</strong> the flag has the format with <code>corctf{...}</code>.
</div>

<p>Given that the flag is 375 bits long and it is broken evenly into three parts: $a, b, c$ ($a, b$ and $c$ consist of the first 125 bits, subsequent 125 bits and the remaining bits respectively). Let $p$ be a 512-bit prime and denote the elliptic curve $\mathcal{C}$ by</p>
<p>$$\mathcal{C}: y^2 = x^3 + ax + b\ (\text{mod}\ p).$$</p>
<p>Moreover, let $G \in \mathcal{C}$ such that $3G = O$. Let also $q$ be another 512-bit prime, $n = pq$ and $\text{Enc}(c) := \text{Pad}(c)^{65537}\ \text{mod}\ n$. We are given $n$, $\text{Enc}(c)$ and $G$. The goal is to recover $a, b$ and $c$.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">n</span>      <span class="o">=</span> <span class="mi">97915144495462666300795364589570761584322186881492143950078938328867290046424857019504657598883431857075772605985768551863478086544857915637724181292135280539943713583281151707224031808445390796342632369109562433275679473233398168787639940620683354458292117457239552762694657810883738834935391913698852811737</span>
</span></span><span class="line"><span class="cl"><span class="n">Enc</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">=</span> <span class="mi">20363336204536918055183609604474634074539942561101208682977506918349108499764147141944713060658857301108876346227077713201766486360148051069618774935469969057808945271860025712869868421279488925632657486125211168314387620225601572070169746014988350688548088791906161773656057212229972967244998930356157725393</span>
</span></span><span class="line"><span class="cl"><span class="n">G</span>      <span class="o">=</span> <span class="p">(</span><span class="mi">3115938227771961657567351113281194074601897467086373590156577019504528350118731801249444974253028485083440228959842232653488953448859690520619223338133881</span><span class="p">,</span> <span class="mi">2665631524518629436093690344927156713668794128141943350227439039472817541262750706395352700109556004195261826476428128993836186741129487842876154876730189</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="corrupted-curves-">corrupted-curves+ üî•<a href="#corrupted-curves-" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 15/978</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>ecc</code></li>
<li>Author: qoprime</li>
<li>Source: <a href="https://github.com/Crusaders-of-Rust/corCTF-2022-public-challenge-archive/tree/master/crypto/corruptedcurvesplus"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<div class="alert info">
  <strong>Note.</strong> This challenge is similar to <em>corrupted-curves</em>, except that the upper limit of $\text{count}$ is changed, and it no longer accepts user-supplied $x_1$.
</div>

<p>Denote $x_0$ be a secret (the flag).</p>
<p>When connected to the server, a 512-bit prime $p$ and $0 \leq a, b &lt; 2^{384}$ are generated such that there exists $y_0$ such that ${y_0}^2 \equiv {x_0}^3 + a \cdot x_0 + b\ (\text{mod}\ p)$.</p>
<p>We can call the below oracle $\mathcal{O}$ as long as $\text{count} &lt; 2022$. Initialize $S = \phi$:</p>
<ol>
<li>Generate a 64-bit $e$ and $2 \leq x_1 &lt; p$.</li>
<li>If $x \in S$ or $x &lt; 2^{384}$ or $x &gt; p - 2^{384}$, abort.</li>
<li>Define the curve $C: y^2 \equiv x^3 + (a \oplus e) \cdot x + (b \oplus e)\ (\text{mod}\ p)$.</li>
<li>If there exists a point $P$ such that its $x$-coordinate equals $x_1$, returns its $y$-coordinate and set $\text{count} \leftarrow \text{count} + 1$ and set $S \leftarrow S \cup \{x_1\}$.</li>
</ol>
<p>The goal is to recover $x_0$.</p>
<h3 id="rlfsr">rlfsr<a href="#rlfsr" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 14/978</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>lfsr</code></li>
<li>Author: <a href="https://twitter.com/willwam845" target="_blank" rel="nofollow">@willwam845</a></li>
<li>Source: <a href="https://github.com/Crusaders-of-Rust/corCTF-2022-public-challenge-archive/tree/master/crypto/rlfsr"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<p>Let $R$ be a known 128-bit LFSR. We are given $15104 = 128 \times 118$ output bits, in a way that the first 128 bits are shuffled, the subsequent 128 bits are shuffled, etc. The goal is to recover the initial values of the LFSR.</p>
<h3 id="d3s-">D3S üî•<a href="#d3s-" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 1/978</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>des</code></li>
<li>Author: pot</li>
<li>Source: <a href="https://github.com/Crusaders-of-Rust/corCTF-2022-public-challenge-archive/tree/master/crypto/D3S"
   
   target="_blank" rel="noopener noreferrer" >Official Repository</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg></li>
</ul>
<p>We are given a Feistel cipher implementation, where the message space, ciphertext space, key space are all 54 trits (i.e., $\mathcal{M} = \mathcal{C} = \mathcal{K} = \mathbb{Z}_3^{54}$). We are given $3^9$ message-ciphertext pairs and the objective is to recover the key.</p>
<h2 id="maplectf-2022">MapleCTF 2022<a href="#maplectf-2022" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h3 id="brsaby">brsaby<a href="#brsaby" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 166/618</li>
<li>Difficulty: ‚≠ê</li>
<li>Tags: <code>rsa</code></li>
<li>Author: @zhengdw</li>
</ul>
<p>Let $n = pq$ be the public modulus of RSA. Given $n$, $e = 65537$, $c$ (the encrypted flag) and $h := p^4 - q^3$, the goal is to recover the flag.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">134049493752540418773065530143076126635445393203564220282068096099004424462500237164471467694656029850418188898633676218589793310992660499303428013844428562884017060683631593831476483842609871002334562252352992475614866865974358629573630911411844296034168928705543095499675521713617474013653359243644060206273</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="mi">110102068225857249266317472106969433365215711224747391469423595211113736904624336819727052620230568210114877696850912188601083627767033947343144894754967713943008865252845680364312307500261885582194931443807130970738278351511194280306132200450370953028936210150584164591049215506801271155664701637982648648103</span>
</span></span><span class="line"><span class="cl"><span class="n">h</span> <span class="o">=</span> <span class="mi">20172108941900018394284473561352944005622395962339433571299361593905788672168045532232800087202397752219344139121724243795336720758440190310585711170413893436453612554118877290447992615675653923905848685604450760355869000618609981902108252359560311702189784994512308860998406787788757988995958832480986292341328962694760728098818022660328680140765730787944534645101122046301434298592063643437213380371824613660631584008711686240103416385845390125711005079231226631612790119628517438076962856020578250598417110996970171029663545716229258911304933901864735285384197017662727621049720992964441567484821110407612560423282</span>
</span></span></code></pre></div><h3 id="jwt">jwt<a href="#jwt" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 79/618</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>ecdsa</code></li>
<li>Author: @vEvergarden</li>
</ul>
<p>This challenge implements ECDSA with a fixed private key $x$. However, for every signature generated, the nonce $k$ is always set to be $x$. The goal is to recover $x$.</p>
<h3 id="spiral-baby">Spiral-baby<a href="#spiral-baby" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 57/618</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>block cipher</code></li>
<li>Author: @vEvergarden</li>
</ul>
<p>The challenge defines a new block cipher called <em>Spiral</em>:</p>



  <div class="collapsable-code">
    <input id="539784612" type="checkbox" checked />
    <label for="539784612">
      <span class="collapsable-code__language">python</span>
      <span class="collapsable-code__title">Spiral</span>
      <span class="collapsable-code__toggle" data-label-expand="[‚ñ≥]" data-label-collapse="[‚ñΩ]"></span>
    </label>
    <pre class="language-python" ><code>
#
# Util functions
#

# rotate a 4x4 matrix clockwise
def spiralRight(matrix):
    right = []
    for j in range(4):
        for i in range(3, -1, -1):
            right.append(matrix[i][j])
    return bytes2matrix(right)


# rotate a 4x4 matrix counterclockwise
def spiralLeft(matrix):
    left = []
    for j in range(3, -1, -1):
        for i in range(4):
            left.append(matrix[i][j])
    return bytes2matrix(left)


# convert bytes to 4x4 matrix
def bytes2matrix(bytes):
    return [list(bytes[i : i &#43; 4]) for i in range(0, len(bytes), 4)]


# convert 4x4 matrix to bytes
def matrix2bytes(matrix):
    return bytes(sum(matrix, []))

SBOX = [184, 79, 76, 49, 237, 28, 54, 183, 106, 24, 192, 7, 43, 111, 175, 44, 46, 199, 182, 115, 83, 227, 61, 230, 6, 57, 165, 137, 58, 14, 94, 217, 66, 120, 53, 142, 29, 150, 103, 75, 186, 39, 31, 196, 18, 207, 244, 16, 213, 243, 114, 251, 96, 4, 138, 197, 10, 176, 157, 91, 238, 155, 254, 71, 86, 37, 130, 12, 52, 162, 220, 56, 88, 188, 27, 208, 25, 51, 172, 141, 168, 253, 85, 193, 90, 35, 95, 105, 200, 127, 247, 21, 93, 67, 13, 235, 84, 190, 225, 119, 189, 81, 250, 117, 231, 50, 179, 22, 223, 26, 228, 132, 139, 166, 210, 23, 64, 108, 212, 201, 99, 218, 160, 240, 129, 224, 233, 242, 159, 47, 126, 125, 146, 229, 0, 252, 161, 98, 30, 63, 239, 164, 36, 80, 151, 245, 38, 107, 3, 65, 73, 204, 8, 205, 82, 78, 173, 112, 219, 136, 123, 149, 118, 32, 215, 163, 74, 134, 248, 68, 110, 45, 59, 145, 178, 156, 100, 177, 221, 2, 92, 20, 40, 144, 101, 140, 169, 116, 143, 202, 1, 113, 209, 104, 133, 128, 70, 89, 216, 147, 122, 131, 9, 249, 121, 109, 191, 77, 124, 246, 55, 198, 187, 185, 17, 60, 180, 203, 19, 158, 97, 206, 148, 5, 87, 170, 236, 222, 194, 15, 214, 241, 211, 234, 42, 41, 153, 62, 102, 152, 69, 181, 34, 48, 226, 11, 195, 154, 174, 167, 135, 232, 72, 171, 33]

SPIRAL = [
    [1, 19, 22, 23],
    [166, 169, 173, 31],
    [149, 212, 176, 38],
    [134, 94, 59, 47],
]

#
# The Spiral block cipher
#

class Spiral:
    def __init__(self, key, rounds=4):
        self.rounds = rounds
        self.keys = [bytes2matrix(key)]
        self.BLOCK_SIZE = 16

        for i in range(rounds):
            self.keys.append(spiralLeft(self.keys[-1]))

    def encrypt(self, plaintext):
        if len(plaintext) % self.BLOCK_SIZE != 0:
            padding = self.BLOCK_SIZE - len(plaintext) % self.BLOCK_SIZE
            plaintext &#43;= bytes([padding] * padding)

        ciphertext = b&#34;&#34;
        for i in range(0, len(plaintext), 16):
            ciphertext &#43;= self.encrypt_block(plaintext[i : i &#43; 16])
        return ciphertext

    def encrypt_block(self, plaintext):
        self.state = bytes2matrix(plaintext)
        self.add_key(0)

        for i in range(1, self.rounds):
            self.substitute()
            self.rotate()
            self.mix()
            self.add_key(i)

        self.substitute()
        self.rotate()
        self.add_key(self.rounds)

        return matrix2bytes(self.state)

    def add_key(self, idx):
        for i in range(4):
            for j in range(4):
                self.state[i][j] = (self.state[i][j] &#43; self.keys[idx][i][j]) % 255

    def substitute(self):
        for i in range(4):
            for j in range(4):
                self.state[i][j] = SBOX[self.state[i][j]]

    def rotate(self):
        self.state = spiralRight(self.state)

    def mix(self):
        out = [[0 for _ in range(4)] for _ in range(4)]
        for i in range(4):
            for j in range(4):
                for k in range(4):
                    out[i][j] &#43;= SPIRAL[i][k] * self.state[k][j]
                out[i][j] %= 255

        self.state = out
</code></pre>
  </div>


<p>When connected to the server, a 16-byte key is randomly generated and we are allowed to encrypt</p>
<ul>
<li>the flag, and</li>
<li>or arbitrary message,</li>
</ul>
<p>using <em>Spiral with one round</em>, as much as we could. The goal is to recover the flag.</p>
<h3 id="qotp-real">qotp-real<a href="#qotp-real" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 27/618</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>rng</code></li>
<li>Author: @zhengdw</li>
</ul>
<div class="alert info">
  üõ†Ô∏è <strong>To-be written.</strong> This is a placeholder because I am lazy. Please read the tags, or the official source meanwhile.
</div>

<h3 id="e000p">e000p<a href="#e000p" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 18/618</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>ec</code></li>
<li>Author: @zhengdw</li>
</ul>
<p>Let $\mathcal{C}$ be the Edwards curve <a href="https://neuromancer.sk/std/other/Curve41417"
   
   target="_blank" rel="noopener noreferrer" >Curve41417</a><svg t="1713426496023" style="margin: 0 0 0 5px;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8864" width="10" height="10">
    <path d="M1001.627381 394.106435a44.521739 44.521739 0 1 1-88.598261 0V208.228174l-398.914783 398.914783a54.049391 54.049391 0 1 1-76.577391-76.310261l397.579131-397.490087h-182.984348a44.78887 44.78887 0 1 1 0-89.043479h298.740869c1.335652 0 2.226087 0.534261 3.561739 0.623305s1.78087-0.623304 2.671305-0.623305a40.069565 40.069565 0 0 1 27.158261 11.620174c1.157565 0.667826 2.226087 1.513739 3.116521 2.448696 0.890435 0.979478 1.78087 2.092522 2.671305 3.161043a41.360696 41.360696 0 0 1 11.575652 27.158261c0 0.979478-0.445217 1.825391-0.445218 2.80487s0.445217 2.359652 0.445218 3.650783v298.963478zM111.192598 934.956522h712.347826v-400.695652h89.043479v400.695652a89.043478 89.043478 0 0 1-89.043479 89.043478H111.192598a89.043478 89.043478 0 0 1-89.043478-89.043478V222.608696a89.043478 89.043478 0 0 1 89.043478-89.043479h400.695652v89.043479H111.192598v712.347826z" fill="#666666" p-id="8865"></path>
</svg>, $G \in \mathcal{C}$ be the generator and $n$ be its order. Define $x := \text{FLAG}^{-1}\ \text{mod}\ n$. Let also $h = x \land \text{MASK}$ ($\land$ is the bitwise AND operator) and $P = x \cdot G$.</p>
<p>We are given $\text{MASK}$, $P$ and $h$, the goal is to recover $\text{FLAG}$.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">MASK</span> <span class="o">=</span> <span class="mh">0xfffffffffffffffffff800001ffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffff800001fff</span>
</span></span><span class="line"><span class="cl"><span class="n">P</span> <span class="o">=</span> <span class="p">(</span><span class="mi">29389900956614406804195679733048238721927197300216785144586024378999988819550861039522005309555174206184334563744077143526515</span><span class="p">,</span> <span class="mi">35393890305755889860162885313105764163711685229222879079392595581125504924571957049674311023316022028491019878405896203357959</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">h</span> <span class="o">=</span> <span class="mi">323811241263249292936728039512527915123919581362694022248295847200852329370976362254362732891461683020125008591836401372097</span>
</span></span></code></pre></div><h3 id="spiral-">Spiral üî•<a href="#spiral-" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 9/618</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>block cipher</code></li>
<li>Author: @vEvergarden</li>
</ul>
<div class="alert warning">
  <strong>Note.</strong> The challenge uses the same cipher given in <em>Spiral-baby</em>. However, the cipher is now of four rounds instead of one.
</div>

<p>When connected to the server, a 16-byte key is randomly generated and we are allowed to encrypt</p>
<ul>
<li>the flag, and</li>
<li>or arbitrary message,</li>
</ul>
<p>using <em>Spiral with four rounds</em>, as much as we could. The goal is to recover the flag.</p>
<h3 id="clipper-chip">clipper chip<a href="#clipper-chip" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 2/618</li>
<li>Difficulty: ‚ùì</li>
<li>Tags: ‚ùì</li>
<li>Author: @xal</li>
</ul>
<div class="alert warning">
  <strong>Needs more information.</strong> I am not totally clear about this challenge. Please let me know if you have a better picture on this one!
</div>

<h2 id="balsnctf-2022">BalsnCTF 2022<a href="#balsnctf-2022" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h3 id="yet-another-rsa-with-hint">Yet another RSA with hint<a href="#yet-another-rsa-with-hint" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 38/584</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>rsa</code></li>
<li>Author: @utaha</li>
</ul>
<p>Let $(n, e)$ be a RSA public key ($n$ being 1024 bits and $e = 65537$), and $c$ be the encrypted flag. We are also given $\text{hint} := (b_2, b_3, ..., b_{199})$, where $b_k$ is the sum of digits of $p$ (a prime factor of $n$) in base $k$. The objective is to recover the flag.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">69769370315605399620499157110259161770226204413410714287546175640222894393734656823609842094208000324903785445480970937467772043771047139468214623293799193606693151204028152125827120312591965423568920046988483517193159267137262989786922993050699199470525597334312901558499603311835177928669168435353736304603</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="mi">44629586340631092032969036077439025547731549046317830052768219747251144452428756243443530079705365300095620187777995163429306743725384004785137984724398460770780400852341911649904759816676765406154144761671142475150796245779492784073799771022568183264838096756108860913879311490014711507384458820460700533977</span>
</span></span><span class="line"><span class="cl"><span class="n">hint</span> <span class="o">=</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">371</span><span class="p">,</span> <span class="mi">421</span><span class="p">,</span> <span class="mi">519</span><span class="p">,</span> <span class="mi">569</span><span class="p">,</span> <span class="mi">583</span><span class="p">,</span> <span class="mi">621</span><span class="p">,</span> <span class="mi">746</span><span class="p">,</span> <span class="mi">679</span><span class="p">,</span> <span class="mi">787</span><span class="p">,</span> <span class="mi">821</span><span class="p">,</span> <span class="mi">880</span><span class="p">,</span> <span class="mi">919</span><span class="p">,</span> <span class="mi">899</span><span class="p">,</span> <span class="mi">1021</span><span class="p">,</span> <span class="mi">1038</span><span class="p">,</span> <span class="mi">1151</span><span class="p">,</span> <span class="mi">1133</span><span class="p">,</span> <span class="mi">1229</span><span class="p">,</span> <span class="mi">1157</span><span class="p">,</span> <span class="mi">1205</span><span class="p">,</span> <span class="mi">1237</span><span class="p">,</span> <span class="mi">1301</span><span class="p">,</span> <span class="mi">1399</span><span class="p">,</span> <span class="mi">1335</span><span class="p">,</span> <span class="mi">1574</span><span class="p">,</span> <span class="mi">1549</span><span class="p">,</span> <span class="mi">1495</span><span class="p">,</span> <span class="mi">1469</span><span class="p">,</span> <span class="mi">1564</span><span class="p">,</span> <span class="mi">1709</span><span class="p">,</span> <span class="mi">1634</span><span class="p">,</span> <span class="mi">1633</span><span class="p">,</span> <span class="mi">1759</span><span class="p">,</span> <span class="mi">1673</span><span class="p">,</span> <span class="mi">1794</span><span class="p">,</span> <span class="mi">1817</span><span class="p">,</span> <span class="mi">1790</span><span class="p">,</span> <span class="mi">1989</span><span class="p">,</span> <span class="mi">1971</span><span class="p">,</span> <span class="mi">2081</span><span class="p">,</span> <span class="mi">2058</span><span class="p">,</span> <span class="mi">2041</span><span class="p">,</span> <span class="mi">2114</span><span class="p">,</span> <span class="mi">2065</span><span class="p">,</span> <span class="mi">2239</span><span class="p">,</span> <span class="mi">2381</span><span class="p">,</span> <span class="mi">2193</span><span class="p">,</span> <span class="mi">2199</span><span class="p">,</span> <span class="mi">2432</span><span class="p">,</span> <span class="mi">2297</span><span class="p">,</span> <span class="mi">2500</span><span class="p">,</span> <span class="mi">2519</span><span class="p">,</span> <span class="mi">2459</span><span class="p">,</span> <span class="mi">2501</span><span class="p">,</span> <span class="mi">2558</span><span class="p">,</span> <span class="mi">2597</span><span class="p">,</span> <span class="mi">2647</span><span class="p">,</span> <span class="mi">2609</span><span class="p">,</span> <span class="mi">2750</span><span class="p">,</span> <span class="mi">2711</span><span class="p">,</span> <span class="mi">2627</span><span class="p">,</span> <span class="mi">2765</span><span class="p">,</span> <span class="mi">2609</span><span class="p">,</span> <span class="mi">3053</span><span class="p">,</span> <span class="mi">2931</span><span class="p">,</span> <span class="mi">3333</span><span class="p">,</span> <span class="mi">2939</span><span class="p">,</span> <span class="mi">2809</span><span class="p">,</span> <span class="mi">2843</span><span class="p">,</span> <span class="mi">2789</span><span class="p">,</span> <span class="mi">3002</span><span class="p">,</span> <span class="mi">3089</span><span class="p">,</span> <span class="mi">2924</span><span class="p">,</span> <span class="mi">3185</span><span class="p">,</span> <span class="mi">3306</span><span class="p">,</span> <span class="mi">3389</span><span class="p">,</span> <span class="mi">3169</span><span class="p">,</span> <span class="mi">2989</span><span class="p">,</span> <span class="mi">3302</span><span class="p">,</span> <span class="mi">3201</span><span class="p">,</span> <span class="mi">3153</span><span class="p">,</span> <span class="mi">3089</span><span class="p">,</span> <span class="mi">2874</span><span class="p">,</span> <span class="mi">3305</span><span class="p">,</span> <span class="mi">3554</span><span class="p">,</span> <span class="mi">3493</span><span class="p">,</span> <span class="mi">3822</span><span class="p">,</span> <span class="mi">3419</span><span class="p">,</span> <span class="mi">3467</span><span class="p">,</span> <span class="mi">3261</span><span class="p">,</span> <span class="mi">3548</span><span class="p">,</span> <span class="mi">3461</span><span class="p">,</span> <span class="mi">3679</span><span class="p">,</span> <span class="mi">3533</span><span class="p">,</span> <span class="mi">3420</span><span class="p">,</span> <span class="mi">4251</span><span class="p">,</span> <span class="mi">4274</span><span class="p">,</span> <span class="mi">4249</span><span class="p">,</span> <span class="mi">3967</span><span class="p">,</span> <span class="mi">4013</span><span class="p">,</span> <span class="mi">4172</span><span class="p">,</span> <span class="mi">4117</span><span class="p">,</span> <span class="mi">3824</span><span class="p">,</span> <span class="mi">4461</span><span class="p">,</span> <span class="mi">3707</span><span class="p">,</span> <span class="mi">4193</span><span class="p">,</span> <span class="mi">3585</span><span class="p">,</span> <span class="mi">4109</span><span class="p">,</span> <span class="mi">4532</span><span class="p">,</span> <span class="mi">4237</span><span class="p">,</span> <span class="mi">4009</span><span class="p">,</span> <span class="mi">4439</span><span class="p">,</span> <span class="mi">4089</span><span class="p">,</span> <span class="mi">4917</span><span class="p">,</span> <span class="mi">3896</span><span class="p">,</span> <span class="mi">4181</span><span class="p">,</span> <span class="mi">4370</span><span class="p">,</span> <span class="mi">3989</span><span class="p">,</span> <span class="mi">4032</span><span class="p">,</span> <span class="mi">4641</span><span class="p">,</span> <span class="mi">4841</span><span class="p">,</span> <span class="mi">4509</span><span class="p">,</span> <span class="mi">4324</span><span class="p">,</span> <span class="mi">4643</span><span class="p">,</span> <span class="mi">4379</span><span class="p">,</span> <span class="mi">4685</span><span class="p">,</span> <span class="mi">4595</span><span class="p">,</span> <span class="mi">5079</span><span class="p">,</span> <span class="mi">4437</span><span class="p">,</span> <span class="mi">5165</span><span class="p">,</span> <span class="mi">5161</span><span class="p">,</span> <span class="mi">4271</span><span class="p">,</span> <span class="mi">5624</span><span class="p">,</span> <span class="mi">4557</span><span class="p">,</span> <span class="mi">4570</span><span class="p">,</span> <span class="mi">4871</span><span class="p">,</span> <span class="mi">5191</span><span class="p">,</span> <span class="mi">5189</span><span class="p">,</span> <span class="mi">4871</span><span class="p">,</span> <span class="mi">4689</span><span class="p">,</span> <span class="mi">4923</span><span class="p">,</span> <span class="mi">5597</span><span class="p">,</span> <span class="mi">4859</span><span class="p">,</span> <span class="mi">4973</span><span class="p">,</span> <span class="mi">5084</span><span class="p">,</span> <span class="mi">5457</span><span class="p">,</span> <span class="mi">5196</span><span class="p">,</span> <span class="mi">5099</span><span class="p">,</span> <span class="mi">4855</span><span class="p">,</span> <span class="mi">5541</span><span class="p">,</span> <span class="mi">5237</span><span class="p">,</span> <span class="mi">5077</span><span class="p">,</span> <span class="mi">5284</span><span class="p">,</span> <span class="mi">5729</span><span class="p">,</span> <span class="mi">5468</span><span class="p">,</span> <span class="mi">5539</span><span class="p">,</span> <span class="mi">5468</span><span class="p">,</span> <span class="mi">5709</span><span class="p">,</span> <span class="mi">5308</span><span class="p">,</span> <span class="mi">5813</span><span class="p">,</span> <span class="mi">6201</span><span class="p">,</span> <span class="mi">6317</span><span class="p">,</span> <span class="mi">5264</span><span class="p">,</span> <span class="mi">4979</span><span class="p">,</span> <span class="mi">6540</span><span class="p">,</span> <span class="mi">5693</span><span class="p">,</span> <span class="mi">5885</span><span class="p">,</span> <span class="mi">5679</span><span class="p">,</span> <span class="mi">5921</span><span class="p">,</span> <span class="mi">5713</span><span class="p">,</span> <span class="mi">6086</span><span class="p">,</span> <span class="mi">6425</span><span class="p">,</span> <span class="mi">5574</span><span class="p">,</span> <span class="mi">6221</span><span class="p">,</span> <span class="mi">5774</span><span class="p">,</span> <span class="mi">6581</span><span class="p">,</span> <span class="mi">6422</span><span class="p">,</span> <span class="mi">6209</span><span class="p">,</span> <span class="mi">6324</span><span class="p">,</span> <span class="mi">5651</span><span class="p">,</span> <span class="mi">6227</span><span class="p">,</span> <span class="mi">6021</span><span class="p">,</span> <span class="mi">6789</span><span class="p">,</span> <span class="mi">6617</span><span class="p">,</span> <span class="mi">6155</span><span class="p">,</span> <span class="mi">6657</span><span class="p">,</span> <span class="mi">6218</span><span class="p">,</span> <span class="mi">6719</span><span class="p">,</span> <span class="mi">5820</span><span class="p">,</span> <span class="mi">6221</span><span class="p">,</span> <span class="mi">6026</span><span class="p">,</span> <span class="mi">6815</span><span class="p">,</span> <span class="mi">6509</span><span class="p">,</span> <span class="mi">6113</span><span class="p">,</span> <span class="mi">6731</span><span class="p">,</span> <span class="mi">7343</span><span class="p">]</span>
</span></span></code></pre></div><h3 id="vss-">vss üî•<a href="#vss-" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 9/584</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>math</code></li>
<li>Author: @utaha</li>
</ul>
<p>When connected to the server, two 512-bit numbers $x, y$ will be generated. We are allowed to get up to around 180 sets of $(a, b, c, p, g, v, q)$ such that:</p>
<ol>
<li>$u = (a + bx + cy)\ \text{mod}\ p$, and</li>
<li>$v = g^u\ \text{mod}\ q$.</li>
</ol>
<p>The goal is to recover $x$ and $y$.</p>
<h3 id="lfsr-">LFSR üî•<a href="#lfsr-" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 6/584</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>lfsr</code></li>
<li>Author: @utaha</li>
</ul>
<div class="alert info">
  <strong>Note.</strong> In the challenge, the operations are done in $\text{GF}(2)$. That said, $+$ is actually the $\oplus$ (XOR) operation and $\times$ is the AND operation.
</div>

<p>Let $\mathcal{L}$ be a LFSR with key $(s_0, s_1, ..., s_{127})$, and for $i \geq 0$,</p>
<p>$$s_{i+128} = s_{i} + s_{i+1} + s_{i+2} + s_{i+7}.$$</p>
<p>Let the output bits $y_0, y_1, ...$ defined by</p>
<p>$$\begin{aligned}
y_i &amp;= s_i + s_{i+16} + s_{i+32} + s_{i+120} + s_i s_{i+8} + s_i s_{i+32} + s_{i+8} s_{i+64} + s_{i+16} s_{i+32} \\
&amp;\qquad + s_i s_{i+8} s_{i+64} + s_{i+16} s_{i+32} s_{i+64} + s_i s_{i+8} s_{i+16} s_{i+64} s_{i+120} + s_{i+8} s_{i+16} s_{i+32} s_{i+64} s_{i+120}.
\end{aligned}$$</p>
<p>We are given the first 8192 bits of the output (i.e., $y_0, y_1, ..., y_{8191}$). The goal is to recover the key (i.e., $s_0, s_1, ..., s_{127}$).</p>
<!-- ## CakeCTF 2022

### frozen cake

* Solves: 132/713
* Difficulty: ‚≠ê?
* Tags: `math`
* Author: <a href="https://twitter.com/theoremoon" target="_blank" rel="nofollow">@theoremoon</a>

Let $n = p \cdot q$ where $p, q$ are two 512-bit primes. Let $m$ be the flag and we are given $n$, $a = m^p\ \text{mod}\ n$, $b = m^q\ \text{mod}\ n$ and $c = m^n\ \text{mod}\ n$. The goal is to recover $m$.

```python
n = 101205131618457490641888226172378900782027938652382007193297646066245321085334424928920128567827889452079884571045344711457176257019858157287424646000972526730522884040459357134430948940886663606586037466289300864147185085616790054121654786459639161527509024925015109654917697542322418538800304501255357308131
a = 38686943509950033726712042913718602015746270494794620817845630744834821038141855935687477445507431250618882887343417719366326751444481151632966047740583539454488232216388308299503129892656814962238386222995387787074530151173515835774172341113153924268653274210010830431617266231895651198976989796620254642528
b = 83977895709438322981595417453453058400465353471362634652936475655371158094363869813512319678334779139681172477729044378942906546785697439730712057649619691929500952253818768414839548038664187232924265128952392200845425064991075296143440829148415481807496095010301335416711112897000382336725454278461965303477
c = 21459707600930866066419234194792759634183685313775248277484460333960658047171300820279668556014320938220170794027117386852057041210320434076253459389230704653466300429747719579911728990434338588576613885658479123772761552010662234507298817973164062457755456249314287213795660922615911433075228241429771610549
```

### brand new crypto

* Solves: 46/713
* Difficulty: ‚≠ê?
* Tags: `?`
* Author: <a href="https://twitter.com/theoremoon" target="_blank" rel="nofollow">@theoremoon</a>

<div class="alert info">
  üõ†Ô∏è <strong>To-be written.</strong> This is a placeholder because I am lazy. Please read the tags, or the official source meanwhile.
</div>


### hi yoshiking

* Solves: 10/713
* Difficulty: ‚≠ê?
* Tags: `?`
* Author: <a href="https://twitter.com/theoremoon" target="_blank" rel="nofollow">@theoremoon</a>

<div class="alert info">
  üõ†Ô∏è <strong>To-be written.</strong> This is a placeholder because I am lazy. Please read the tags, or the official source meanwhile.
</div>


### Rock Door

* Solves: 9/713
* Difficulty: ‚≠ê?
* Tags: `?`
* Author: <a href="https://twitter.com/theoremoon" target="_blank" rel="nofollow">@theoremoon</a>

<div class="alert info">
  üõ†Ô∏è <strong>To-be written.</strong> This is a placeholder because I am lazy. Please read the tags, or the official source meanwhile.
</div>


## 0CTF 2022

### real magic dlog

* Solves: 66/605
* Difficulty: ‚≠ê?
* Tags: `?`

<div class="alert info">
  üõ†Ô∏è <strong>To-be written.</strong> This is a placeholder because I am lazy. Please read the tags, or the official source meanwhile.
</div>


### Leopard

* Solves: 6/605
* Difficulty: ‚≠ê?
* Tags: `?`

<div class="alert info">
  üõ†Ô∏è <strong>To-be written.</strong> This is a placeholder because I am lazy. Please read the tags, or the official source meanwhile.
</div>


### ezRSA++

* Solves: 4/605
* Difficulty: ‚≠ê?
* Tags: `?`

<div class="alert info">
  üõ†Ô∏è <strong>To-be written.</strong> This is a placeholder because I am lazy. Please read the tags, or the official source meanwhile.
</div>


### Login

* Solves: 2/605
* Difficulty: ‚≠ê?
* Tags: `?`

<div class="alert info">
  üõ†Ô∏è <strong>To-be written.</strong> This is a placeholder because I am lazy. Please read the tags, or the official source meanwhile.
</div>


### Chimera

* Solves: 0/605
* Difficulty: ‚≠ê?
* Tags: `?`

<div class="alert info">
  üõ†Ô∏è <strong>To-be written.</strong> This is a placeholder because I am lazy. Please read the tags, or the official source meanwhile.
</div>
 -->
<h2 id="downunderctf-2022">DownUnderCTF 2022<a href="#downunderctf-2022" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h3 id="baby-arx">baby arx<a href="#baby-arx" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 279/1407</li>
<li>Difficulty: ‚≠ê</li>
<li>Tags: <code>?</code></li>
<li>Author: <a href="https://twitter.com/josep68_" target="_blank" rel="nofollow">@josep68_</a></li>
</ul>
<div class="alert info">
  üõ†Ô∏è <strong>To-be written.</strong> This is a placeholder because I am lazy. Please read the tags, or the official source meanwhile.
</div>

<h3 id="oracle-for-block-cipher">oracle for block cipher<a href="#oracle-for-block-cipher" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 102/1407</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>?</code></li>
<li>Author: <a href="https://twitter.com/josep68_" target="_blank" rel="nofollow">@josep68_</a></li>
</ul>
<p>Let <code>m</code> be the message with a given 16-byte prefix. When connected to the server, a 16-byte key <code>k</code> is generated. We are allowed to pick two IVs <code>iv1</code>, <code>iv2</code>. After each pick, we will be given the ciphertext of <code>m</code>, encrypted with AES-OFB with key <code>k</code> and <code>iv</code>. The goal is to recover <code>m</code>.</p>
<h3 id="cheap-ring-theory">cheap ring theory<a href="#cheap-ring-theory" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 101/1407</li>
<li>Difficulty: ‚≠ê</li>
<li>Tags: <code>?</code></li>
<li>Author: <a href="https://twitter.com/josep68_" target="_blank" rel="nofollow">@josep68_</a></li>
</ul>
<div class="alert info">
  üõ†Ô∏è <strong>To-be written.</strong> This is a placeholder because I am lazy. Please read the tags, or the official source meanwhile.
</div>

<h3 id="rsa-interval-oracle-i">rsa interval oracle i<a href="#rsa-interval-oracle-i" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 79/1407</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>rsa</code></li>
<li>Author: <a href="https://twitter.com/josep68_" target="_blank" rel="nofollow">@josep68_</a></li>
</ul>
<p>When connected to the server, two 192-bit primes $p, q$ are generated and $n = p \cdot q$. Let $e = 65537$ and $d$ be the corresponding decryption exponent. We are given $(n, e)$ (a RSA public key). A 336-bit message $m$ is generated and encrypted using the RSA public key. The ciphertext, $c$, is given as well.</p>
<p>We are allowed to set $k$ intervals $[\alpha_1, \beta_1)$, ..., $[\alpha_k, \beta_k)$. We are also allowed to send $c_1, c_2, ..., c_q$ (in multiple batches) and obtain $\mathcal{O}(c_1), \mathcal{O}(c_2), ..., \mathcal{O}(c_q)$. The server will sleeps for $s$ seconds after returning each batch of $\mathcal{O}(c_i)$'s.</p>
<p>The goal is to recover $m$ within $t$ seconds.</p>
<p>Finally, $\mathcal{O}(c)$ is given by the smallest $i$ such that $m := c^d\ \text{mod}\ n$ and $m \in [\alpha_i, \beta_i)$ (or <code>-1</code> if it falls into neither of the intervals).</p>
<p>In this challenge, $k = 384$, $q = 384$, $t = 1800$ and $s = 0$.</p>
<h3 id="rsa-interval-oracle-ii-">rsa interval oracle ii üî•<a href="#rsa-interval-oracle-ii-" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 36/1407</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>rsa</code></li>
<li>Author: <a href="https://twitter.com/josep68_" target="_blank" rel="nofollow">@josep68_</a></li>
</ul>
<p><em>The challenge is similar to rsa interval oracle i, except that we are only allowed to set one interval (i.e., $k = 1$).</em></p>
<h3 id="rsa-interval-oracle-iii">rsa interval oracle iii<a href="#rsa-interval-oracle-iii" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 23/1407</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>rsa</code></li>
<li>Author: <a href="https://twitter.com/josep68_" target="_blank" rel="nofollow">@josep68_</a></li>
</ul>
<p><em>The challenge is similar to rsa interval oracle i, with $k = 4$, $q = 4700$, $t = 180$ and $s = 44$.</em></p>
<h3 id="rsa-interval-oracle-iv-">rsa interval oracle iv üî•<a href="#rsa-interval-oracle-iv-" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 5/1407</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>rsa</code></li>
<li>Author: <a href="https://twitter.com/josep68_" target="_blank" rel="nofollow">@josep68_</a></li>
</ul>
<p><em>The challenge is similar to rsa interval oracle i, with $q = 4700$ and $t = 180$.</em></p>
<p>In this challenge, we are no longer able to add intervals by ourselves, but to use these intervals: $[1, 2^{373}), [1, 2^{374}), [1, 2^{375}), [1, 2^{376})$. Also, we can only send all the $c_i$'s in one batch, i.e., we cannot send $c_i$'s adaptively.</p>
<h3 id="time-locked">time locked<a href="#time-locked" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 18/1407</li>
<li>Difficulty: ‚≠ê‚≠ê</li>
<li>Tags: <code>math</code></li>
<li>Author: <a href="https://twitter.com/josep68_" target="_blank" rel="nofollow">@josep68_</a></li>
</ul>
<p>Let $f$ be the function given below. The goal is to recover $f(2^{2^{1337}})$.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="mi">275344354044844896633734474527970577743</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2367876727</span><span class="p">,</span> <span class="mi">2244612523</span><span class="p">,</span> <span class="mi">2917227559</span><span class="p">,</span> <span class="mi">2575298459</span><span class="p">,</span> <span class="mi">3408491237</span><span class="p">,</span> <span class="mi">3106829771</span><span class="p">,</span> <span class="mi">3453352037</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">Œ±</span> <span class="o">=</span> <span class="p">[</span><span class="mi">843080574448125383364376261369231843</span><span class="p">,</span> <span class="mi">1039408776321575817285200998271834893</span><span class="p">,</span> <span class="mi">712968634774716283037350592580404447</span><span class="p">,</span> <span class="mi">1166166982652236924913773279075312777</span><span class="p">,</span> <span class="mi">718531329791776442172712265596025287</span><span class="p">,</span> <span class="mi">766989326986683912901762053647270531</span><span class="p">,</span> <span class="mi">985639176179141999067719753673114239</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">Œ±</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">Œ±</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">n</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Œ±</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">t</span> <span class="o">=</span> <span class="n">Œ±</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">a_</span> <span class="o">*</span> <span class="n">f_</span> <span class="k">for</span> <span class="n">a_</span><span class="p">,</span> <span class="n">f_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">t</span><span class="p">)])</span> <span class="o">%</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">n</span> <span class="o">-=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span></code></pre></div><h3 id="faulty-arx-">faulty arx üî•<a href="#faulty-arx-" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 11/1407</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>?</code></li>
<li>Author: <a href="https://twitter.com/josep68_" target="_blank" rel="nofollow">@josep68_</a></li>
</ul>
<div class="alert info">
  üõ†Ô∏è <strong>To-be written.</strong> This is a placeholder because I am lazy. Please read the tags, or the official source meanwhile.
</div>

<h3 id="1337crypt-v3-">1337crypt v3 üî•<a href="#1337crypt-v3-" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 2/1407</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>math</code></li>
<li>Author: <a href="https://twitter.com/josep68_" target="_blank" rel="nofollow">@josep68_</a></li>
</ul>
<p>Let $3 \leq x &lt; 2^{780}$. We are given $\alpha_1, \alpha_2, \alpha_3, \beta_1, \beta_2, \beta_3$ such that:</p>
<p>$$\left\{\begin{aligned}
\beta_1 &amp;= \sin \alpha_1 x \\
\beta_2 &amp;= \cos \alpha_2 x \\
\beta_3 &amp;= \tan \alpha_3 x
\end{aligned}\right..$$</p>
<p>Hereby $\alpha_1, \alpha_2, \alpha_3, \beta_1, \beta_2, \beta_3$ are real numbers with 1337 bits of precision. The goal is to recover $x$.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">alpha1</span> <span class="o">=</span> <span class="mf">382688.000003718840762957370928334219657048504840071252989018263226986883648629049352735765207269589923429068690707732585598417261371285342932900956113960156340065674727873827170594382319143476595475658327786062528588588365234789011569313613560380958047757353077898557461668048835816899156195030884972536360965559815694251787832696791756073796676100126068701864254874470530046373944314078415476327719123</span>
</span></span><span class="line"><span class="cl"><span class="n">alpha2</span> <span class="o">=</span> <span class="mf">15637.0000000000000000000000000000000000000000073407249596755993494633815978948470725770595202532938111233270822656540006827548854086357909099305933838931019150313577619230563069886151776251889782046359224864632667394933146539407828208245853609735993739377148185083846731149980246713157043706328084023440946327661078130241672626606833808343709723838524304060402271919834105020805612169606358017694056416</span>
</span></span><span class="line"><span class="cl"><span class="n">alpha3</span> <span class="o">=</span> <span class="mf">29275.0000000000640306760478159122361364268852615107016525704106080086895615545710184648549454761942179678623356595579867852707677349455538454994245696487465653543975651069930536590338519688676538350247199102639964709439110478379805687129967589534757115196430034251100020849966477333439686322641356763869580696872661554589116735439860643787761928921454825557808884297326088601658418898922938739996904201</span>
</span></span><span class="line"><span class="cl"><span class="n">beta1</span> <span class="o">=</span> <span class="mf">0.965482350590597357930331336732328693322339578742073734517347983738107022900479878437240803728616183527740872166110419707555902612362293470627167159630511997241207746072653515847677991057240464634863174163959352186613630940970393483122090644984824146327516779925585782449367431713140436462716606231926544190865635435305068802789385561809037048381522369403391403353483514563964854636147009339110513969645</span>
</span></span><span class="line"><span class="cl"><span class="n">beta2</span> <span class="o">=</span> <span class="mf">0.919312641039301449759543236755656153255910638284013829633241595979805444268967097520473755994266515165860135737385130077610933382052195648654916587723024832651148703456409500869252608520524821467862378804471336340455738379241087436118861027054778860623168210037730515076872812158198969896476202559290795561594850736319300877512941843333101776445598926887112185986310036903702305697813449195991705718975</span>
</span></span><span class="line"><span class="cl"><span class="n">beta3</span> <span class="o">=</span> <span class="mf">1.14855387625795367637526700157484262696944920546403536701593427303031683808809632650237298251670835767655247021139590568460713791448489530488025769625130549491228701922532851244586550786881004979465956996142194848926889854866759317451072626109337018933249842757205735321771354730486331102478476183417508143532011641972415188172049143718997615501480006657475224101754862855024419523910721536847865397788</span>
</span></span></code></pre></div><h3 id="kyber">kyber¬±<a href="#kyber" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 1/1407</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>?</code></li>
<li>Author: <a href="https://twitter.com/josep68_" target="_blank" rel="nofollow">@josep68_</a></li>
</ul>
<div class="alert info">
  üõ†Ô∏è <strong>To-be written.</strong> This is a placeholder because I am lazy. Please read the tags, or the official source meanwhile.
</div>


        </div></div>

      
      <aside class="toc-container">
        <a href="#" class="toc-title-link">
          Crypto in CTF: Q3 2022
        </a>
        <div class="js-toc"></div>
      </aside>
      

      

    </div>
  </div>

    </div>
  </main>
  <div class="container">
  <footer class="py-3 my-4 border-top">
    <p class="text-center text-body-secondary">&copy; 2026 Powered by <em>Hugo</em>. Theme crafted by <em>Mystiz</em> with Bootstrap 5, inspired from <em>Terminal</em>.</p>
  </footer>
</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/katex.min.css"
  integrity="sha384-Pu5+C18nP5dwykLJOhd2U4Xen7rjScHN/qusop27hdd2drI+lL5KvX7YntvT8yew" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/katex.min.js"
  integrity="sha384-2B8pfmZZ6JlVoScJm/5hQfNS2TI/6hPqDZInzzPc8oHpN5SgeNOf4LzREO6p5YtZ" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/contrib/auto-render.min.js"
  integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous"
  onload="renderMathInElement(document.body, { delimiters: [{ left: '$$', right: '$$', display: true }, { left: '\\[', right: '\\]', display: true }, { left: '$', right: '$', display: false }, { left: '\\(', right: '\\)', display: false }], trust: true })"></script>

<script src="https://cdn.jsdelivr.net/npm/@viz-js/viz@3.24.0/dist/viz-global.min.js"></script>
<script>
Viz.instance().then(viz => {
  const unescape = function (s) {
    const t = s.replace(/&amp;/g, '&')
    return t.replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&#34;/g, '"')
  }

  document.querySelectorAll('[class=graphviz]').forEach(node => {
    const source = unescape(node.innerText);
    console.log(source);
    const svg = viz.renderSVGElement(source, { engine: 'dot' });
    console.log(2);
    node.parentNode.appendChild(svg);
    node.style.display = 'none';
  });
});
</script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.36.4/tocbot.min.js"
  integrity="sha512-BZUSsJAPNtkd+kdY/bD7hvQKZ5zlgWt++KGy/Pa/5uEJNgs0jZ6JaX6MuclRUanowuxmhb5S3LRPEa3QmrUVfA==" crossorigin="anonymous"
  referrerpolicy="no-referrer"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.36.4/tocbot.min.css"
  integrity="sha512-/ANQiHMqpRl+E0zEAd250N21OOmJsYbhiJWY0Y8yG0TII47yZn1+gDNobMlf+h/FTyImprLXYgXbX3bCYyq/vg==" crossorigin="anonymous"
  referrerpolicy="no-referrer" />
<script type="text/javascript">
tocbot.init({
  headingSelector: 'h1, h2, h3, h4',
  orderedList: false,
  collapseDepth: 2,
  headingsOffset: 60,
  scrollSmoothOffset: -60
})
</script>


<script>
  document.querySelectorAll('pre code').forEach(el => {
    console.log(el)
    const lang = Array.from(el.classList).find(className => className.startsWith('language-'));
    if (!lang) return;

    
    if (lang.startsWith('language-diff-')) {
      el.classList.add('diff-highlight');
    }
  })
</script>
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script>
mermaid.initialize({
  startOnLoad: true,
  htmlLabels: true,
  securityLevel: "loose",
  theme: 'base',
  themeVariables: {
    background: '#22222c',
    primaryColor: '#33333c',
    primaryTextColor: '#ffe4e1',
  }
});
</script>

</body>
</html>

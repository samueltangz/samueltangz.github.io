<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Crypto in CTF: Q1 2022 :: Mystify</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="CTF Challenge Name Solves (Difficulty)     TetCTF 2022 shares üî• 29/602 (‚≠ê‚≠ê‚≠ê)   TetCTF 2022 shares_v2 üî• 15/602 (‚≠ê‚≠ê‚≠ê)   TetCTF 2022 fault üî• 14/602 (‚≠ê‚≠ê‚≠ê)   TetCTF 2022 algebra üî• 14/602 (‚≠ê‚≠ê‚≠ê)    TetCTF 2022 shares üî•  Solves: 29/602 Difficulty: ‚≠ê‚≠ê‚≠ê Tags: secret sharing  Define a secret sharing scheme $\text{SecretSharing}(s, n, t)$. Hereby $s$ is the secret to share, $n$ and $t$ are respectively the number of shares returned and the minimum number of shares for recovery." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/crypto-in-ctf/2022-q1/" />




<link rel="stylesheet" href="/assets/style.css">

  <link rel="stylesheet" href="/assets/mystiz.css">






<link rel="apple-touch-icon" href="/img/apple-touch-icon-192x192.png">

  <link rel="shortcut icon" href="/img/favicon/mystiz.png">



<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Crypto in CTF: Q1 2022">
<meta property="og:description" content="CTF Challenge Name Solves (Difficulty)     TetCTF 2022 shares üî• 29/602 (‚≠ê‚≠ê‚≠ê)   TetCTF 2022 shares_v2 üî• 15/602 (‚≠ê‚≠ê‚≠ê)   TetCTF 2022 fault üî• 14/602 (‚≠ê‚≠ê‚≠ê)   TetCTF 2022 algebra üî• 14/602 (‚≠ê‚≠ê‚≠ê)    TetCTF 2022 shares üî•  Solves: 29/602 Difficulty: ‚≠ê‚≠ê‚≠ê Tags: secret sharing  Define a secret sharing scheme $\text{SecretSharing}(s, n, t)$. Hereby $s$ is the secret to share, $n$ and $t$ are respectively the number of shares returned and the minimum number of shares for recovery." />
<meta property="og:url" content="/crypto-in-ctf/2022-q1/" />
<meta property="og:site_name" content="Mystify" />

  
    <meta property="og:image" content="/img/favicon/mystiz.png">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">













  <script data-ad-client="ca-pub-3220069814773012" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


</head>
<body class="mystiz">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Mystify
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about-me">About Me</a></li>
        
      
        
          <li><a href="/blogroll">Blogroll</a></li>
        
      
      
        <ul class="menu__sub-inner">
          <li class="menu__sub-inner-more-trigger">Show more ‚ñæ</li>

          <ul class="menu__sub-inner-more hidden">
            
              
                <li><a href="/crypto-in-ctf">Crypto in CTF</a></li>
              
            
          </ul>
        </ul>
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about-me">About Me</a></li>
      
    
      
        <li><a href="/blogroll">Blogroll</a></li>
      
    
      
        <li><a href="/crypto-in-ctf">Crypto in CTF</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="/crypto-in-ctf/2022-q1/">Crypto in CTF: Q1 2022</a></h1>
  <div class="post-meta">
    
    
  </div>

  

  

  <div class="post-content js-toc-content"><div>
        <table>
<thead>
<tr>
<th>CTF</th>
<th>Challenge Name</th>
<th>Solves (Difficulty)</th>
</tr>
</thead>
<tbody>
<tr>
<td>TetCTF 2022</td>
<td>shares üî•</td>
<td>29/602 (‚≠ê‚≠ê‚≠ê)</td>
</tr>
<tr>
<td>TetCTF 2022</td>
<td>shares_v2 üî•</td>
<td>15/602 (‚≠ê‚≠ê‚≠ê)</td>
</tr>
<tr>
<td>TetCTF 2022</td>
<td>fault üî•</td>
<td>14/602 (‚≠ê‚≠ê‚≠ê)</td>
</tr>
<tr>
<td>TetCTF 2022</td>
<td>algebra üî•</td>
<td>14/602 (‚≠ê‚≠ê‚≠ê)</td>
</tr>
</tbody>
</table>
<h2 id="tetctf-2022">TetCTF 2022<a href="#tetctf-2022" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h3 id="shares-">shares üî•<a href="#shares-" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 29/602</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>secret sharing</code></li>
</ul>
<p>Define a secret sharing scheme $\text{SecretSharing}(s, n, t)$. Hereby $s$ is the secret to share, $n$ and $t$ are respectively the number of shares returned and the minimum number of shares for recovery. Here $s = (s_1, s_2, &hellip;, s_l) \in \text{GF}(37)^l$ with $l \leq n$. The algorithm $\mathcal{A}$ below is used to generate shares.</p>
<ol>
<li>Define $s' = (s_1, &hellip;, s_l, s_{l+1}, &hellip;, s_t)$ where $s_{l+1}, &hellip;, s_t \in \text{GF}(37)$ are randomly picked.</li>
<li>For $i = 1, 2, &hellip;, n$,
<ul>
<li>Generate $a_{i, 1}, a_{i, 2}, &hellip;, a_{i, n} \in \text{GF}(37)$.</li>
<li>Compute $b_i = \sum_{k=1}^n a_{ik} s_k\ \text{mod}\ 37$.</li>
<li>Define $S_i := (a_{i, 1}, a_{i, 2}, &hellip;, a_{i, n}, b_i)$.</li>
</ul>
</li>
<li>Return $S_1, S_2, &hellip;, S_n$ as the shares.</li>
</ol>
<p>When connected to the server, a password with $l = 16$ is generated. Let also $n = 16$ and $t = 32$. We are given 2022 attempts to guess the password. For each incorrect attempt, we will be given a set of shares from algorithm $\mathcal{A}$. Otherwise we will be given the flag.</p>
<h3 id="shares_v2-">shares_v2 üî•<a href="#shares_v2-" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 15/602</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>secret sharing</code></li>
</ul>
<p>This challenge is based on the $\text{SecretSharing}$ algorithm defined above.</p>
<p>Define a secret sharing scheme $\text{SecretSharingV2}(m, s, n, t)$ with $m \geq n$. The below algorithm $\mathcal{A}_2$ is to generate shares:</p>
<ol>
<li>Generate a master secret $(r_1, r_2, &hellip;, r_m)$ with $r_1, r_2, &hellip;, r_m \in \{0, 1\}$.</li>
<li>Define $S_1, S_2, &hellip;, S_n := \text{SecretSharing}(s, n, t)$. Note that $S_i = (a_{i, 1}, a_{i, 2}, &hellip;, a_{i, n}, b_i)$.</li>
<li>For each $i = 1, 2, &hellip;, n$, if $r_i = 1$, update $b_i \leftarrow (b_i + 18)\ \text{mod}\ 37$.</li>
<li>Return $(r_1, r_2, &hellip;, r_m)$ as the master secret and $S_1, S_2, &hellip;, S_n$ as the shares.</li>
</ol>
<p>When connected to the server, a password with $l = 32$ is generated. Let also $n = 32$, $t = 32$ and $m = 128$. We are given 2022 attempts to guess the password. For each incorrect attempt, we will be given a set of shares from algorithm $\mathcal{A}_2$. Otherwise we will be given the flag.</p>
<h3 id="fault-">fault üî•<a href="#fault-" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 14/602</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>rsa</code></li>
</ul>
<p>When connected to the server, a RSA private key is generated such that:</p>
<ol>
<li>$p, q$ are 512-bit primes, and</li>
<li>$d$ is a 64-bit prime.</li>
</ol>
<p>The encrypted flag $c_0$ is also computed (not returned). We are allowed to call the oracle $\mathcal{O}$ 2022 times, which does one of the below:</p>
<ol>
<li><strong>[Decrypt message]</strong> We give an $c &lt; n$ and the server returns $\text{FaultilyDecrypt}(c)$; or</li>
<li><strong>[Decrypt flag]</strong> The server returns $\text{FaultilyDecrypt}(c_0)$.</li>
</ol>
<p>Hereby $\text{FaultilyDecrypt}(c)$ returns a pair $(v, m')$ where $v$ is a 64-bit integer and</p>
<p>$$m' = c^{d \oplus v}\ \text{mod}\ n.$$</p>
<p>Note that we are given nothing (including $n$ and $e$) but the oracle. The objective is to recover the flag.</p>
<h3 id="algebra-">algebra üî•<a href="#algebra-" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Solves: 14/602</li>
<li>Difficulty: ‚≠ê‚≠ê‚≠ê</li>
<li>Tags: <code>math</code></li>
</ul>
<p>Let $C$ be a constant and $p$ is a prime such that $x^2 + 2Cx + 1 \equiv 0\ (\text{mod}\ p)$ has two distinct roots. Define an operator $\star$ over $\text{GF}(p) \cup \{ \infty \}$ by</p>
<p>$$a \star b = \begin{cases}
-2C &amp;\text{if}\ a = b = \infty \\
\infty &amp;\text{if}\ a = \infty\ \land\ b = 0 \\
-(1 + 2Cb) / b &amp;\text{if}\ a = \infty \\
\infty &amp;\text{if}\ ab = 1 \\
(a + b + 2Cab) / (1 - ab) &amp;\text{otherwise}
\end{cases}.$$</p>
<p>Define also $a^k$ by</p>
<p>$$a^k = \underbrace{a \star a \star \dots \star a}_{k\ \text{times}}.$$</p>
<p>We are given some expressions those may reveal some properties:</p>
<ol>
<li>$(2020 \star 2021) \star 2022 = 2020 \star (2021 \star 2022)$, and</li>
<li>$2022^{p-1} = 0$.</li>
</ol>
<p>When connected to the server, $a, b \in [0, p)$ and $m, n \in [0, p-1)$ are generated randomly. Also, $c := a^m \star b^n$. We are given $a, b$ and $c$ and is asked to send $\hat{a}, \hat{b}$ and $\hat{c}$ such</p>
<p>$$\hat{a}^m \cdot \hat{b}^n \equiv \hat{c}\ (\text{mod}\ p). \qquad [\dagger]$$</p>
<p>If we send $\hat{a}, \hat{b}$ and $\hat{c}$ with $[\dagger]$ holds, we will be given the first $\hat{c}^4\ \text{mod}\ p$ characters of the flag (this bans trivial solutions like $\hat{a} = \hat{b} = \hat{c} = 1$).</p>

      </div></div>

  

  

</div>


<aside class="toc-container">
  <a href="#" style="text-decoration: none; font-weight: 700;">
    Crypto in CTF: Q1 2022
  </a>
  <div class="js-toc"></div>
</aside>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.12.0/tocbot.min.css" integrity="sha512-SFw7k74K3983tyOlJIHa8atr9Ppef3Kix5cmifwzU7ZdtU2E0FRuOVRtd3ENpMJ8sNCie5hlb/0j23efcdQJXA==" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.12.0/tocbot.min.js" integrity="sha512-oD3xGN8YTxenx6tdS4D/RKqO4OtORBQtAb2/FseM17GGMIi6jMwKUBc8duX4A5RwMOGGXoFBZrsqbOk8GpXFgQ==" crossorigin="anonymous"></script>

<script type="text/javascript">
  tocbot.init({
      headingSelector: 'h1, h2, h3, h4',
      orderedList: false,
      headingLabelCallback: s => s.substr(0, s.length-2),
      collapseDepth: 2
  });
</script>



  </div>
  <aside class="ads">
    
  
  <ins class="adsbygoogle"
    style="display:block"
    data-ad-client="ca-pub-3220069814773012"
    data-ad-slot="6927401005"
    data-ad-format="auto"
    data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>


  </aside>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>¬© 2022 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>






<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
  integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"
  integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"
  integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
  onload="renderMathInElement(document.body, { delimiters: [{ left: '$$', right: '$$', display: true }, { left: '\\[', right: '\\]', display: true }, { left: '$', right: '$', display: false }, { left: '\\(', right: '\\)', display: false }], trust: true })"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/viz.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/full.render.js"></script>
<script>
var viz = new Viz();

document.querySelectorAll("[class=graphviz]").forEach(node => {
  const escape = function (s) {
    const t = s.replace(/&amp;/g, '&')
    return t.replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&#34;/g, '"')
  }
  viz.renderSVGElement(escape(node.innerText), {
    engine: 'dot'
  }).then(function (element) {
    node.parentNode.appendChild(element)
    node.style.display = 'none'
  })
})
</script>
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script>
mermaid.initialize({
    startOnLoad: true,
    htmlLabels: true,
    securityLevel: "loose",
    theme: 'base',
    themeVariables: {
        background: '#22222c',
        primaryColor: '#33333c',
        primaryTextColor: '#ffe4e1',
    }
});
</script>

  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-180181192-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-180181192-1');
</script>



  
</div>

</body>
</html>
